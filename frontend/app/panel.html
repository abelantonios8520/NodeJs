<!--=========================
	Panel
==========================-->

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M2M 27x V2 || Panel</title>
    <link href="css/bootstrap.min.css" rel="stylesheet">
	<link rel="shortcut icon" type="image/ico" href="img/favicon.ico"/>
    <link href="font-awesome/css/font-awesome.css" rel="stylesheet">
    <link href="css/animate.css" rel="stylesheet">
	<link href="css/plugins/toastr/toastr.min.css" rel="stylesheet">
	<link href="css/plugins/dataTables/datatables.min.css" rel="stylesheet">
    <link href="css/plugins/c3/c3.min.css" rel="stylesheet">
	<link href="css/style.css" rel="stylesheet">
	<script src="js/sweetalert.min.js"></script>
	<script src="js/moment.min.js"></script>
	<script>
		if (document.addEventListener){
			window.addEventListener('load',function(){
				
				if (window.sessionStorage.getItem('sesion')){
					
					var user =JSON.parse(window.sessionStorage.getItem('sesion'));
					if(user.r=="2"){
							location.href="/visual.html";
					}else if(user.r!=="1"){
						location.href="/index.html";
					}else{
						$("#nameIn").html(user.n);
						$("#nameInC").html(user.e);
					}
				}else{
					location.href="/index.html";
				}
				
				
			},false);
		}
	</script>
</head>

<body>
	
	<div class="modal inmodal fade" id="modalnew" tabindex="-1" role="dialog"  aria-hidden="true">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
					<i class="fa fa-cogs modal-icon" style="color:orange"></i>
					<h4 class="modal-title">Alertas generadas via trama</h4>
				</div>
				<div class="modal-body">
					
					<div align="center">En caso de usar telefono gire pantalla <i class="fa fa-rotate-left" style="color: blue;"></i></div>
					<br>
					<div align="right"> Nombre:<span id="nomE"></span> Teléfono:<span id="telE"></span> <br> Longitud:<span id="logE"></span> Latitud:<span id="latE"></span> <br> <span id="sig"></span><img src="img/signal.png" width="35" height="35"> Batería <img id ="bac" width="35" height="35"> Backup <img id ="pow" width="35" height="35"></div>
					<!--<br>
					<div align="right">
						<img src="img/off.png" id ="rela3" width="35" height="35" title="Dout 3">
						<img src="img/off.png" id ="rela2" width="35" height="35" title="Dout 2">
						<img src="img/off.png" id ="rela1" width="35" height="35" title="Dout 1">
						<img src="img/off.png" id ="rela0" width="35" height="35" title="Dout 0">
					</div>-->
					<br>
					<div class="p-w-md m-t-sm">
						<div class="row">
							
							<div class="col-lg-12">
								<h3 class="m-b-xs">
									Estado lineal númerico de sensores
								</h3>
								<br>
								<canvas id="lineChart" height="140"></canvas>
							</div>
							<br>

							<div class="col-lg-12">
								<h3 class="m-b-xs">
									Historico de sensores en función a sus valores
								</h3>
								<br>
								<div class="flot-chart m-b-xl">
									<div class="flot-chart-content" id="flot-dashboard5-chart"></div>
								</div>
							</div>
							<br>
							
							<!--<div class="col-lg-12">
								<h3 class="m-b-xs">
									Estado lineal númerico de din
								</h3>
								<br>
								<canvas id="lineChartDin" height="140"></canvas>
							</div>
							<br>
							
							<div class="col-lg-12">
								<h3 class="m-b-xs">
									Historico de din en función a sus valores
								</h3>
								<br>
								<div class="flot-chart m-b-xl">
									<div class="flot-chart-content" id="flot-dashboard5-chartDin"></div>
								</div>
							</div>
							<br>-->
							
							<div class="col-lg-12">
								<h3 class="m-b-xs">
									Estado lineal númerico de din
								</h3>
								<br>
								 <div id="stocked"></div>
								<br>

								<div align="center"><strong> 
									<label style="color:#79d2c0">NO</label> 
									<label style="color:#d3d3d3">CHANGE</label> 
									<label style="color:#1c84c6">COUNTER</label> 
									<label style="color:#1ab394">NC</label>
								</strong></div>
							</div>
							<br>
							
							<div class="col-lg-12">
								<h3 class="m-b-xs">
									Historico de din en función a sus valores
								</h3>
								<br>
								<div class="flot-chart m-b-xl">
									<div class="flot-chart-content" id="flot-dashboard5-chartDin"></div>
								</div>
							</div>
							<br>
							
							<div class="col-lg-12">
								<h3 class="m-b-xs">
									Estado lineal númerico de temperatura
								</h3>
								<br>
								<canvas id="lineChartTemp" height="140"></canvas>
							</div>
							<br>
							
							<div class="col-lg-12">
								<h3 class="m-b-xs">
									Historico de temperatura en función a sus valores
								</h3>
								<br>
								<div class="flot-chart m-b-xl">
									<div class="flot-chart-content" id="flot-dashboard5-charTemperature"></div>
								</div>
							</div>
							<br>
							
							<div class="col-lg-12">
								<h3 class="m-b-xs">
									Estado lineal númerico de humedad
								</h3>
								<br>
								<canvas id="lineChartHume" height="140"></canvas>
							</div>
							<br>
							
							<div class="col-lg-12">
								<h3 class="m-b-xs">
									Historico de humedad en función a sus valores
								</h3>
								<br>
								<div class="flot-chart m-b-xl">
									<div class="flot-chart-content" id="flot-dashboard5-charHume"></div>
								</div>
							</div>
							<br>
							
							<!--<div class="col-lg-12">
								<h3 class="m-b-xs">
									Estado lineal númerico de relays
								</h3>
								<br>
								<canvas id="lineChartRelay" height="140"></canvas>
							</div>
							<br>
							
							<div class="col-lg-12">
								<h3 class="m-b-xs">
									Historico de relay en función a sus valores
								</h3>
								<br>
								<div class="flot-chart m-b-xl">
									<div class="flot-chart-content" id="flot-dashboard5-chartRelay"></div>
								</div>
							</div>
							<br>-->
							
						</div>
                    </div>

					
				</div>
				<div class="modal-footer">
					<button type="button" id="Eliminar_El" class="btn btn-danger" data-dismiss="modal">Eliminar Elemento</button>
					<button type="button" class="btn btn-white" data-dismiss="modal">Cerrar</button>
				</div>
			</div>
		</div>
	</div>

	<div class="modal inmodal" id="smsModalHistorial" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog">
		<div class="modal-content animated bounceInRight">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
					<i class="fa fa-bolt modal-icon" style="color: yellow;"></i>
					<h4 class="modal-title">Historial > Sms > Ains</h4>
				</div>
				<div class="modal-body">
					<div align="center">En caso de usar telefono gire pantalla <i class="fa fa-rotate-left" style="color: blue;"></i></div>
					<div align="center">para usar el filtro indique fecha y turno: DD/MM/YYYY am ó pm</div>
					<br>
					<br>
					<table id="TableSms" class="table table-bordered table-hover animated fadeIn" cellspacing="0" width="100%">
					</table>
					<br>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-white" data-dismiss="modal">Cerrar</button>
				</div>
			</div>
		</div>
	</div>
	
	<div class="modal inmodal" id="tramaModalHistorial" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog">
		<div class="modal-content animated bounceInRight">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
					<i class="fa fa-bolt modal-icon" style="color: yellow;"></i>
					<h4 class="modal-title">Historial > Trama > Ains</h4>
				</div>
				<div class="modal-body">
					<div align="center">En caso de usar telefono gire pantalla <i class="fa fa-rotate-left" style="color: blue;"></i></div>
					<div align="center">para usar el filtro indique fecha y turno: DD/MM/YYYY am ó pm</div>
					<br>
					<br>
					<table id="TableTramax" class="table table-bordered table-hover animated fadeIn" cellspacing="0" width="100%">
					</table>
					<br>
				</div>
				
				<div class="modal-footer">
					<button type="button" class="btn btn-white" data-dismiss="modal">Cerrar</button>
				</div>
			</div>
		</div>
	</div>

	<div class="modal inmodal" id="configModal" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog">
		<div class="modal-content animated bounceInRight">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
					<i class="fa fa-cogs modal-icon" style="color:orange"></i>
					<h4 class="modal-title">Alertas generadas via sms</h4>
				</div>
				<div class="modal-body">
					<div align="center">En caso de usar telefono gire pantalla <i class="fa fa-rotate-left" style="color: blue;"></i></div>
					<br>
					<br>
					<div align="right"> Nombre:<span id="nomE"></span> Teléfono:<span id="telE"></span> <br> Longitud:<span id="logE"></span> Latitud:<span id="latE"></span> <br> <span id="sig"></span><img src="img/signal.png" width="35" height="35"> Batería <img id ="bac" width="35" height="35"> Backup <img id ="pow" width="35" height="35"></div>
					<br>
					<div align="right">
						<!--<img src="img/off.png" id ="rela3" width="35" height="35" title="Dout 3">
						<img src="img/off.png" id ="rela2" width="35" height="35" title="Dout 2">
						<img src="img/off.png" id ="rela1" width="35" height="35" title="Dout 1">
						<img src="img/off.png" id ="rela0" width="35" height="35" title="Dout 0">-->
					</div>
					<br>
				
				<div align="left">Sensores Ain</div>
				<div><iframe class="chartjs-hidden-iframe" style="width: 100%; display: block; border: 0px; height: 0px; margin: 0px; position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px;"></iframe>
					<canvas id="realtime" height="160" style="width: 100%; height: 160px;"></canvas>
				</div>
				<br>
				
				<div align="left">Sensores Din</div>
				<div><iframe class="chartjs-hidden-iframe" style="width: 100%; display: block; border: 0px; height: 0px; margin: 0px; position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px;"></iframe>
					<canvas id="realtDin" height="160" style="width: 100%; height: 160px;"></canvas>
				</div>
				<br>
				
				<div align="left">Relay dout</div>
				<div><iframe class="chartjs-hidden-iframe" style="width: 100%; display: block; border: 0px; height: 0px; margin: 0px; position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px;"></iframe>
					<canvas id="realdout" height="160" style="width: 100%; height: 160px;"></canvas>
				</div>
				<br>
				
				<div align="left">Temperatura</div>
				<div><iframe class="chartjs-hidden-iframe" style="width: 100%; display: block; border: 0px; height: 0px; margin: 0px; position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px;"></iframe>
					<canvas id="realtemp" height="160" style="width: 100%; height: 160px;"></canvas>
				</div>
				<br>
				
				<div align="left">Humedad</div>
				<div><iframe class="chartjs-hidden-iframe" style="width: 100%; display: block; border: 0px; height: 0px; margin: 0px; position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px;"></iframe>
					<canvas id="realhumedy" height="160" style="width: 100%; height: 160px;"></canvas>
				</div>
				<br>
				
				<div class="modal-footer">
					<button type="button" id="Eliminar_El" class="btn btn-danger" data-dismiss="modal">Eliminar Elemento</button>
					<button type="button" id="CV_password" class="btn btn-success" data-dismiss="modal">Cambiar contraseña de elemento</button>
					<button type="button" class="btn btn-white" data-dismiss="modal">Cerrar</button>
				</div>
			</div>
		</div>
		</div>
	</div>
	
	<div class="modal inmodal" id="relaysModalConfig" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content animated bounceInRight">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
					<i class="fa fa-bolt modal-icon"></i>
					<h4 class="modal-title">Relays</h4>
				</div>
				<div class="modal-body">
					<div align="center">En caso de usar telefono gire pantalla <i class="fa fa-rotate-left" style="color: blue;"></i></div>
					<div align="center">para usar el filtro indique fecha y turno: DD/MM/YYYY am ó pm</div>
					<br>
					<br>
					<div class="ibox-content">
						<h3 align="center">Encendido</h3>
						<div class="row">
							<div class="col-md-3">
								<p>
									Frecuencia
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="frecuencia">
								</select>
							</div>
							<div class="col-md-3">
								<p>
									Día
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="diasFrecue">
								</select>
							</div>
							<div class="col-md-2">
								<p>
									Relay
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="relaySele">
									<option value=""></option>
									<option value="0">Dout 0</option>
									<option value="1">Dout 1</option>
									<option value="2">Dout 2</option>
									<option value="3">Dout 3</option>
								</select>
							</div>
							<div class="col-md-2">
								<p>
									Hora
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="horaFre">
								</select>
							</div>
							<div class="col-md-2">
								<p>
									Minuto
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="minutoFre">
								</select>
							</div>
						</div>
						
						<br>
						<table id="TableEncendido" class="table table-bordered table-hover animated fadeIn" cellspacing="0" width="100%">
						</table>
						
						<h3 align="center">Apagado</h3>
						<div class="row">
							<div class="col-md-3">
								<p>
									Frecuencia
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="frecuenciaA">
								</select>
							</div>
							<div class="col-md-3">
								<p>
									Día
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="diasFrecueA">
								</select>
							</div>
							<div class="col-md-2">
								<p>
									Relay
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="relaySele2">
									<option value=""></option>
									<option value="0">Dout 0</option>
									<option value="1">Dout 1</option>
									<option value="2">Dout 2</option>
									<option value="3">Dout 3</option>
								</select>
							</div>
							<div class="col-md-2">
								<p>
									Hora
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="horaFreA">
								</select>
							</div>
							<div class="col-md-2">
								<p>
									Minuto
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="minutoFreA">
								</select>
							</div>
						</div>
						<br>
						
						<table id="TableApagado" class="table table-bordered table-hover animated fadeIn" cellspacing="0" width="100%">
						</table>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" id="C_encendido" class="btn btn-primary" data-dismiss="modal">Crear On</button>
					<button type="button" id="E_encendido" class="btn btn-danger" data-dismiss="modal">Eliminar On</button>
					<button type="button" id="C_apagado" class="btn btn-primary" data-dismiss="modal">Crear Off</button>
					<button type="button" id="E_apagado" class="btn btn-danger" data-dismiss="modal">Eliminar Off</button>
					<button type="button" id="r_estado_relay" class="btn btn-success" data-dismiss="modal"></button>
					<button type="button" class="btn btn-white" data-dismiss="modal">Cerrar</button>
				</div>
			</div>
		</div>
	</div>
	
	<div class="modal inmodal" id="modalRelay" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog">
		<div class="modal-content animated bounceInRight">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
					<i class="fa fa-cogs modal-icon" style="color:blue"></i>
					<h4 class="modal-title">Lista de relays</h4>
				</div>
				<div class="modal-body">
					<div align="center">En caso de usar telefono gire pantalla <i class="fa fa-rotate-left" style="color: blue;"></i></div>
					<div align="center">para usar el filtro indique fecha y turno: DD/MM/YYYY am ó pm</div>
					<br>
					<br>
					<table id="TableRelaysTodos" class="table table-bordered table-hover animated fadeIn" cellspacing="0" width="100%">
					</table>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-white" data-dismiss="modal">Cerrar</button>
					<button type="button" id="SeleccionRelay" class="btn btn-success" data-dismiss="modal">Configuración</button>
				</div>
			</div>
		</div>
	</div>
	
	<div class="modal inmodal" id="modalRelaygraf" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog">
		<div class="modal-content animated bounceInRight">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
					<i class="fa fa-history modal-icon" style="color:green;"></i>
					<h4 class="modal-title">Gráfica > Sms > Relays</h4>
				</div>
				<div class="modal-body">
					<div align="center">En caso de usar telefono gire pantalla <i class="fa fa-rotate-left" style="color: blue;"></i></div>
					<br>
					<br>
					<div class="ibox-content">
						<div class="row">
							<input type="hidden" name="relarh" value="">
							<div class="col-md-4">
								<p>
									Año
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="anoslisr">
								</select>
							</div>
							<div class="col-md-4">
								<p>
									Mes
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="meslisr">
								</select>
							</div>
							<div class="col-md-4">
								<p>
									Día
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="diaslisr">
								</select>
							</div>
						</div>
					</div>
					
					<div><iframe class="chartjs-hidden-iframe" style="width: 100%; display: block; border: 0px; height: 0px; margin: 0px; position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px;"></iframe>
						<div id="mostrarLey"><span class="label label-danger">Off</span><span class="label label-success">On</span></div>
						<br>
						<canvas id="realDatosRelay" height="230" style="display: none; height: 230px;"></canvas>
					</div>
					<br>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-white" data-dismiss="modal">Cerrar</button>
				</div>
			</div>
		</div>
	</div>
	
	<div class="modal inmodal" id="modalRelaygraftrama" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog">
		<div class="modal-content animated bounceInRight">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
					<i class="fa fa-history modal-icon" style="color:green;"></i>
					<h4 class="modal-title">Gráfica > Trama > Relays</h4>
				</div>
				<div class="modal-body">
					<div align="center">En caso de usar telefono gire pantalla <i class="fa fa-rotate-left" style="color: blue;"></i></div>
					<br>
					<br>
					<div class="ibox-content">
						<div class="row">
							<div class="col-md-3">
								<p>
									Sensor
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="sensDtrama">
								</select>
							</div>
							<div class="col-md-3">
								<p>
									Año
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="anoslisrtrama">
								</select>
							</div>
							<div class="col-md-3">
								<p>
									Mes
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="meslisrtrama">
								</select>
							</div>
							<div class="col-md-3">
								<p>
									Día
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="diaslisrtrama">
								</select>
							</div>
						</div>
					</div>
					
					<div><iframe class="chartjs-hidden-iframe" style="width: 100%; display: block; border: 0px; height: 0px; margin: 0px; position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px;"></iframe>
						<br>
						<canvas id="realDatosRelaytrama" height="230" style="height: 230px;"></canvas>
					</div>
					<br>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-white" data-dismiss="modal">Cerrar</button>
				</div>
			</div>
		</div>
	</div>
	
	<div class="modal inmodal" id="modalgraftramax" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog">
		<div class="modal-content animated bounceInRight">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
					<i class="fa fa-history modal-icon" style="color:green;"></i>
					<h4 class="modal-title">Gráfica > Trama > Temperatura</h4>
				</div>
				<div class="modal-body">
					<div align="center">En caso de usar telefono gire pantalla <i class="fa fa-rotate-left" style="color: blue;"></i></div>
					<br>
					<br>
					<div class="ibox-content">
						<div class="row">
							<div class="col-md-4">
								<p>
									Año
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="anoslisrtramatemp">
								</select>
							</div>
							<div class="col-md-4">
								<p>
									Mes
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="meslisrtramatemp">
								</select>
							</div>
							<div class="col-md-4">
								<p>
									Día
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="diaslisrtramatemp">
								</select>
							</div>
						</div>
					</div>
					
					<div><iframe class="chartjs-hidden-iframe" style="width: 100%; display: block; border: 0px; height: 0px; margin: 0px; position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px;"></iframe>
						<br>
						<canvas id="realDatosRelaytramax" height="230" style="height: 230px;"></canvas>
					</div>
					<br>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-white" data-dismiss="modal">Cerrar</button>
				</div>
			</div>
		</div>
	</div>
	
	<div class="modal inmodal" id="modalgraftramaHumedy" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog">
		<div class="modal-content animated bounceInRight">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
					<i class="fa fa-history modal-icon" style="color:green;"></i>
					<h4 class="modal-title">Gráfica > Trama > Humedad </h4>
				</div>
				<div class="modal-body">
					<div align="center">En caso de usar telefono gire pantalla <i class="fa fa-rotate-left" style="color: blue;"></i></div>
					<br>
					<br>
					<div class="ibox-content">
						<div class="row">
							<div class="col-md-4">
								<p>
									Año
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="anoslisrtramahume">
								</select>
							</div>
							<div class="col-md-4">
								<p>
									Mes
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="meslisrtramahume">
								</select>
							</div>
							<div class="col-md-4">
								<p>
									Día
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="diaslisrtramahume">
								</select>
							</div>
						</div>
					</div>
					
					<div><iframe class="chartjs-hidden-iframe" style="width: 100%; display: block; border: 0px; height: 0px; margin: 0px; position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px;"></iframe>
						<br>
						<canvas id="realDatostramahumedy" height="230" style="height: 230px;"></canvas>
					</div>
					<br>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-white" data-dismiss="modal">Cerrar</button>
				</div>
			</div>
		</div>
	</div>
	
	<div class="modal inmodal" id="modalRelayhistory" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog">
		<div class="modal-content animated bounceInRight">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
					<i class="fa fa-history modal-icon" style="color:blue;"></i>
					<h4 class="modal-title">Historial > Sms > Relays</h4>
				</div>
				<div class="modal-body">
					<div align="center">En caso de usar telefono gire pantalla <i class="fa fa-rotate-left" style="color: blue;"></i></div>
					<div align="center">para usar el filtro indique fecha y turno: DD/MM/YYYY am ó pm</div>
					<br>
					<br>
					<table id="TableRelayHistory" class="table table-bordered table-hover animated fadeIn" cellspacing="0" width="100%">
					</table>
				<br>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-white" data-dismiss="modal">Cerrar</button>
				</div>
			</div>
		</div>
	</div>
	
	<div class="modal inmodal" id="modaltemphistorytrama" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog">
		<div class="modal-content animated bounceInRight">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
					<i class="fa fa-history modal-icon" style="color:blue;"></i>
					<h4 class="modal-title">Historial > Trama > Temperatura</h4>
				</div>
				<div class="modal-body">
					<div align="center">En caso de usar telefono gire pantalla <i class="fa fa-rotate-left" style="color: blue;"></i></div>
					<div align="center">para usar el filtro indique fecha y turno: DD/MM/YYYY am ó pm</div>
					<br>
					<br>
					<table id="TableTempHistory" class="table table-bordered table-hover animated fadeIn" cellspacing="0" width="100%">
					</table>
				<br>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-white" data-dismiss="modal">Cerrar</button>
				</div>
			</div>
		</div>
	</div>
	
	<div class="modal inmodal" id="modalRelayhistoryTemp" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog">
		<div class="modal-content animated bounceInRight">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
					<i class="fa fa-history modal-icon" style="color:blue;"></i>
					<h4 class="modal-title">Historial > Sms > Temperatura</h4>
				</div>
				<div class="modal-body">
					<div align="center">En caso de usar telefono gire pantalla <i class="fa fa-rotate-left" style="color: blue;"></i></div>
					<div align="center">para usar el filtro indique fecha y turno: DD/MM/YYYY am ó pm</div>
					<br>
					<br>
					<table id="TableRelayHistoryTemp" class="table table-bordered table-hover animated fadeIn" cellspacing="0" width="100%">
					</table>
				<br>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-white" data-dismiss="modal">Cerrar</button>
				</div>
			</div>
		</div>
	</div>
	
	<div class="modal inmodal" id="modalRelayhistoryHume" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog">
		<div class="modal-content animated bounceInRight">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
					<i class="fa fa-history modal-icon" style="color:blue;"></i>
					<h4 class="modal-title">Historial > Sms > Humedad</h4>
				</div>
				<div class="modal-body">
					<div align="center">En caso de usar telefono gire pantalla <i class="fa fa-rotate-left" style="color: blue;"></i></div>
					<div align="center">para usar el filtro indique fecha y turno: DD/MM/YYYY am ó pm</div>
					<br>
					<br>
					<table id="TableRelayHistoryHume" class="table table-bordered table-hover animated fadeIn" cellspacing="0" width="100%">
					</table>
				<br>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-white" data-dismiss="modal">Cerrar</button>
				</div>
			</div>
		</div>
	</div>
	
	<div class="modal inmodal" id="modalhistorialsmsdin" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog">
		<div class="modal-content animated bounceInRight">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
					<i class="fa fa-history modal-icon" style="color:blue;"></i>
					<h4 class="modal-title">Historial > Sms > Din</h4>
				</div>
				<div class="modal-body">
					<div align="center">En caso de usar telefono gire pantalla <i class="fa fa-rotate-left" style="color: blue;"></i></div>
					<div align="center">para usar el filtro indique fecha y turno: DD/MM/YYYY am ó pm</div>
					<br>
					<br>
					<table id="TabledinHistorysms" class="table table-bordered table-hover animated fadeIn" cellspacing="0" width="100%">
					</table>
				<br>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-white" data-dismiss="modal">Cerrar</button>
				</div>
			</div>
		</div>
	</div>
	
	<div class="modal inmodal" id="modalRelayhistorytrama" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog">
		<div class="modal-content animated bounceInRight">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
					<i class="fa fa-history modal-icon" style="color:blue;"></i>
					<h4 class="modal-title">Historial > Trama > Relays</h4>
				</div>
				<div class="modal-body">
					<div align="center">En caso de usar telefono gire pantalla <i class="fa fa-rotate-left" style="color: blue;"></i></div>
					<div align="center">para usar el filtro indique fecha y turno: DD/MM/YYYY am ó pm</div>
					<br>
					<br>
					<table id="TableRelayHistorytrama" class="table table-bordered table-hover animated fadeIn" cellspacing="0" width="100%">
					</table>
				<br>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-white" data-dismiss="modal">Cerrar</button>
				</div>
			</div>
		</div>
	</div>
	
	<div class="modal inmodal" id="modalhumedadtrama" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog">
		<div class="modal-content animated bounceInRight">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
					<i class="fa fa-history modal-icon" style="color:blue;"></i>
					<h4 class="modal-title">Historial > Trama > Humedad</h4>
				</div>
				<div class="modal-body">
					<div align="center">En caso de usar telefono gire pantalla <i class="fa fa-rotate-left" style="color: blue;"></i></div>
					<div align="center">para usar el filtro indique fecha y turno: DD/MM/YYYY am ó pm</div>
					<br>
					<br>
					<table id="Tablehumedadtrama" class="table table-bordered table-hover animated fadeIn" cellspacing="0" width="100%">
					</table>
				<br>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-white" data-dismiss="modal">Cerrar</button>
				</div>
			</div>
		</div>
	</div>
	
	<div class="modal inmodal" id="modaltramadin" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog">
		<div class="modal-content animated bounceInRight">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
					<i class="fa fa-history modal-icon" style="color:blue;"></i>
					<h4 class="modal-title">Historial > Trama > Din</h4>
				</div>
				<div class="modal-body">
					<div align="center">En caso de usar telefono gire pantalla <i class="fa fa-rotate-left" style="color: blue;"></i></div>
					<div align="center">para usar el filtro indique fecha y turno: DD/MM/YYYY am ó pm</div>
					<br>
					<br>
					<table id="Tabletramadin" class="table table-bordered table-hover animated fadeIn" cellspacing="0" width="100%">
					</table>
				<br>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-white" data-dismiss="modal">Cerrar</button>
				</div>
			</div>
		</div>
	</div>

	<div class="modal inmodal" id="modalGrafica" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content animated bounceInRight">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
					<i class="fa fa-percent modal-icon" style="color:red;"></i>
					<h4 class="modal-title">Gráfica > Sms > Ains</h4>
				</div>
				<div class="modal-body">
					<div align="center">En caso de usar telefono gire pantalla <i class="fa fa-rotate-left" style="color: blue;"></i></div>
					<br>
					<br>
					<div class="ibox-content">
						<div class="row">
							<div class="col-md-3">
								<p>
									Sensor
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="sens">
								</select>
							</div>

							<div class="col-md-3">
								<p>
									Año
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="anoslis">
								</select>
							</div>
							<div class="col-md-3">
								<p>
									Mes
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="meslis">
								</select>
							</div>
							<div class="col-md-3">
								<p>
									Día
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="diaslis">
								</select>
							</div>
						</div>
					</div>
				</div>
				<div><iframe class="chartjs-hidden-iframe" style="width: 100%; display: block; border: 0px; height: 0px; margin: 0px; position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px;"></iframe>
					<canvas id="doughnutChartDos" height="160" style="display: block; height: 160px;"></canvas>
				</div>
				<br>
				<div class="modal-footer">
					<button type="button" class="btn btn-white" data-dismiss="modal">Cerrar</button>
				</div>
			</div>
		</div>
	</div>
	
	<div class="modal inmodal" id="modalGrafica2" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content animated bounceInRight">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
					<i class="fa fa-percent modal-icon" style="color:red;"></i>
					<h4 class="modal-title">Gráfica > Trama > Ains</h4>
				</div>
				<div class="modal-body">
					<div align="center">En caso de usar telefono gire pantalla <i class="fa fa-rotate-left" style="color: blue;"></i></div>
					<br>
					<br>
					<div class="ibox-content">
						<div class="row">
							<div class="col-md-3">
								<p>
									Sensor
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="sensD">
								</select>
							</div>

							<div class="col-md-3">
								<p>
									Año
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="anoslisD">
								</select>
							</div>
							<div class="col-md-3">
								<p>
									Mes
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="meslisD">
								</select>
							</div>
							<div class="col-md-3">
								<p>
									Día
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="diaslisD">
								</select>
							</div>
						</div>
					</div>
				</div>
				<div><iframe class="chartjs-hidden-iframe" style="width: 100%; display: block; border: 0px; height: 0px; margin: 0px; position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px;"></iframe>
					<canvas id="doughnutChartDos2" height="160" style="display: block; height: 160px;"></canvas>
				</div>
				<br>
				<div class="modal-footer">
					<button type="button" class="btn btn-white" data-dismiss="modal">Cerrar</button>
				</div>
			</div>
		</div>
	</div>
	
	<div class="modal inmodal" id="iconModal" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog">
		<div class="modal-content animated bounceInRight">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
					<h4 class="modal-title">Elegir sitio</h4>
				</div>
				<div class="modal-body">
					<div align="center">En caso de usar telefono gire pantalla <i class="fa fa-rotate-left" style="color: blue;"></i></div>
					<br>
					<br>
					<div class="row">
						<div class="col-xs-1" style="width: 33.333333%;" onclick="puntero('/img/m2m/aceite_c.png');"><img src="img/m2m/aceite_c.png" style="width: 31%;"> Aceite</div>
						<div class="col-xs-1" style="width: 33.333333%;" onclick="puntero('/img/m2m/acondicionador-de-aire_c.png');"><img src="img/m2m/acondicionador-de-aire_c.png" style="width: 31%;"> Aire</div>
						<div class="col-xs-1" style="width: 33.333333%;" onclick="puntero('/img/m2m/almacen_c.png');"><img src="img/m2m/almacen_c.png" style="width: 31%;"> Almacen</div>
						<div class="col-xs-1" style="width: 33.333333%;" onclick="puntero('/img/m2m/electric-tower_c.png');"><img src="img/m2m/electric-tower_c.png" style="width: 31%;"> Estacion electrica</div>
						<div class="col-xs-1" style="width: 33.333333%;" onclick="puntero('/img/m2m/ajustes_c.png');"><img src="img/m2m/ajustes_c.png" style="width: 31%;"> Ajustes</div>
						<div class="col-xs-1" style="width: 33.333333%;" onclick="puntero('/img/m2m/escuela_c.png');"><img src="img/m2m/escuela_c.png" style="width: 31%;"> Escuela</div>
						<div class="col-xs-1" style="width: 33.333333%;" onclick="puntero('/img/m2m/ecologia_c.png');"><img src="img/m2m/ecologia_c.png" style="width: 31%;"> Ecologia</div>
						<div class="col-xs-1" style="width: 33.333333%;" onclick="puntero('/img/m2m/grua_c.png');"><img src="img/m2m/grua_c.png" style="width: 31%;"> Grua</div>
						<div class="col-xs-1" style="width: 33.333333%;" onclick="puntero('/img/m2m/tanque_c.png');"><img src="img/m2m/tanque_c.png" style="width: 31%;"> Tanque</div>
						<div class="col-xs-1" style="width: 33.333333%;" onclick="puntero('/img/m2m/oxigeno_c.png');"><img src="img/m2m/oxigeno_c.png" style="width: 31%;"> Oxigeno</div>
						<div class="col-xs-1" style="width: 33.333333%;" onclick="puntero('/img/m2m/petroleo_c.png');"><img src="img/m2m/petroleo_c.png" style="width: 31%;"> Petroleo</div>
						<div class="col-xs-1" style="width: 33.333333%;" onclick="puntero('/img/m2m/voltmeter_c.png');"><img src="img/m2m/voltmeter_c.png" style="width: 31%;"> Voltimetro</div>
						<div class="col-xs-1" style="width: 33.333333%;" onclick="puntero('/img/m2m/bateria_c.png');"><img src="img/m2m/bateria_c.png" style="width: 31%;"> Bateria</div>
						<div class="col-xs-1" style="width: 33.333333%;" onclick="puntero('/img/m2m/tuberia-de-gas_c.png');"><img src="img/m2m/tuberia-de-gas_c.png" style="width: 31%;"> Tuberia gas</div>
						<div class="col-xs-1" style="width: 33.333333%;" onclick="puntero('/img/m2m/carro_c.png');"><img src="img/m2m/carro_c.png" style="width: 31%;"> Carro</div>
						<div class="col-xs-1" style="width: 33.333333%;" onclick="puntero('/img/m2m/presa_c.png');"><img src="img/m2m/presa_c.png" style="width: 31%;"> Prensa</div>
						<div class="col-xs-1" style="width: 33.333333%;" onclick="puntero('/img/m2m/radiacion_c.png');"><img src="img/m2m/radiacion_c.png" style="width: 31%;"> Radiacion</div>
						<div class="col-xs-1" style="width: 33.333333%;" onclick="puntero('/img/m2m/bombilla_c.png');"><img src="img/m2m/bombilla_c.png" style="width: 31%;"> Bombilla</div>
						<div class="col-xs-1" style="width: 33.333333%;" onclick="puntero('/img/m2m/planta-nuclear_c.png');"><img src="img/m2m/planta-nuclear_c.png" style="width: 31%;"> Planta nuclear</div>
						<div class="col-xs-1" style="width: 33.333333%;" onclick="puntero('/img/m2m/tubo_c.png');"><img src="img/m2m/tubo_c.png" style="width: 31%;"> Tubo</div>
						<div class="col-xs-1" style="width: 33.333333%;" onclick="puntero('/img/m2m/fabrica_c.png');"><img src="img/m2m/fabrica_c.png" style="width: 31%;"> Fabrica</div>
						<div class="col-xs-1" style="width: 33.333333%;" onclick="puntero('/img/m2m/transportadora_c.png');"><img src="img/m2m/transportadora_c.png" style="width: 31%;"> Transportadora</div>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-white" data-dismiss="modal">Cerrar</button>
				</div>
			</div>
		</div>
	</div>

	<div class="modal inmodal" id="history247modal" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content animated bounceInRight">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
					<i class="fa fa-history modal-icon" style="color:red;"></i>
					<h4 class="modal-title">Historial 24/7</h4>
				</div>
				<div class="modal-body">
					<div align="center">En caso de usar telefono gire pantalla <i class="fa fa-rotate-left" style="color: blue;"></i></div>
					<div align="center">para usar el filtro indique fecha y turno: DD/MM/YYYY am ó pm</div>
					<br>
					<br>
					<table id="History247todo" class="table table-bordered table-hover animated fadeIn" cellspacing="0" width="100%">
					</table>
				</div>
				<div class="modal-footer">
					<button id="borrarTodo" type="button" class="btn btn-danger">Borrar historial</button>
					<button type="button" class="btn btn-white" data-dismiss="modal">Cerrar</button>
				</div>
				
				<br>
			</div>
		</div>
	</div>	
	
	<div class="modal inmodal" id="modalGrafaTemp" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog">
		<div class="modal-content animated bounceInRight">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
					<i class="fa fa-history modal-icon" style="color:green;"></i>
					<h4 class="modal-title">Gráfica > Sms > Temperatura</h4>
				</div>
				<div class="modal-body">
					<div align="center">En caso de usar telefono gire pantalla <i class="fa fa-rotate-left" style="color: blue;"></i></div>
					<br>
					<br>
					<div class="ibox-content">
						<div class="row">
							<input type="hidden" name="relarht" value="">
							<div class="col-md-4">
								<p>
									Año
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="anoslisrTempsms">
								</select>
							</div>
							<div class="col-md-4">
								<p>
									Mes
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="meslisrTempsms">
								</select>
							</div>
							<div class="col-md-4">
								<p>
									Día
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="diaslisrTempsms">
								</select>
							</div>
						</div>
					</div>
					
					<div><iframe class="chartjs-hidden-iframe" style="width: 100%; display: block; border: 0px; height: 0px; margin: 0px; position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px;"></iframe>
						<br>
						<canvas id="realRelaytemp2" height="230" style="height: 230px;"></canvas>
					</div>
					<br>
				</div>
			
				<div class="modal-footer">
					<button type="button" class="btn btn-white" data-dismiss="modal">Cerrar</button>
				</div>
			</div>
		</div>
	</div>
	
	<div class="modal inmodal" id="modalGrafaHume" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog">
		<div class="modal-content animated bounceInRight">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
					<i class="fa fa-history modal-icon" style="color:green;"></i>
					<h4 class="modal-title">Gráfica > Sms > Humedad</h4>
				</div>
				<div class="modal-body">
					<div align="center">En caso de usar telefono gire pantalla <i class="fa fa-rotate-left" style="color: blue;"></i></div>
					<br>
					<br>
					<div class="ibox-content">
						<div class="row">
							<input type="hidden" name="relarht" value="">
							<div class="col-md-4">
								<p>
									Año
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="anoslisrHumesms">
								</select>
							</div>
							<div class="col-md-4">
								<p>
									Mes
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="meslisrHumesms">
								</select>
							</div>
							<div class="col-md-4">
								<p>
									Día
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="diaslisrHumesms">
								</select>
							</div>
						</div>
					</div>
					
					<div><iframe class="chartjs-hidden-iframe" style="width: 100%; display: block; border: 0px; height: 0px; margin: 0px; position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px;"></iframe>
						<br>
						<canvas id="realgrafihume2" height="230" style="height: 230px;"></canvas>
					</div>
					<br>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-white" data-dismiss="modal">Cerrar</button>
				</div>
			</div>
		</div>
	</div>
	
	<div class="modal inmodal" id="smodalDinsms" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog">
		<div class="modal-content animated bounceInRight">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
					<i class="fa fa-history modal-icon" style="color:green;"></i>
					<h4 class="modal-title">Gráfica > Sms > Din</h4>
				</div>
				<div class="modal-body">
					<div align="center">En caso de usar telefono gire pantalla <i class="fa fa-rotate-left" style="color: blue;"></i></div>
					<br>
					<br>
					<div class="ibox-content">
						<div class="row">
							<input type="hidden" name="relarht" value="">
							<div class="col-md-4">
								<p>
									Año
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="anoslisrdinsms">
								</select>
							</div>
							<div class="col-md-4">
								<p>
									Mes
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="meslisrdinsms">
								</select>
							</div>
							<div class="col-md-4">
								<p>
									Día
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="diaslisrdinsms">
								</select>
							</div>
						</div>
					</div>
					
					<div><iframe class="chartjs-hidden-iframe" style="width: 100%; display: block; border: 0px; height: 0px; margin: 0px; position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px;"></iframe>
						<br>
						<canvas id="realgrafidin" height="230" style="height: 230px;"></canvas>
					</div>
					<br>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-white" data-dismiss="modal">Cerrar</button>
				</div>
			</div>
		</div>
	</div>
	
	
	<div class="modal inmodal" id="indica" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog">
		<div class="modal-content animated bounceInRight">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
					<i class="fa fa-cube modal-icon" style="color: blue;"></i>
					<h4 class="modal-title">Indicadores</h4>
				</div>
				<div class="modal-body">
					<div align="center">En caso de usar telefono gire pantalla <i class="fa fa-rotate-left" style="color: blue;"></i></div>
					<br>
					<br>
					<div class="col-md-3">
						<p>
							Relay
						</p>
						<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="senInd">
								
							<option value="">Seleccione Relay</option>
							<option value="Sensor">Ain</option>
							<option value="DIM">Din</option>
							<option value="Temperature">Temperatura</option>
							<option value="Humedy">Humedad</option>
									
						</select>
					</div>
					<div class="col-md-3">
						<p>
							Indice
						</p>
						<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="senIdentifaca">			
						</select>
					</div>
					<div class="col-md-3">
						<p>
							Alarma
						</p>
						<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="senIndalarm">			
						
							<option value="">Seleccione alarma</option>
							<option value="Bajo">Bajo</option>
							<option value="Alto">Alto</option>
							
						</select>
					</div>
					<div class="col-md-3">
						<p>
							Valor
						</p>
						<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="senIndmax">		
						</select>
					</div>
					<br>
					<br>
				</div>
				<div class="modal-footer">
					<button id="agglimite" type="button" class="btn btn-primary">Agregar</button>
					<button type="button" class="btn btn-white" data-dismiss="modal">Cerrar</button>
				</div>
			</div>
		</div>
	</div>
	
	
	<div class="modal inmodal" id="smodalDintrama" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog">
		<div class="modal-content animated bounceInRight">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
					<i class="fa fa-history modal-icon" style="color:green;"></i>
					<h4 class="modal-title">Gráfica > Trama > Din</h4>
				</div>
				<div class="modal-body">
					<div align="center">En caso de usar telefono gire pantalla <i class="fa fa-rotate-left" style="color: blue;"></i></div>
					<br>
					<br>
					<div class="ibox-content">
						<div class="row">
							<input type="hidden" name="relarht" value="">
							<div class="col-md-3">
								<p>
									Sensor
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="sensDim">
								</select>
							</div>
							<div class="col-md-3">
								<p>
									Año
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="anoslisrdintrama">
								</select>
							</div>
							<div class="col-md-3">
								<p>
									Mes
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="meslisrdintrama">
								</select>
							</div>
							<div class="col-md-3">
								<p>
									Día
								</p>
								<select class="select2_demo_1 form-control select2-hidden-accessible" tabindex="-1" aria-hidden="true" id="diaslisrdintrama">
								</select>
							</div>
						</div>
					</div>
					
					<div><iframe class="chartjs-hidden-iframe" style="width: 100%; display: block; border: 0px; height: 0px; margin: 0px; position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px;"></iframe>
						<br>
						<canvas id="realgrafidintrama" height="230" style="height: 230px;"></canvas>
					</div>
					<div align="center"><strong> 
						<label style="color:#79d2c0">NO</label> 
						<label style="color:#d3d3d3">CHANGE</label> 
						<label style="color:#1ab394">NC</label>
						<label style="color:#1c84c6">Couter</label>
					</strong></div>
					<br>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-white" data-dismiss="modal">Cerrar</button>
				</div>
			</div>
		</div>
	</div>
	
    <div id="wrapper">
	
	<noscript>
	 Para utilizar las funcionalidades completas de este sitio es necesario tener
	 JavaScript habilitado. Aquí están las <a href="https://www.enable-javascript.com/es/"
	 target="_blank"> instrucciones para habilitar JavaScript en tu navegador web</a>.
	</noscript>
	
    <nav class="navbar-default navbar-static-side" role="navigation">
        <div class="sidebar-collapse">
            <ul class="nav metismenu" id="side-menu">
                <li class="nav-header">
                    <div class="dropdown profile-element"> <span>
                            <img alt="image" class="img-circle" src="img/m2mimg.png" style="margin-left: 20%;margin-left: 20%;width: 40px;height: 40px;"/>
                             </span>
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                            <span class="clear"> <span class="block m-t-xs"> <strong class="font-bold" id="nameIn">Cargando...</strong>
                             </span> <span class="text-muted text-xs block" id="nameInC">Cargando...</span> </span> </a>
                       
                    </div>
                    <div class="logo-element">
                        M2M
                    </div>
                </li>
				<li>
                    <a data-toggle="modal" data-target="#iconModal" ><i class="fa fa-cogs"></i> <span class="nav-label">Elemento</span><span class="label label-warning pull-right">Al menos 1</span></a>
                </li>
				<li>
                    <a data-toggle="modal" id ="usersManager"  data-target="#usersModal" ><i class="fa fa-users"></i> <span class="nav-label">Usuarios</span></a>
                </li>
				<li>
                    <a id ="history247" ><i class="fa fa-book"></i> <span class="nav-label">Historico 24/7</span></a>
                </li>
				<!--<li>
                    <a id ="reboot" ><i class="fa fa-refresh"></i> <span class="nav-label">Reboot</span></a>
                </li>-->
				<li> 
                    <a id ="pusher" ><i class="fa fa-key"></i> <span class="nav-label">Push (secret)</span></a>
                </li>
				<li> 
                    <a id ="indi" ><i class="fa fa-cube"></i> <span class="nav-label">Indicador alarma</span></a>
                </li>
				<li>
                    <a href="#"><i class="fa fa-history"></i> <span class="nav-label">Historiales</span><span class="fa arrow"></span></a>
                    <ul class="nav nav-second-level collapse">
                        <!--<li>
                            <a href="#">Via sms<span class="fa arrow"></span></a>
                            <ul class="nav nav-third-level">
                                <li>
									<a data-toggle="modal" id ="smshistorialM" ><i class="fa fa-bolt"></i> <span class="nav-label">Ains</span></a>
								</li>
								<li>
									<a id="ModalRelayHistorial" ><i class="fa fa-free-code-camp"></i> <span class="nav-label">Relay</span></a>
								</li>
								<li>
									<a id="grafrelaytemp" ><i class="fa fa-thermometer"></i> <span class="nav-label">Temperatura</span></a>
								</li>
								<li>
									<a id="grafrelayHume" ><i class="fa fa-snowflake-o"></i> <span class="nav-label">Humedad</span></a>
								</li>
								<li>
									<a id="historialsmsDin" ><i class="fa fa-plug"></i> <span class="nav-label">Din</span></a>
								</li>
                            </ul>
                        </li>-->
						<li>
                            <a href="#">Via trama<span class="fa arrow"></span></a>
                            <ul class="nav nav-third-level">
                                <li>
									<a data-toggle="modal" id ="tramahistorialM1"  ><i class="fa fa-bolt"></i> <span class="nav-label">Ains</span></a>
								</li>
								<li>
									<a id="ModalRelayHistorial2" ><i class="fa fa-free-code-camp"></i> <span class="nav-label">Relay</span></a>
								</li>
								<li>
									<a id="ModalRelayHistorial2temp" ><i class="fa fa-thermometer"></i> <span class="nav-label">Temperatura</span></a>
								</li>
								<li>
									<a id="grafrelayHumetrama" ><i class="fa fa-snowflake-o"></i> <span class="nav-label">Humedad</span></a>
								</li>
								<li>
									<a id="historialtramadin" ><i class="fa fa-plug"></i> <span class="nav-label">Din</span></a>
								</li>
                            </ul>
                        </li>
                    </ul>
                </li>
				<li>
                    <a href="#"><i class="fa fa-signal"></i> <span class="nav-label">Gráficas</span><span class="fa arrow"></span></a>
                    <ul class="nav nav-second-level collapse">
                        <!--<li>
                            <a href="#">Via sms<span class="fa arrow"></span></a>
                            <ul class="nav nav-third-level">
                                <li>
									<a data-toggle="modal" id="graficaModal" ><i class="fa fa-bolt"></i> <span class="nav-label">Ains</span></a>
								</li>
								<li>
									<a data-toggle="modal"  id="grafrelay"><i class="fa fa-free-code-camp"></i> <span class="nav-label">Relays</span></a>
								</li>
								<li>
									<a data-toggle="modal"  id="ModalHistorialtemp"><i class="fa fa-thermometer"></i> <span class="nav-label">Temperatura</span></a>
								</li>
								<li>
									<a data-toggle="modal"  id="ModalRelayHistorialhume"><i class="fa fa-snowflake-o"></i> <span class="nav-label">Humedad</span></a>
								</li>
								<li>
									<a data-toggle="modal"  id="Modaldinsms"><i class="fa fa-plug"></i> <span class="nav-label">Din</span></a>
								</li>
                            </ul>
                        </li>-->
						<li>
                            <a href="#">Via trama<span class="fa arrow"></span></a>
                            <ul class="nav nav-third-level">
                                <li>
									<a data-toggle="modal" id="graficaModal2" ><i class="fa fa-bolt"></i> <span class="nav-label">Ains</span></a>
								</li>
								<li>
									<a data-toggle="modal"  id="grafrelay2"><i class="fa fa-free-code-camp"></i> <span class="nav-label">Relays</span></a>
								</li>
								<li>
									<a data-toggle="modal"  id="grafrelay2temp"><i class="fa fa-thermometer"></i> <span class="nav-label">Temperatura</span></a>
								</li>
								<li>
									<a data-toggle="modal"  id="grafrelay2hume"><i class="fa fa-snowflake-o"></i> <span class="nav-label">Humedad</span></a>
								</li>
								<li>
									<a data-toggle="modal"  id="Modaltramasms"><i class="fa fa-plug"></i> <span class="nav-label">Din</span></a>
								</li>
                            </ul>
                        </li>
                    </ul>
                </li>
				
			</ul>
		</div>
	</nav>
	
		<div id="page-wrapper" class="gray-bg" >
        <div class="row border-bottom">
        <nav class="navbar navbar-static-top" role="navigation" style="margin-bottom: 0">
        <div class="navbar-header">
            <a class="navbar-minimalize minimalize-styl-2 btn btn-primary " href="#"><i class="fa fa-bars"></i> </a>
			 <form class="navbar-form-custom" style="margin-top: 7%; margin-bottom: -7%;">
			</form>

		</div>
            <ul class="nav navbar-top-links navbar-right">
				
                <li class="dropdown">
                    <a class="dropdown-toggle count-info" data-toggle="dropdown" href="#">
                        <i class="fa fa-envelope"></i>  <span class="label label-primary"id=numaprob>0</span>
                    </a>
                    <ul class="dropdown-menu dropdown-messages" id="menusListab">
                    </ul>
                </li>
				<li class="dropdown">
                    <a class="dropdown-toggle count-info" data-toggle="dropdown" href="#">
                        <i class="fa fa-bell"></i>  <span class="label label-warning"id=numaproa>0</span>
                    </a>
                    <ul class="dropdown-menu dropdown-messages" id="menusListaa">
                    </ul>
                </li>
				<li class="dropdown">
                    <a class="dropdown-toggle count-info" data-toggle="dropdown" href="#">
                        <i class="fa fa-exclamation-triangle"></i>  <span class="label label-danger"id=numaproc>0</span>
                    </a>
                    <ul class="dropdown-menu dropdown-messages" id="menusListac">
                    </ul>
                </li>				
				<li class="dropdown" style="top: 22px;">
					<div class="progress progress-striped active">
						<div id="bar1" style="padding-left: 13px; padding-right: 13px; width: 100%" aria-valuemax="100" aria-valuemin="0" aria-valuenow="100" role="progressbar" class="progress-bar progress-bar-danger">
							Off red
						</div>
					</div>
				</li>				
				<li>
                    <a id="salir">
                        <i class="fa fa-sign-out" > Salir</i>
                    </a>
                </li>
            </ul>

        </nav>
        </div>
		<style>
			.google-maps {
				position: relative;
				padding-bottom: 75%;
				height: 0;
				overflow: hidden;
			}
			
			.google-maps iframe {
				position: absolute;
				top: 0;
				left: 0;
				width: 100% !important;
				height: 100% !important;
			}
			
			#markerLayer img {
			  animation: pulse .5s infinite alternate;
			  -webkit-animation: pulse .5s infinite alternate;
			  transform-origin: center;
			  -webkit-transform-origin: center;
			}
		</style>
        <div class="wrapper wrapper-content  animated fadeInRight" id="dash" style=" width: 116%;   margin-left: -25px;">
		 <script src="js/plugins/toastr/toastr.min.js"></script>
		<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB0dqCPk9qmxN8dt2ztX7tQGx72yfF7dMg"></script>
			<div class="google-maps" id="map" ></div>
        </div>

        <div class="footer">
            <div class="pull-right">
                Estado: Conectado <div id="divId" style="display:none;"></div> <div id="divId2" style="display:none;"></div>
            </div>
            <div>
                 M2M - The Company <strong>Copyright</strong> 2018
            </div>
        </div>

        </div>
        </div>	
    <script src="js/jquery-3.1.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/plugins/metisMenu/jquery.metisMenu.js"></script>
    <script src="js/plugins/slimscroll/jquery.slimscroll.min.js"></script>
    <script src="js/inspinia.js"></script>
    <script src="js/backend.js"></script>
    <script src="js/moment.min.js"></script>
    <script src="js/plugins/pace/pace.min.js"></script>
	<script src="js/plugins/chartJs/Chart.min.js"></script>
	<script src="js/plugins/dataTables/datatables.min.js"></script>
	<script src="js/plugins/toastr/toastr.min.js"></script>
	<script src="js/timer.jquery.min.js"></script>
	<script src="js/plugins/c3/c3.min.js"></script>
    <script src="js/plugins/flot/jquery.flot.js"></script>
    <script src="js/plugins/flot/jquery.flot.tooltip.min.js"></script>
    <script src="js/plugins/flot/jquery.flot.spline.js"></script>
    <script src="js/plugins/flot/jquery.flot.resize.js"></script>
    <script src="js/plugins/flot/jquery.flot.pie.js"></script>
    <script src="js/plugins/flot/jquery.flot.symbol.js"></script>
    <script src="js/plugins/flot/jquery.flot.time.js"></script>
	<script type="text/javascript">
	
		backend.ip = "1.1.1.1";
		
		var auth = JSON.parse(window.sessionStorage.getItem("sesion"));
		var token = auth.t,email = auth.e;
		backend.query({"t":token,"e":email,"a":"limitantes"},block.ip,"8088",function(salida){

			var sali = JSON.parse(salida);
			if (!sali.e){
			
				var listatodo = JSON.parse(sali.m);
				for (var d = 0; d < listatodo.m.length; d++){
					var sensor = listatodo.m[d].se;
					var alarm = listatodo.m[d].al;
					var min = listatodo.m[d].mi;
					var max = listatodo.m[d].ma;
					window.sessionStorage.setItem(sensor+"_"+alarm+"_"+min,max);
				}
				
				toastr.info('Se cargo los limites');
			}
		});
	 
		$("#agglimite").click(function(){
			if ($("#senInd").val()!=="" && $("#senIndalarm").val()!=="" && $("#senIdentifaca").val()!==""){
				var auth = JSON.parse(window.sessionStorage.getItem("sesion"));
				var token = auth.t,email = auth.e;
				backend.query({"t":token,"e":email,"a":"limitar","d":{"se":$("#senInd").val(),"al":$("#senIndalarm").val(),"mi":$("#senIdentifaca").val(),"ma":$("#senIndmax").val()}},block.ip,"8088",function(salida){

					var sali = JSON.parse(salida);
					if (!sali.e){
						window.sessionStorage.setItem($("#senInd").val()+"_"+$("#senIndalarm").val()+"_"+$("#senIdentifaca").val(),$("#senIndmax").val());
						toastr.info('Se agrego limite');
					}
				});
			}			
		});
		
		$("#indi").click(function(){
			$("#indica").modal("show");
		});
		
		var texti4='<option value="">Seleccione valor referencial</option>';
		for (var gc = -100; gc < 1000; gc++){
			texti4=texti4+'<option value="'+gc+'">'+gc+'</option>';
		}
	
		$("#senIndmax").html(texti4);
		
		$("#senInd").change(function(){
			if($("#senInd").val()=="DIM" || $("#senInd").val()=="Sensor"){
				var tex='';
				for (var gc = 0; gc < 8; gc++){
					tex=tex+'<option value="'+gc+'">'+gc+'</option>';
				}
				$("#senIdentifaca").html(tex);
			}else if($("#senInd").val()=="Temperature" || $("#senInd").val()=="Humedy"){
				var tex='<option value="1">Unico</option>';
				$("#senIdentifaca").html(tex);
			}
		});
		
		
		$( window ).resize(function() {
			$("#map").css("height",$("#map").height() + 485);
		});
		
        google.maps.event.addDomListener(window, 'load', init);

		window.sessionStorage.setItem("ain0","true");
		function ain0(){
			if (window.sessionStorage.getItem("ain0")=="true"){
				window.sessionStorage.setItem("ain0","false");
				$("#ain0T").text("Sin datos");
				$("#ain0I").addClass("text-danger").removeClass("text-success");
			}else{
				window.sessionStorage.setItem("ain0","true");
				$("#ain0I").addClass("text-success").removeClass("text-danger");
			}
		}
		
		window.sessionStorage.setItem("ain1","true");
		function ain1(){
			if (window.sessionStorage.getItem("ain1")=="true"){
				window.sessionStorage.setItem("ain1","false");
				$("#ain1T").text("Sin datos");
				$("#ain1I").addClass("text-danger").removeClass("text-success");
			}else{
				window.sessionStorage.setItem("ain1","true");
				$("#ain1I").addClass("text-success").removeClass("text-danger");
			}
		}
		
		window.sessionStorage.setItem("ain2","true");
		function ain2(){
			if (window.sessionStorage.getItem("ain2")=="true"){
				window.sessionStorage.setItem("ain2","false");
				$("#ain2T").text("Sin datos");
				$("#ain2I").addClass("text-danger").removeClass("text-success");
			}else{
				window.sessionStorage.setItem("ain2","true");
				$("#ain2I").addClass("text-success").removeClass("text-danger");
			}
		}
		
		window.sessionStorage.setItem("ain3","true");
		function ain3(){
			if (window.sessionStorage.getItem("ain3")=="true"){
				window.sessionStorage.setItem("ain3","false");
				$("#ain3T").text("Sin datos");
				$("#ain3I").addClass("text-danger").removeClass("text-success");
			}else{
				window.sessionStorage.setItem("ain3","true");
				$("#ain3I").addClass("text-success").removeClass("text-danger");
			}
		}
		
		window.sessionStorage.setItem("ain4","true");
		function ain4(){
			if (window.sessionStorage.getItem("ain4")=="true"){
				window.sessionStorage.setItem("ain4","false");
				$("#ain4T").text("Sin datos");
				$("#ain4I").addClass("text-danger").removeClass("text-success");
			}else{
				window.sessionStorage.setItem("ain4","true");
				$("#ain4I").addClass("text-success").removeClass("text-danger");
			}
		}
		
		window.sessionStorage.setItem("ain5","true");
		function ain5(){
			if (window.sessionStorage.getItem("ain5")=="true"){
				window.sessionStorage.setItem("ain5","false");
				$("#ain5T").text("Sin datos");
				$("#ain5I").addClass("text-danger").removeClass("text-success");
			}else{
				window.sessionStorage.setItem("ain5","true");
				$("#ain5I").addClass("text-success").removeClass("text-danger");
			}
		}
		
		window.sessionStorage.setItem("ain6","true");
		function ain6(){
			if (window.sessionStorage.getItem("ain6")=="true"){
				window.sessionStorage.setItem("ain6","false");
				$("#ain6T").text("Sin datos");
				$("#ain6I").addClass("text-danger").removeClass("text-success");
			}else{
				window.sessionStorage.setItem("ain6","true");
				$("#ain6I").addClass("text-success").removeClass("text-danger");
			}
		}
		
		window.sessionStorage.setItem("ain7","true");
		function ain7(){
			if (window.sessionStorage.getItem("ain7")=="true"){
				window.sessionStorage.setItem("ain7","false");
				$("#ain7T").text("Sin datos");
				$("#ain7I").addClass("text-danger").removeClass("text-success");
			}else{
				window.sessionStorage.setItem("ain7","true");
				$("#ain7I").addClass("text-success").removeClass("text-danger");
			}
		}
		
		window.sessionStorage.setItem("batery_voltage","true");
		function batery_voltage(){
			if (window.sessionStorage.getItem("batery_voltage")=="true"){
				window.sessionStorage.setItem("batery_voltage","false");
				$("#batery_voltageT").text("Sin datos");
				$("#batery_voltageI").addClass("text-danger").removeClass("text-success");
			}else{
				window.sessionStorage.setItem("batery_voltage","true");
				$("#batery_voltageI").addClass("text-success").removeClass("text-danger");
			}
		}
		
		window.sessionStorage.setItem("dim1","true");
		function dim1(){
			if (window.sessionStorage.getItem("dim1")=="true"){
				window.sessionStorage.setItem("dim1","false");
				$("#dim1T").text("Sin datos");
				$("#dim1I").addClass("text-danger").removeClass("text-success");
			}else{
				window.sessionStorage.setItem("dim1","true");
				$("#dim1I").addClass("text-success").removeClass("text-danger");
			}
		}
		
		window.sessionStorage.setItem("dim2","true");
		function dim2(){
			if (window.sessionStorage.getItem("dim2")=="true"){
				window.sessionStorage.setItem("dim2","false");
				$("#dim2T").text("Sin datos");
				$("#dim2I").addClass("text-danger").removeClass("text-success");
			}else{
				window.sessionStorage.setItem("dim2","true");
				$("#dim2I").addClass("text-success").removeClass("text-danger");
			}
		}
		
		window.sessionStorage.setItem("dim3","true");
		function dim3(){
			if (window.sessionStorage.getItem("dim3")=="true"){
				window.sessionStorage.setItem("dim3","false");
				$("#dim3T").text("Sin datos");
				$("#dim3I").addClass("text-danger").removeClass("text-success");
			}else{
				window.sessionStorage.setItem("dim3","true");
				$("#dim3I").addClass("text-success").removeClass("text-danger");
			}
		}
		
		window.sessionStorage.setItem("dim4","true");
		function dim4(){
			if (window.sessionStorage.getItem("dim4")=="true"){
				window.sessionStorage.setItem("dim4","false");
				$("#dim4T").text("Sin datos");
				$("#dim4I").addClass("text-danger").removeClass("text-success");
			}else{
				window.sessionStorage.setItem("dim4","true");
				$("#dim4I").addClass("text-success").removeClass("text-danger");
			}
		}
		
		window.sessionStorage.setItem("dim5","true");
		function dim5(){
			if (window.sessionStorage.getItem("dim5")=="true"){
				window.sessionStorage.setItem("dim5","false");
				$("#dim5T").text("Sin datos");
				$("#dim5I").addClass("text-danger").removeClass("text-success");
			}else{
				window.sessionStorage.setItem("dim5","true");
				$("#dim5I").addClass("text-success").removeClass("text-danger");
			}
		}
		
		window.sessionStorage.setItem("dim6","true");
		function dim6(){
			if (window.sessionStorage.getItem("dim6")=="true"){
				window.sessionStorage.setItem("dim6","false");
				$("#dim6T").text("Sin datos");
				$("#dim6I").addClass("text-danger").removeClass("text-success");
			}else{
				window.sessionStorage.setItem("dim6","true");
				$("#dim6I").addClass("text-success").removeClass("text-danger");
			}
		}
		
		window.sessionStorage.setItem("dim7","true");
		function dim7(){
			if (window.sessionStorage.getItem("dim7")=="true"){
				window.sessionStorage.setItem("dim7","false");
				$("#dim7T").text("Sin datos");
				$("#dim7I").addClass("text-danger").removeClass("text-success");
			}else{
				window.sessionStorage.setItem("dim7","true");
				$("#dim7I").addClass("text-success").removeClass("text-danger");
			}
		}
		
		window.sessionStorage.setItem("dim8","true");
		function dim8(){
			if (window.sessionStorage.getItem("dim8")=="true"){
				window.sessionStorage.setItem("dim8","false");
				$("#dim8T").text("Sin datos");
				$("#dim8I").addClass("text-danger").removeClass("text-success");
			}else{
				window.sessionStorage.setItem("dim8","true");
				$("#dim8I").addClass("text-success").removeClass("text-danger");
			}
		}
		
		window.sessionStorage.setItem("temperature","true");
		function temperature(){
			if (window.sessionStorage.getItem("temperature")=="true"){
				window.sessionStorage.setItem("temperature","false");
				$("#temperatureT").text("Sin datos");
				$("#temperatureI").addClass("text-danger").removeClass("text-success");
			}else{
				window.sessionStorage.setItem("temperature","true");
				$("#temperatureI").addClass("text-success").removeClass("text-danger");
			}
		}
		
		window.sessionStorage.setItem("ac_power","true");
		function ac_power(){
			if (window.sessionStorage.getItem("ac_power")=="true"){
				window.sessionStorage.setItem("ac_power","false");
				$("#ac_powerT").text("Sin datos");
				$("#ac_powerI").addClass("text-danger").removeClass("text-success");
			}else{
				window.sessionStorage.setItem("ac_power","true");
				$("#ac_powerI").addClass("text-success").removeClass("text-danger");
			}
		}
		
		window.sessionStorage.setItem("gsm_signal","true");
		function gsm_signal(){
			if (window.sessionStorage.getItem("gsm_signal")=="true"){
				window.sessionStorage.setItem("gsm_signal","false");
				$("#gsm_signalT").text("Sin datos");
				$("#gsm_signalI").addClass("text-danger").removeClass("text-success");
			}else{
				window.sessionStorage.setItem("gsm_signal","true");
				$("#gsm_signalI").addClass("text-success").removeClass("text-danger");
			}
		}
		
		window.sessionStorage.setItem("arm_disarm","true");
		function arm_disarm(){
			if (window.sessionStorage.getItem("arm_disarm")=="true"){
				window.sessionStorage.setItem("arm_disarm","false");
				$("#arm_disarmT").text("Sin datos");
				$("#arm_disarmI").addClass("text-danger").removeClass("text-success");
			}else{
				window.sessionStorage.setItem("arm_disarm","true");
				$("#arm_disarmI").addClass("text-success").removeClass("text-danger");
			}
		}
		
		window.sessionStorage.setItem("voltage_external","true");
		function voltage_external(){
			if (window.sessionStorage.getItem("voltage_external")=="true"){
				window.sessionStorage.setItem("voltage_external","false");
				$("#voltage_externalT").text("Sin datos");
				$("#voltage_externalI").addClass("text-danger").removeClass("text-success");
			}else{
				window.sessionStorage.setItem("voltage_external","true");
				$("#voltage_externalI").addClass("text-success").removeClass("text-danger");
			}
		}
		
		window.sessionStorage.setItem("dout1","true");
		function dout1(){
			if (window.sessionStorage.getItem("dout1")=="true"){
				window.sessionStorage.setItem("dout1","false");
				$("#dout1T").text("Sin datos");
				$("#dout1I").addClass("text-danger").removeClass("text-success");
			}else{
				window.sessionStorage.setItem("dout1","true");
				$("#dout1I").addClass("text-success").removeClass("text-danger");
			}
		}
		
		window.sessionStorage.setItem("dout2","true");
		function dout2(){
			if (window.sessionStorage.getItem("dout2")=="true"){
				window.sessionStorage.setItem("dout2","false");
				$("#dout2T").text("Sin datos");
				$("#dout2I").addClass("text-danger").removeClass("text-success");
			}else{
				window.sessionStorage.setItem("dout2","true");
				$("#dout2I").addClass("text-success").removeClass("text-danger");
			}
		}
		
		window.sessionStorage.setItem("dout3","true");
		function dout3(){
			if (window.sessionStorage.getItem("dout3")=="true"){
				window.sessionStorage.setItem("dout3","false");
				$("#dout3T").text("Sin datos");
				$("#dout3I").addClass("text-danger").removeClass("text-success");
			}else{
				window.sessionStorage.setItem("dout3","true");
				$("#dout3I").addClass("text-success").removeClass("text-danger");
			}
		}
		
		window.sessionStorage.setItem("dout4","true");
		function dout4(){
			if (window.sessionStorage.getItem("dout4")=="true"){
				window.sessionStorage.setItem("dout4","false");
				$("#dout4T").text("Sin datos");
				$("#dout4I").addClass("text-danger").removeClass("text-success");
			}else{
				window.sessionStorage.setItem("dout4","true");
				$("#dout4I").addClass("text-success").removeClass("text-danger");
			}
		}
		
		window.sessionStorage.setItem("humedy","true");
		function humedy(){
			if (window.sessionStorage.getItem("humedy")=="true"){
				window.sessionStorage.setItem("humedy","false");
				$("#humedyT").text("Sin datos");
				$("#humedyI").addClass("text-danger").removeClass("text-success");
			}else{
				window.sessionStorage.setItem("humedy","true");
				$("#humedyI").addClass("text-success").removeClass("text-danger");
			}
		}
		
		$("#map").css("height",$("#map").height() + 700);
		
		function eliminar(id){
			if (document.getElementById(id)){
				var valor = document.getElementById(id),nodo = valor.parentNode;
				nodo.removeChild(valor);
			}
		}
		
		function leido(num,valors){
			
			if (valors=="2"){
				if (parseInt($("#numaprob").html())!==0){
					var nume = parseInt($("#numaprob").html()) - 1;
					eliminar("texto"+num+"k");
					eliminar("div"+num+"k");
					$("#numaprob").html(nume);
				}
			}else if(valors=="1"){
				if (parseInt($("#numaproa").html())!==0){
					var nume = parseInt($("#numaproa").html()) - 1;
					eliminar("texto"+num+"w");
					eliminar("div"+num+"w");
					$("#numaproa").html(nume);
				}
			}else if (valors=="3"){
				if (parseInt($("#numaproc").html())!==0){
					var nume = parseInt($("#numaproc").html()) - 1;
					eliminar("texto"+num+"h");
					eliminar("div"+num+"h");
					$("#numaproc").html(nume);
				}
			}
		}
		
		function cambioEnBd(telefono,nuevapass){
			var auth = JSON.parse(window.sessionStorage.getItem("sesion"));
			var token = auth.t,email = auth.e;
			backend.query({"t":token,"e":email,"a":"changePassEle","d":[{"tel":telefono},nuevapass]},block.ip,"8088",function(salida){
				var agregado = JSON.parse(salida);
				var fin = JSON.parse(agregado.m);
				if (fin.m){
				
					toastr.info('Cambiado con éxito  en base de datos');
					
					if (window.sessionStorage.getItem("punteados")){
					var nuevo = [];
					var ver = JSON.parse(window.sessionStorage.getItem("punteados"));
					for (var h = 0; h < ver.length; h++){
						if (ver[h].tel == telefono){
							ver[h].pass = nuevapass;
							nuevo.push(ver[h]);
						}else{
							nuevo.push(ver[h]);
						}
					}
					window.sessionStorage.setItem("punteados",JSON.stringify(nuevo));
				}
					
				}else{
					toastr.info('No es posible cambiar');
					
				}
				
			});
		}
		
		function cambiarPassElemen(oldpass,telefono){
			swal("Inserte contraseña numérica de 4 digitos nuevos del elemento:", {
			  content: "input",
			  attributes: {
				  placeholder: "1234",
				  type: "password",
			  }
			}).then((value) => {
				var req = /[0-9]{1,5}/;
				if (req.test(value) && value){
					var mens = oldpass+"P"+value;
					envioSms(telefono,mens);
					cambioEnBd(telefono,value);
				}else{
					toastr.info('Solo permite 4 numéros');
					cambiarPassElemen(oldpass,telefono);
				}
			});
		}
		
		function lanzarHumedyTrama(elem){
			
			var textox = JSON.parse(window.sessionStorage.getItem("tramaInbox")),mista = [];
			for (var d = 0; d < textox.length; d++){
				var timesr = textox[d].time.split(" "),fecham = timesr[0],hourm = timesr[1];
				if(textox[d].port == elem.port && textox[d].text.indexOf("Humedy") > -1){
					
					var nets = JSON.parse(textox[d].text);
					for (var m = 0; m < nets.length; m++){
					
						if (nets[m]!==""){
							
							var te = nets[m].split("*");
							if(te[0].indexOf("Humedy")>-1){
								mista.push(["Humedy",te[2],fecham,hourm]);
							}
							
						}
					}
					
					
				}
			}
			
			if (mista.length==0){
				mista.push(["No posee","No posee","No posee","No posee"]);
			}
			
			$('#Tablehumedadtrama').DataTable({
				columns: [
					{title: "Sensor"},
					{title: "Valor"},
					{title: "Fecha"},
					{title: "Hora"}
				],
				data: mista,
				pageLength: 25,
				responsive: true,
				dom: '<"html5buttons"B>lTfgitp',
				buttons: [
					{extend: 'csv'},
					{extend: 'excel', title: 'M2M_reporte_humedad_history'},
					{extend: 'pdf', title: 'M2M_reporte_humedad_history'},
					{extend: 'print',
						customize: function (win){
							$(win.document.body).addClass('white-bg');
							$(win.document.body).css('font-size', '10px');
							$(win.document.body).find('table').addClass('compact').css('font-size', 'inherit');
						}
					}
				]
			});
						
			$("#modalhumedadtrama").modal("show");
			
		}
		
		$("#grafrelayHumetrama").click(function(){
		
			var lista = [],otros = [];
			var ver = JSON.parse(window.sessionStorage.getItem("punteados"));
			for (var h = 0; h < ver.length; h++){
				lista.push(ver[h].nom);
				otros.push(h);
			}
		
			var selectList = document.createElement("select");
			selectList.id = "mySelect";
			for (var i = 0; i < lista.length; i++) {
				var option = document.createElement("option");
				option.value = otros[i];
				option.text = lista[i];
				selectList.appendChild(option);
			}
			
			swal("Seleccione elemento especifico", {
			  content: selectList,
			}).then((value) => {
				var valor = ver[$("#mySelect").select()[0].value];
				lanzarHumedyTrama(valor);
			});
		});
		
		$("#pusher").click(function(){
		
			swal("Inserte contraseña numérica para push notification:", {
			  content: "input",
			  attributes: {
				  placeholder: "m2mfuerte",
				  type: "password",
			  }
			}).then((value) => {
				var req = /[a-zA-Z0-9]{1,20}/;
				if (req.test(value) && value){
					
					var auth = JSON.parse(window.sessionStorage.getItem("sesion"));
					var token = auth.t,email = auth.e;
					backend.query({"t":token,"e":email,"a":"keypush","d":value},block.ip,"8088",function(salida){
						var das = JSON.parse(salida);
						if (!das.e){
							toastr.success('Registrada clave en la base de datos');
						}
					});
					
				}
			});

		});
		
		$("#history247").click(function(){
			var auth = JSON.parse(window.sessionStorage.getItem("sesion"));
			var token = auth.t,email = auth.e;
			backend.query({"t":token,"e":email,"a":"readHistory24"},block.ip,"8088",function(salida){
				var das = JSON.parse(salida);
				if (!das.e){
					var listatodo = JSON.parse(das.m);
					var mista =[];
					
					String.prototype.replaceAll = function(search, replacement) {
						var target = this;return target.replace(new RegExp(search, 'g'), replacement);
					};
					
					for (var d = 0; d < listatodo.m.length; d++){
						
						var timesr = listatodo.m[d].time.split(" "),fechamc = timesr[0],hourm = timesr[1];
						var fecham = fechamc;
						
						
						var numT = listatodo.m[d].number
						var contador = listatodo.m[d].con;
						var nombreE = "";
						
						if (numT==0){
							var poes = listatodo.m[d].port;
							var accion = JSON.parse(window.sessionStorage.getItem("punteados"));
							for (var m = 0; m < accion.length; m++){
								if(accion[m].port == poes){
									nombreE = accion[m].nom;
								}
							}
						}else{
							var numer = listatodo.m[d].number;
							var numer2 = numer.replace(" ","");
							var accion = JSON.parse(window.sessionStorage.getItem("punteados"));
							for (var m = 0; m < accion.length; m++){
								if(accion[m].tel == numer2){
									nombreE = accion[m].nom;
								}
							}
						}
						
						var portes = listatodo.m[d].port;
						
						if (listatodo.m[d].text.indexOf("*")>-1){
						
							var text = JSON.parse(listatodo.m[d].text);
							for (var dx = 0; dx < text.length; dx++){
								
								if (text[dx].indexOf("Sensor")>-1){
							
									var info = text[dx].split("*"),
										sensor = info[1],
										valor = info[2];
									
									mista.push([contador,info[0],"...",sensor,valor,portes,fecham,hourm,nombreE]);
									
								}else if (text[dx].indexOf("DIM")>-1){
								
									var info = text[dx].split("*"),
										sensor = info[1],
										valor = info[2];
										
										var inid = valor.toString();
										if (inid.indexOf("268435457")>-1){
											var texs = "Nc";
										}else if(inid.indexOf("536870913")>-1){
											var texs = "No";
										}else if(inid.indexOf("805306369")>-1){
											var texs = "Change";
										}else if (parseInt(inid) > 0){
											var texs = "Couter";
										}
										
									mista.push([contador,info[0],"...",info[1],texs,portes,fecham,hourm,nombreE]);
										
								}else if (text[dx].indexOf("Temperature")>-1){
									
									var info = text[dx].split("*"),
										sensor = info[1],
										valor = info[2];
									
									mista.push([contador,"Temp","...","...",valor,portes,fecham,hourm,nombreE]);
									
								}else if (text[dx].indexOf("Humedy")>-1){
									
									var info = text[dx].split("*"),
										sensor = info[1],
										valor = info[2];
									
									mista.push([contador,"Humedad","...","...",valor,portes,fecham,hourm,nombreE]);
									
								}else if (text[dx].indexOf("Dout")>-1){
									
									
									var info = text[dx].split("*"),
										sensor = info[1],
										valor = info[2];
										
									mista.push([contador,info[0],"...",sensor,valor,portes,fecham,hourm,nombreE]);
								
								}else if (text[dx].indexOf("External")>-1){
								
									var info = text[dx].split("*"),
										sensor = info[1],
										valor = info[2];
									
									mista.push([contador,"Batery","...","...",valor,portes,fecham,hourm,nombreE]);
								
								}else if (text[dx].indexOf("ac_power")>-1){
								
									var info = text[dx].split("*"),
										sensor = info[1],
										valor = info[2];
										
									mista.push([contador,"Power","...","...",valor,portes,fecham,hourm,nombreE]);
									
								}else if (text[dx].indexOf("SIGNAL")>-1){
									
									var info = text[dx].split("*"),
										sensor = info[1],
										valor = info[2];
										
									mista.push([contador,"gsm","...","...",valor,portes,fecham,hourm,nombreE]);
										
								}else if (text[dx].indexOf("Arm/Disarm")>-1){
									
									var info = text[dx].split("*"),
										sensor = info[1],
										valor = info[2];
								
									mista.push([contador,"Arm","...","...",valor,portes,fecham,hourm,nombreE]);
									
								}
								
							}
							
						}else{
							
							//sms
							
							var numT = "*"+listatodo.m[d].number.substr(-3);
							
							var nombre = listatodo.m[d].text,
								estatus = "",
								limpio = nombre.replaceAll("\r",""),
								filtro = limpio.replaceAll("\n",""),
								lista = filtro.split(";"),
								nombreEle = "";
							
							for (var f = 0; f < lista.length; f++){
								var infe = lista[f];
								
								if (infe.indexOf("Power")>-1){
									var es = infe.split(":");
									if (parseInt(es[1])>0){
										mista.push([contador,"Power",numT,"On","...","...",fecham,hourm,nombreE]);
									}
								}
										
								if (infe.indexOf("Signal")>-1){
									var es = infe.split(":");
									mista.push([contador,"Gsm",numT,"...",es[1],"...",fecham,hourm,nombreE]);
								}
								
								if(infe.indexOf("Voltage")>-1){
									mista.push([contador,"Bateria",numT,"Bajo","...","...",fecham,hourm,nombreE]);
								}
								
								if (infe.indexOf("DO")>-1){
								
									var es = infe.split(":");
									if(es[1]=="Close"){
										var nim = "DO"+es[0].replace("DO","");
										mista.push([contador,nim,numT,"Close","...","...",fecham,hourm,nombreE]);
									}else if(es[1]=="Open"){
										var nim = "DO"+es[0].replace("DO","");
										mista.push([contador,nim,numT,"Open","...","...",fecham,hourm,nombreE]);
									}
								}
							
								if (infe.indexOf("Temp")>-1){
									var es = infe.split(":");
									var oues = es[1].split(",");
									var otru = oues[0];
									var estatus = oues[1]; 
									
									if (estatus.indexOf("Lower") > -1) {
										mista.push([contador,"Temp",numT,"Bajo",otru,"...",fecham,hourm,nombreE]);
									} else if (estatus.indexOf("Normal") > -1) {
										mista.push([contador,"Temp",numT,"Normal",otru,"...",fecham,hourm,nombreE]);
									} else if (estatus.indexOf("Higher") > -1) {
										mista.push([contador,"Temp",numT,"Alto",otru,"...",fecham,hourm,nombreE]);
									}
									
								}
								
								if (infe.indexOf("Humi")>-1){
									var es = infe.split(":");
									var oues = es[1].split(",");
									var otru = oues[0];
									var estatus = oues[1]; 
									
									if (estatus.indexOf("Lower") > -1) {
										mista.push([contador,"Humedad",numT,"Bajo",otru,"...",fecham,hourm,nombreE]);
									} else if (estatus.indexOf("Normal") > -1) {
										mista.push([contador,"Humedad",numT,"Normal",otru,"...",fecham,hourm,nombreE]);
									} else if (estatus.indexOf("Higher") > -1) {
										mista.push([contador,"Humedad",numT,"Alto",otru,"...",fecham,hourm,nombreE]);
									}
								}

									
								if(infe.indexOf("AIN")>-1){
									var es = infe.split(":"),estatus ="";
									var sensor = es[0];
									if(infe.indexOf(",")>-1){
                                        var valorYEstado = es[1].split(",");
                                        var estado = valorYEstado[1];
                                        var valor = valorYEstado[0];
									}else{
										var valorYEstado = infe.split(" ");
										var sensor = valorYEstado[0];
										var estado = valorYEstado[1];
										var valor = valorYEstado[3];
									}
									
									if (infe.indexOf("Lower")>-1){
										mista.push([contador,sensor,numT,"Bajo",valor,"...",fecham,hourm,nombreE]);
									}else if (infe.indexOf("Normal")>-1){
										mista.push([contador,sensor,numT,"Normal",valor,"...",fecham,hourm,nombreE]);
									}else if (infe.indexOf("Higher")>-1){
										mista.push([contador,sensor,numT,"Alto",valor,"...",fecham,hourm,nombreE]);
									}
								}
							
							}
							
						}
						
						if (d==listatodo.m.length-1){
							
							if (mista.length==0){
								mista.push(["No posee","No posee","No posee","No posee","No posee","No posee","No posee","No posee","No posee"]);
							}
							
							$('#History247todo').DataTable({
								columns: [
									{title: "id"},
									{title: "S"},
									{title: "Nº"},
									{title: "E"},
									{title: "V"},
									{title: "P"},
									{title: "Dia"},
									{title: "Hora"},
									{title: "Nombre"}
								],
								data: mista,
								pageLength: 100,
								responsive: true,
								dom: '<"html5buttons"B>lTfgitp',
								buttons: [
									{extend: 'csv'},
									{extend: 'excel', title: 'M2M_reporte_relays_history'},
									{extend: 'pdf', title: 'M2M_reporte_relays_history'},
									{extend: 'print',
										customize: function (win){
											$(win.document.body).addClass('white-bg');
											$(win.document.body).css('font-size', '10px');
											$(win.document.body).find('table').addClass('compact').css('font-size', 'inherit');
										}
									}
								],
								fnRowCallback: function( nRow, aData, iDisplayIndex, iDisplayIndexFull ) {

									if (aData[2].indexOf("Bajo")>-1){
										$(nRow).css({"background-color":"#4DAF2C"});
									}else if (aData[2].indexOf("Normal")>-1){
										$(nRow).css({"background-color":"#57bff7"});
									}else if(aData[2].indexOf("Alto")>-1){
										$(nRow).css({"background-color":"#E74C3C"});
									}

								},
								"columnDefs": [
									{
										"targets": [ 2 ],
										"visible": false
									}
								]
							});
							
							$("#history247modal").modal("show");
							
						}
					}
					
				}
			});
		});
		
		$("#history247modal").on("hidden.bs.modal", function () {
			var table = $('#History247todo').DataTable();
			table.destroy();
		});
		
		$("#modalhumedadtrama").on("hidden.bs.modal", function () {
			var table = $('#Tablehumedadtrama').DataTable();
			table.destroy();
		});
		
		$("#borrarTodo").click(function(){
			var auth = JSON.parse(window.sessionStorage.getItem("sesion"));
			var token = auth.t,email = auth.e;
			backend.query({"t":token,"e":email,"a":"vaciar","d":"0"},block.ip,"8088",function(salida){

				var sali = JSON.parse(salida);
				if (!sali.e){
					toastr.info('Se elimino el historial trama y sms');
				}
			});
		});
		
		$("#CV_password").click(function(){
			var datos = JSON.parse(window.sessionStorage.getItem("Previsualizado")),
				accion = JSON.parse(window.sessionStorage.getItem("punteados")),
				passe = "1234",tele ="";
			for (var m = 0; m < accion.length; m++){
				if(accion[m].tel==datos.tel){
					passe = accion[m].pass;
					tele = accion[m].tel;
				}
			}
			
			swal({
			  title: "Password del elemento",
			  text: "La Password es "+passe+" desea cambiar la password a default(1234)?",
			  icon: "warning",
			  buttons: true,
			  dangerMode: true,
			})
			.then((willDelete) => {
			  if (willDelete) {
				cambiarPassElemen(passe,tele);
			  }
			});
		});
		
		$("#pow").attr("src","/img/powerOn.png");
		$("#bac").attr("src","/img/bateryOff.png");
		
		function lanzarModalrelay(elem){
			
			var agre=[];
			var textox = JSON.parse(window.sessionStorage.getItem("smsInbox")),mista = [];
			for (var d = 0; d < textox.length; d++){
				var timesr = textox[d].time.split(" "),fecham = timesr[0],hourm = timesr[1];
				if(textox[d].number == elem.tel && textox[d].text.indexOf("DO") > -1){
					var nets = textox[d].text.split(";");
					for (var m = 0; m < nets.length; m++){
					
						var te = nets[m].split(":");
						
						if (nets[m]!==""){
							
							agre.push(te[1]);
							
							if (nets[m].indexOf("Close")>-1){
								mista.push(["Close",te[0],fecham,hourm]);
							}else{
								mista.push(["Open",te[0],fecham,hourm]);
							}
							
						}
					}
				}
			}
			
			
			$("#modalRelayhistory").modal("show");
			
			if (mista.length==0){
				mista.push(["No posee","No posee","No posee","No posee"]);
			}
			
			$('#TableRelayHistory').DataTable({
				columns: [
					{title: "Estado"},
					{title: "Id relay"},
					{title: "Fecha"},
					{title: "Hora"}
				],
				data: mista,
				pageLength: 25,
				responsive: true,
				dom: '<"html5buttons"B>lTfgitp',
				buttons: [
					{extend: 'csv'},
					{extend: 'excel', title: 'M2M_reporte_relays_history'},
					{extend: 'pdf', title: 'M2M_reporte_relays_history'},
					{extend: 'print',
						customize: function (win){
							$(win.document.body).addClass('white-bg');
							$(win.document.body).css('font-size', '10px');
							$(win.document.body).find('table').addClass('compact').css('font-size', 'inherit');
						}
					}
				]
			});
			
			window.sessionStorage.setItem("temporalRelayhistory",JSON.stringify(mista));
			

		}
		
		function lanzarModalrelaygraf(ids,elem){
			
			var textox = JSON.parse(window.sessionStorage.getItem("smsInbox")),mista = [];
			for (var d = 0; d < textox.length; d++){
				var timesr = textox[d].time.split(" "),fecham = timesr[0],hourm = timesr[1];
				if(textox[d].number == elem.tel && textox[d].text.indexOf("DO") > -1){
					var nets = textox[d].text.split(";");
					for (var m = 0; m < nets.length; m++){
						var te = nets[m].split(":");
						
						if (nets[m]!=="" && te[0].indexOf(ids)>-1){
							
							String.prototype.replaceAll = function(search, replacement) {
								var target = this;return target.replace(new RegExp(search, 'g'), replacement);
							};
							
							var nombr = te[0].replaceAll("\r","");
							var nomr = nombr.replaceAll("\n","");
							
							if (nets[m].indexOf("Close")>-1){
								mista.push(["Close",nomr,fecham,hourm]);
							}else{
								mista.push(["Open",nomr,fecham,hourm]);
							}
							
						}
					}
				}
			}
			
			window.sessionStorage.setItem("temporalRelayhistory",JSON.stringify(mista));
			
			$("#relarh").val(ids);
			
			var ano = []; 
			for (var h = 0; h <mista.length; h++ ){
				if (mista[h][1]== ids){
					var extra = mista[h][2];
					var nuevo = extra.split("/");
					ano.push(nuevo[0]);
				}
			}
			
			var listaw = Array.from(new Set(ano));
			var texti4='<option value=""></option>';
			for (var gc = 0; gc < listaw.length; gc++){
				texti4=texti4+'<option value="'+listaw[gc]+'">'+listaw[gc]+'</option>';
			}
			$("#anoslisr").html(texti4);
			
			$("#modalRelaygraf").modal("show");
			
			$("#anoslisr").change(function(){
				
				var mes = []; 
				var rel = ids;
				var anos = $("#anoslisr").val();
				var lista = JSON.parse(window.sessionStorage.getItem("temporalRelayhistory"));
				for (var h = 0; h <lista.length; h++ ){
					if (lista[h][1]== rel){
						var extra = lista[h][2];
						var nuevo = extra.split("/");
						if (nuevo[0] == anos){
							mes.push(nuevo[1]);
						}
					}
				}
				var listaw = Array.from(new Set(mes));
				var texti4='<option value=""></option>';
				for (var gc = 0; gc < listaw.length; gc++){
					texti4=texti4+'<option value="'+listaw[gc]+'">'+listaw[gc]+'</option>';
				}
				$("#meslisr").html(texti4);
						
			});
			
			$("#meslisr").change(function(){
		
				var dia = []; 
				var rel =ids;
				var anos = $("#anoslisr").val();
				var mes = $("#meslisr").val();
				var lista = JSON.parse(window.sessionStorage.getItem("temporalRelayhistory"));
				for (var h = 0; h <lista.length; h++ ){
					if (lista[h][1]== rel){
						var extra = lista[h][2];
						var nuevo = extra.split("/");
						if (nuevo[0] == anos && nuevo[1] == mes){
							dia.push(nuevo[2]);
						}
					}
				}
				var listaw = Array.from(new Set(dia));
				var texti4='<option value=""></option>';
				for (var gc = 0; gc < listaw.length; gc++){
					texti4=texti4+'<option value="'+listaw[gc]+'">'+listaw[gc]+'</option>';
				}
				$("#diaslisr").html(texti4);
				
			});
			
			$("#diaslisr").change(function(){
				
				var uniqueItems = [],valoresdonu =[],colores=[];
				var rel = ids;
				var anos = $("#anoslisr").val();
				var mes = $("#meslisr").val();
				var dia = $("#diaslisr").val();
				var lista = JSON.parse(window.sessionStorage.getItem("temporalRelayhistory"));
				for (var h = 0; h <lista.length; h++ ){
					if (lista[h][1]== rel){
						var extra = lista[h][2];
						var nuevo = extra.split("/");
						if (nuevo[0] == anos && nuevo[1] == mes && nuevo[2] == dia){
							uniqueItems.push(lista[h][3]);
							valoresdonu.push(1);
														
							if (lista[h][0].indexOf("Close")>-1){
								colores.push("#dc3545");
							}else if (lista[h][0].indexOf("Open")>-1){
								colores.push("#1c84c6");
							}
						}
					}
				}
				
				$("#realDatosRelay").css("display","block");
				$("#mostrarLey").css("display","block");
					
				if(window.donus3){
					window.donus3.destroy();
				}

				var doughnutOptions = {
					responsive: true,
					title: {
						display: false
					},
					legend: {
						display: false
					}
				};
				var doughnutData2 = {
					labels: uniqueItems,
					datasets: [{
						label:"Datos del relay",
						data: valoresdonu,
						backgroundColor: colores
					}]
				};
				var ctx3 = document.getElementById("realDatosRelay").getContext("2d");
				window.donus3 = new Chart(ctx3, {type: 'doughnut', data: doughnutData2, options:doughnutOptions});

				window.donus3.update();
			});
			
		}
		
		function lanzarModalrelaygrafTrama(elem){
			
			var textox = JSON.parse(window.sessionStorage.getItem("tramaInbox")),mista = [],agre=[];
			for (var d = 0; d < textox.length; d++){
				if(textox[d].port == elem.port){
					var nomr = elem.nom;
					var timesr = textox[d].time.split(" "),fecham = timesr[0],hourm = timesr[1];
					
					if(textox[d].text.indexOf("Dout")){
						var nets = JSON.parse(textox[d].text);
						for (var es = 0; es < nets.length; es++){
						    var info = nets[es].split("*");
                            if (info[2].indexOf("Close")>-1){
                                mista.push(["Close",fecham,hourm,info[0]+info[1]]);
                            }else{
                                mista.push(["Open",fecham,hourm,info[0]+info[1]]);
                            }
						}
						
					}
					
					if(textox[d].text.indexOf("Dout*0")){
						agre.push("Dout0");
					}
					if(textox[d].text.indexOf("Dout*1")){
						agre.push("Dout1");
					}
					if(textox[d].text.indexOf("Dout*2")){
						agre.push("Dout2");
					}
					if(textox[d].text.indexOf("Dout*3")){
						agre.push("Dout3");
					}
					if(textox[d].text.indexOf("Dout*4")){
						agre.push("Dout4");
					}
					if(textox[d].text.indexOf("Dout*5")){
						agre.push("Dout5");
					}
					if(textox[d].text.indexOf("Dout*6")){
						agre.push("Dout6");
					}
					if(textox[d].text.indexOf("Dout*7")){
						agre.push("Dout7");
					}
				}
			}
			var listao = Array.from(new Set(agre)),texti='<option value=""></option>';
			for (var g =0; g<listao.length; g++){
				texti=texti+'<option value="'+listao[g]+'">'+listao[g]+'</option>';
			}
			
			$("#sensDtrama").html(texti);
			
			window.sessionStorage.setItem("temporalRelayhistorytrama",JSON.stringify(mista));
			
			$("#sensDtrama").change(function(){
			    var ano = []; 
                for (var h = 0; h <mista.length; h++ ){
                    if (mista[h][3] == $("#sensDtrama").val()){
                        var extra = mista[h][1];
                        var nuevo = extra.split("/");
                        ano.push(nuevo[2]);
                    }
                }

                var listaw = Array.from(new Set(ano));

                var texti4='<option value=""></option>';
                for (var gc = 0; gc < listaw.length; gc++){
                    texti4=texti4+'<option value="'+listaw[gc]+'">'+listaw[gc]+'</option>';
                }
                $("#anoslisrtrama").html(texti4);
			});
			
			
			$("#modalRelaygraftrama").modal("show");
			
			$("#anoslisrtrama").change(function(){
				
				var mes = []; 
				var anos = $("#anoslisrtrama").val();
				var lista = JSON.parse(window.sessionStorage.getItem("temporalRelayhistorytrama"));
				for (var h = 0; h <lista.length; h++ ){
					if (mista[h][3] == $("#sensDtrama").val()){
						var extra = lista[h][1];
						var nuevo = extra.split("/");
						if (nuevo[2] == anos){
							mes.push(nuevo[1]);
						}
					}
				}
				var listaw = Array.from(new Set(mes));
				var texti4='<option value=""></option>';
				for (var gc = 0; gc < listaw.length; gc++){
					texti4=texti4+'<option value="'+listaw[gc]+'">'+listaw[gc]+'</option>';
				}
				$("#meslisrtrama").html(texti4);
						
			});
			
			$("#meslisrtrama").change(function(){
		
				var dia = []; 
				var anos = $("#anoslisrtrama").val();
				var mes = $("#meslisrtrama").val();
				var lista = JSON.parse(window.sessionStorage.getItem("temporalRelayhistorytrama"));
				for (var h = 0; h <lista.length; h++ ){
					if (mista[h][3] == $("#sensDtrama").val()){
						var extra = lista[h][1];
						var nuevo = extra.split("/");
						if (nuevo[2] == anos && nuevo[1] == mes){
							dia.push(nuevo[0]);
						}
					}
				}
				var listaw = Array.from(new Set(dia));
				var texti4='<option value=""></option>';
				for (var gc = 0; gc < listaw.length; gc++){
					texti4=texti4+'<option value="'+listaw[gc]+'">'+listaw[gc]+'</option>';
				}
				$("#diaslisrtrama").html(texti4);
				
			});
		
			$("#diaslisrtrama").change(function(){
				
				var uniqueItems = [],valoresdonu =[],colores=[];
				var anos = $("#anoslisrtrama").val();
				var mes = $("#meslisrtrama").val();
				var dia = $("#diaslisrtrama").val();
				var lista = JSON.parse(window.sessionStorage.getItem("temporalRelayhistorytrama"));
				for (var h = 0; h <lista.length; h++ ){
					
					var extra = lista[h][1];
					var nuevo = extra.split("/");
					if (nuevo[2] == anos && nuevo[1] == mes && nuevo[0] == dia && mista[h][3] == $("#sensDtrama").val()){
						uniqueItems.push(lista[h][2]+" "+lista[h][3]);
													
						if (lista[h][0].indexOf("Close")>-1){
							colores.push("#dc3545");
							valoresdonu.push(1);
						}else if (lista[h][0].indexOf("Open")>-1){
							colores.push("#1c84c6");
							valoresdonu.push(0);
						}
					}
				
				}
				
					
				if(window.donusts){
					window.donusts.destroy();
				}

				var doughnutOptions2q = {
					responsive: true,
					title: {
						display: false
					},
					legend: {
						display: false
					}
				};
				var doughnutDatatq = {
					labels: uniqueItems,
					datasets: [{
						label:"Datos de relay via trama",
						data: valoresdonu,
						backgroundColor: colores
					}]
				};
				var ctx3s = document.getElementById("realDatosRelaytrama").getContext("2d");
				window.donusts = new Chart(ctx3s, {type: 'doughnut', data: doughnutDatatq, options:doughnutOptions2q});

				window.donusts.update();
			});
			
		}
		
		function grafSmstemp(elem){
		
			var textox = JSON.parse(window.sessionStorage.getItem("smsInbox")),mista = [];
			for (var d = 0; d < textox.length; d++){
				var timesr = textox[d].time.split(" "),fecham = timesr[0],hourm = timesr[1];
				if(textox[d].number == elem.tel && textox[d].text.indexOf("Temp") > -1){
					
					String.prototype.replaceAll = function(search, replacement) {
						var target = this;return target.replace(new RegExp(search, 'g'), replacement);
					};

					var nombr = textox[d].text.replaceAll("\r","");
					var netsx = nombr.replaceAll("\n","");
					var nets = netsx.split(";");

					for (var m = 0; m < nets.length; m++){
						
						if (nets[m]!==""){

							if (nets[m].indexOf("Temp")>-1){
								var te = nets[m].split(":");
								var fes = te[1].split(",");
								mista.push([fecham,hourm,fes[0]]);
							}

						}
					}
				}
			} 
			
			window.sessionStorage.setItem("temporalRelayhistory",JSON.stringify(mista));
			
			var ano = []; 
			for (var h = 0; h <mista.length; h++ ){
				var extra = mista[h][0];
				var nuevo = extra.split("/");
				ano.push(nuevo[0]);
			}
			
			var listaw = Array.from(new Set(ano));
			var texti4='<option value=""></option>';
			for (var gc = 0; gc < listaw.length; gc++){
				texti4=texti4+'<option value="'+listaw[gc]+'">'+listaw[gc]+'</option>';
			}
			$("#anoslisrTempsms").html(texti4);
			
			$("#modalGrafaTemp").modal("show");
			
			$("#anoslisrTempsms").change(function(){
				
				var mes = []; 
				var anos = $("#anoslisrTempsms").val();
				var lista = JSON.parse(window.sessionStorage.getItem("temporalRelayhistory"));
				for (var h = 0; h <lista.length; h++ ){
					var extra = lista[h][0];
					var nuevo = extra.split("/");
					if (nuevo[0] == anos){
						mes.push(nuevo[1]);
					}
				}
				var listaw = Array.from(new Set(mes));
				var texti4='<option value=""></option>';
				for (var gc = 0; gc < listaw.length; gc++){
					texti4=texti4+'<option value="'+listaw[gc]+'">'+listaw[gc]+'</option>';
				}
				$("#meslisrTempsms").html(texti4);
						
			});
			
			$("#meslisrTempsms").change(function(){
		
				var dia = []; 
				var anos = $("#anoslisrTempsms").val();
				var mes = $("#meslisrTempsms").val();
				var lista = JSON.parse(window.sessionStorage.getItem("temporalRelayhistory"));
				for (var h = 0; h <lista.length; h++ ){
					var extra = lista[h][0];
					var nuevo = extra.split("/");
					if (nuevo[0] == anos && nuevo[1] == mes){
						dia.push(nuevo[2]);
					}
				}
				var listaw = Array.from(new Set(dia));
				var texti4='<option value=""></option>';
				for (var gc = 0; gc < listaw.length; gc++){
					texti4=texti4+'<option value="'+listaw[gc]+'">'+listaw[gc]+'</option>';
				}
				$("#diaslisrTempsms").html(texti4);
				
			});
			
			$("#diaslisrTempsms").change(function(){
				
				var uniqueItems = [],valoresdonu =[],colores=[];
				var anos = $("#anoslisrTempsms").val();
				var mes = $("#meslisrTempsms").val();
				var dia = $("#diaslisrTempsms").val();
				var lista = JSON.parse(window.sessionStorage.getItem("temporalRelayhistory"));
				for (var h = 0; h <lista.length; h++ ){
					var extra = lista[h][0];
					var nuevo = extra.split("/");
					if (nuevo[0] == anos && nuevo[1] == mes && nuevo[2] == dia){
						uniqueItems.push(lista[h][0]+" "+lista[h][1]);
						valoresdonu.push(lista[h][2]);
						colores.push("#1c84c6");
					}
				}
									
				if(window.donus3t2){
					window.donus3t2.destroy();
				}

				var doughnutOptions2t = {
					responsive: true,
					title: {
						display: false
					},
					legend: {
						display: false
					}
				};
				var doughnutData2t2 = {
					labels: uniqueItems,
					datasets: [{
						label:"Datos del temperatura",
						data: valoresdonu,
						backgroundColor: colores
					}]
				};
				var ctx3t2 = document.getElementById("realRelaytemp2").getContext("2d");
				window.donus3t2 = new Chart(ctx3t2, {type: 'bar', data: doughnutData2t2, options:doughnutOptions2t});

				window.donus3t2.update();
			});
			

		}
		
		$("#ModalHistorialtemp").click(function(){
			
			var lista = [],otros = [];
			var ver = JSON.parse(window.sessionStorage.getItem("punteados"));
			for (var h = 0; h < ver.length; h++){
				lista.push(ver[h].nom);
				otros.push(h);
			}
		
			var selectList = document.createElement("select");
			selectList.id = "mySelect";
			for (var i = 0; i < lista.length; i++) {
				var option = document.createElement("option");
				option.value = otros[i];
				option.text = lista[i];
				selectList.appendChild(option);
			}
			
			swal("Seleccione elemento especifico", {
			  content: selectList,
			}).then((value) => {
				var valor = ver[$("#mySelect").select()[0].value];
				grafSmstemp(valor);
			});

		});
		
		$("#grafrelay").click(function(){
			
			function ejecu(elem){
			
				var selectList = document.createElement("select");
				selectList.id = "mySelect";
				var otro = [];
				
				for (var f =0; f < 4; f++){
					var option = document.createElement("option");
					option.value = "DO"+f;
					option.text = "Dout "+f;
					selectList.appendChild(option);
				}
				
				swal("Seleccione relay especifico", {
				  content: selectList,
				}).then((value) => {
					var valor = $("#mySelect").select()[0].value;
					lanzarModalrelaygraf(valor,elem);
				});
					
			}
			
			var lista = [],otros = [];
			var ver = JSON.parse(window.sessionStorage.getItem("punteados"));
			for (var h = 0; h < ver.length; h++){
				lista.push(ver[h].nom);
				otros.push(h);
			}
		
			var selectList = document.createElement("select");
			selectList.id = "mySelect";
			for (var i = 0; i < lista.length; i++) {
				var option = document.createElement("option");
				option.value = otros[i];
				option.text = lista[i];
				selectList.appendChild(option);
			}
			
			swal("Seleccione elemento especifico", {
			  content: selectList,
			}).then((value) => {
				var valor = ver[$("#mySelect").select()[0].value];
				ejecu(valor);
			});
			
		});		
		
		function graftramatemp(elem){
			
			var textox = JSON.parse(window.sessionStorage.getItem("tramaInbox")),mista = [];
			for (var d = 0; d < textox.length; d++){
				var timesr = textox[d].time.split(" "),fecham = timesr[0],hourm = timesr[1];
				
				if(textox[d].port == elem.port && textox[d].text.indexOf("Temperature") > -1){
					var nomr = elem.nom;
					var nets = JSON.parse(textox[d].text);
					
					for (var m = 0; m < nets.length; m++){
						
						var info = nets[m].split("*");
						if (info[0].indexOf("Temperature")>-1){
							mista.push([info[2],nomr,fecham,hourm]);
						}
						
					}
				}
				
			}
			
			window.sessionStorage.setItem("temporalRelayhistorytrama",JSON.stringify(mista));
						
			var ano = []; 
			for (var h = 0; h <mista.length; h++ ){
				var extra = mista[h][2];
				var nuevo = extra.split("/");
				ano.push(nuevo[2]);
			}
			
			var listaw = Array.from(new Set(ano));
			var texti4='<option value=""></option>';
			for (var gc = 0; gc < listaw.length; gc++){
				texti4=texti4+'<option value="'+listaw[gc]+'">'+listaw[gc]+'</option>';
			}
			$("#anoslisrtramatemp").html(texti4);
			
			$("#modalgraftramax").modal("show");
			
			$("#anoslisrtramatemp").change(function(){
				
				var mes = []; 
				var anos = $("#anoslisrtramatemp").val();
				var lista = JSON.parse(window.sessionStorage.getItem("temporalRelayhistorytrama"));
				for (var h = 0; h <lista.length; h++ ){
					var extra = lista[h][2];
					var nuevo = extra.split("/");
					if (nuevo[2] == anos){
						mes.push(nuevo[1]);
					}
				}
				var listaw = Array.from(new Set(mes));
				var texti4='<option value=""></option>';
				for (var gc = 0; gc < listaw.length; gc++){
					texti4=texti4+'<option value="'+listaw[gc]+'">'+listaw[gc]+'</option>';
				}
				$("#meslisrtramatemp").html(texti4);
						
			});
			
			$("#meslisrtramatemp").change(function(){
		
				var dia = []; 
				var anos = $("#anoslisrtramatemp").val();
				var mes = $("#meslisrtramatemp").val();
				var lista = JSON.parse(window.sessionStorage.getItem("temporalRelayhistorytrama"));
				for (var h = 0; h <lista.length; h++ ){
					var extra = lista[h][2];
					var nuevo = extra.split("/");
					if (nuevo[2] == anos && nuevo[1] == mes){
						dia.push(nuevo[0]);
					}
				}
				var listaw = Array.from(new Set(dia));
				var texti4='<option value=""></option>';
				for (var gc = 0; gc < listaw.length; gc++){
					texti4=texti4+'<option value="'+listaw[gc]+'">'+listaw[gc]+'</option>';
				}
				$("#diaslisrtramatemp").html(texti4);
				
			});
		
			$("#diaslisrtramatemp").change(function(){
				
				var uniqueItems = [],valoresdonu =[],colores=[];
				var anos = $("#anoslisrtramatemp").val();
				var mes = $("#meslisrtramatemp").val();
				var dia = $("#diaslisrtramatemp").val();
				var lista = JSON.parse(window.sessionStorage.getItem("temporalRelayhistorytrama"));
				for (var h = 0; h <lista.length; h++ ){
					
					var extra = lista[h][2];
					var nuevo = extra.split("/");
					if (nuevo[2] == anos && nuevo[1] == mes && nuevo[0] == dia){
						
						uniqueItems.push(lista[h][2]+" "+lista[h][3]);
						valoresdonu.push(lista[h][0]);
						colores.push("#1c84c6");

					}
				
				}
				
					
				if(window.donustsm){
					window.donustsm.destroy();
				}

				var doughnutOptions2q2 = {
					responsive: true,
					title: {
						display: false
					},
					legend: {
						display: false
					}
				};
				var doughnutDatatq2 = {
					labels: uniqueItems,
					datasets: [{
						label:"Datos del relay",
						data: valoresdonu,
						backgroundColor: colores
					}]
				};
				var ctx3sz = document.getElementById("realDatosRelaytramax").getContext("2d");
				window.donustsm = new Chart(ctx3sz, {type: 'bar', data: doughnutDatatq2, options:doughnutOptions2q2});

				window.donustsm.update();
			});
			
		}
		
		$("#grafrelay2temp").click(function(){
			var lista = [],otros = [];
			var ver = JSON.parse(window.sessionStorage.getItem("punteados"));
			for (var h = 0; h < ver.length; h++){
				lista.push(ver[h].nom);
				otros.push(h);
			}
		
			var selectList = document.createElement("select");
			selectList.id = "mySelect";
			for (var i = 0; i < lista.length; i++) {
				var option = document.createElement("option");
				option.value = otros[i];
				option.text = lista[i];
				selectList.appendChild(option);
			}
			
			swal("Seleccione elemento especifico", {
			  content: selectList,
			}).then((value) => {
				var valor = ver[$("#mySelect").select()[0].value];
				graftramatemp(valor);
			});
		});
		
		$("#grafrelay2").click(function(){
			
			var lista = [],otros = [];
			var ver = JSON.parse(window.sessionStorage.getItem("punteados"));
			for (var h = 0; h < ver.length; h++){
				lista.push(ver[h].nom);
				otros.push(h);
			}
		
			var selectList = document.createElement("select");
			selectList.id = "mySelect";
			for (var i = 0; i < lista.length; i++) {
				var option = document.createElement("option");
				option.value = otros[i];
				option.text = lista[i];
				selectList.appendChild(option);
			}
			
			swal("Seleccione elemento especifico", {
			  content: selectList,
			}).then((value) => {
				var valor = ver[$("#mySelect").select()[0].value];
				lanzarModalrelaygrafTrama(valor);
			});
			
		});
		
		function temperatureG(elem){

			var textox = JSON.parse(window.sessionStorage.getItem("smsInbox")),mista = [];
			for (var d = 0; d < textox.length; d++){
				var timesr = textox[d].time.split(" "),fecham = timesr[0],hourm = timesr[1];

				if(textox[d].number == elem.tel && textox[d].text.indexOf("Temp") > -1){
					
					var texto = textox[d].text;
					String.prototype.replaceAll = function(search, replacement) {
						var target = this;return target.replace(new RegExp(search, 'g'), replacement);
					};

					var limpio = texto.replaceAll("\r","");
					var filtro = limpio.replaceAll("\n","");
					var nets = filtro.split(";");

					for (var m = 0; m < nets.length; m++){

						if (nets[m]!=="" && nets[m].indexOf("Temp")>-1){
							var te = nets[m].split(":");
							var oto = te[1].split(",");
							var fechax = moment().format('DD/MM/YYYY',fecham);
							mista.push([oto[1],oto[0],fechax,hourm]);

						}
					}
				}
			}


			if (mista.length==0){
				mista.push(["No posee","No posee","No posee","No posee"]);
			}

			$('#TableRelayHistoryTemp').DataTable({
				columns: [
					{title: "Estado"},
					{title: "Valor"},
					{title: "Fecha"},
					{title: "Hora"}
				],
				data: mista,
				pageLength: 25,
				responsive: true,
				dom: '<"html5buttons"B>lTfgitp',
				buttons: [
					{extend: 'csv'},
					{extend: 'excel', title: 'M2M_reporte_temperatura_history'},
					{extend: 'pdf', title: 'M2M_reporte_temperatura_history'},
					{extend: 'print',
						customize: function (win){
							$(win.document.body).addClass('white-bg');
							$(win.document.body).css('font-size', '10px');
							$(win.document.body).find('table').addClass('compact').css('font-size', 'inherit');
						}
					}
				]
			});

			$("#modalRelayhistoryTemp").modal("show");

		}

		function graftramasms(elem){
			
			var liso = [];
			var textox = JSON.parse(window.sessionStorage.getItem("tramaInbox")),mista = [];
			for (var d = 0; d < textox.length; d++){
				var timesr = textox[d].time.split(" "),fecham = timesr[0],hourm = timesr[1];
				if(textox[d].port == elem.port && textox[d].text.indexOf("DIM") > -1){
					
					String.prototype.replaceAll = function(search, replacement) {
						var target = this;return target.replace(new RegExp(search, 'g'), replacement);
					};

					var nombr = textox[d].text.replaceAll("\r","");
					var netsx = nombr.replaceAll("\n","");
					var nets = JSON.parse(textox[d].text);

					for (var m = 0; m < nets.length; m++){
						
						if (nets[m]!==""){

							if (nets[m].indexOf("DIM")>-1){
								var te = nets[m].split("*");
								mista.push([fecham,hourm,"Din"+te[1],te[2]]);
								liso.push("Din"+te[1]);
							}

						}
					}
				}
			} 
			
			window.sessionStorage.setItem("temporalRelayhistory",JSON.stringify(mista));
			
			
			var listt = Array.from(new Set(liso));
			var texti4x='<option value=""></option>';
			for (var gcx = 0; gcx < listt.length; gcx++){
				if (listt[gcx]!=="Din8"){
					texti4x=texti4x+'<option value="'+listt[gcx]+'">'+listt[gcx]+'</option>';
				}
			}
			$("#sensDim").html(texti4x);
			
			$("#sensDim").change(function(){
				
				var mista = JSON.parse(window.sessionStorage.getItem("temporalRelayhistory"));
				var ano = []; 
				for (var h = 0; h < mista.length; h++ ){
					var extra = mista[h][0];
					var nuevo = extra.split("/");
					if($("#sensDim").val() == mista[h][2]){
						ano.push(nuevo[2]);
					}
				}
				
				var listaw = Array.from(new Set(ano));
				var texti4='<option value=""></option>';
				for (var gc = 0; gc < listaw.length; gc++){
					texti4=texti4+'<option value="'+listaw[gc]+'">'+listaw[gc]+'</option>';
				}
				$("#anoslisrdintrama").html(texti4);
				
			});

			
			$("#smodalDintrama").modal("show");
			
			$("#anoslisrdintrama").change(function(){
				
				var mes = []; 
				var anos = $("#anoslisrdintrama").val();
				var lista = JSON.parse(window.sessionStorage.getItem("temporalRelayhistory"));
				for (var h = 0; h <lista.length; h++ ){
					var extra = lista[h][0];
					var nuevo = extra.split("/");
					if (nuevo[2] == anos && $("#sensDim").val() == lista[h][2]){
						mes.push(nuevo[1]);
					}
				}
				var listaw = Array.from(new Set(mes));
				var texti4='<option value=""></option>';
				for (var gc = 0; gc < listaw.length; gc++){
					texti4=texti4+'<option value="'+listaw[gc]+'">'+listaw[gc]+'</option>';
				}
				$("#meslisrdintrama").html(texti4);
						
			});
			
			$("#meslisrdintrama").change(function(){
		
				var dia = []; 
				var anos = $("#anoslisrdintrama").val();
				var mes = $("#meslisrdintrama").val();
				var lista = JSON.parse(window.sessionStorage.getItem("temporalRelayhistory"));
				for (var h = 0; h <lista.length; h++ ){
					var extra = lista[h][0];
					var nuevo = extra.split("/");
					if (nuevo[2] == anos && nuevo[1] == mes && $("#sensDim").val() == lista[h][2]){
						dia.push(nuevo[0]);
					}
				}
				var listaw = Array.from(new Set(dia));
				var texti4='<option value=""></option>';
				for (var gc = 0; gc < listaw.length; gc++){
					texti4=texti4+'<option value="'+listaw[gc]+'">'+listaw[gc]+'</option>';
				}
				$("#diaslisrdintrama").html(texti4);
				
			});
			
			$("#diaslisrdintrama").change(function(){
				
				var uniqueItems = [],valoresdonu =[],colores=[];
				var anos = $("#anoslisrdintrama").val();
				var mes = $("#meslisrdintrama").val();
				var dia = $("#diaslisrdintrama").val();
				var lista = JSON.parse(window.sessionStorage.getItem("temporalRelayhistory"));
				for (var h = 0; h <lista.length; h++ ){
					var extra = lista[h][0];
					var nuevo = extra.split("/");
					if (nuevo[2] == anos && nuevo[1] == mes && nuevo[0] == dia && $("#sensDim").val() == lista[h][2]){
						uniqueItems.push(lista[h][2]+" "+lista[h][0]+" "+lista[h][1]);
						
						var inid = lista[h][3].toString();
						if (inid.indexOf("268435457")>-1){
							colores.push("#1ab394");
						}else if(inid.indexOf("536870913")>-1){
							colores.push("#79d2c0");
						}else if(inid.indexOf("805306369")>-1){
							colores.push("#d3d3d3");
						}else if (parseInt(inid) > 0){
							colores.push("#1c84c6");
						}
						
						valoresdonu.push(lista[h][3]);

					}
				}
									
				if(window.donusm){
					window.donusm.destroy();
				}

				var doughions3 = {
					responsive: true,
					title: {
						display: false
					},
					legend: {
						display: false
					}
				};
				
				console.log(uniqueItems);
				console.log(valoresdonu);
				
				var doughnutDa = {
					labels: uniqueItems,
					datasets: [{
						label:"Datos din via sms",
						data: valoresdonu,
						backgroundColor: colores
					}]
				};
				var ctxz = document.getElementById("realgrafidintrama").getContext("2d");
				window.donusm = new Chart(ctxz, {type: 'bar', data: doughnutDa, options:doughions3});

				window.donusm.update();
			});
			
		}
		
		function histoarialdmdin(elem){
		
			var textox = JSON.parse(window.sessionStorage.getItem("smsInbox")),mista = [];
			for (var d = 0; d < textox.length; d++){
				var timesr = textox[d].time.split(" "),fecham = timesr[0],hourm = timesr[1];

				if(textox[d].number == elem.tel && textox[d].text.indexOf("DIN") > -1){
					
					var texto = textox[d].text;
					String.prototype.replaceAll = function(search, replacement) {
						var target = this;return target.replace(new RegExp(search, 'g'), replacement);
					};

					var limpio = texto.replaceAll("\r","");
					var filtro = limpio.replaceAll("\n","");
					var nets = filtro.split(";");

					for (var m = 0; m < nets.length; m++){

						if (nets[m]!=="" && nets[m].indexOf("DIN")>-1){
							var te = nets[m].split(":");
							var oto = te[1].split(",");
							var fechax = moment().format('DD/MM/YYYY',fecham);
							
							mista.push([te[0],oto[1],oto[0],fechax,hourm]);

						}
					}
				}
			}
                        
			if (mista.length==0){
				mista.push(["No posee","No posee","No posee","No posee","No posee"]);
			}

			$('#TabledinHistorysms').DataTable({
				columns: [
					{title: "Id Din"},
					{title: "Estado"},
					{title: "Valor"},
					{title: "Fecha"},
					{title: "Hora"}
				],
				data: mista,
				pageLength: 25,
				responsive: true,
				dom: '<"html5buttons"B>lTfgitp',
				buttons: [
					{extend: 'csv'},
					{extend: 'excel', title: 'M2M_reporte_din_history'},
					{extend: 'pdf', title: 'M2M_reporte_din_history'},
					{extend: 'print',
						customize: function (win){
							$(win.document.body).addClass('white-bg');
							$(win.document.body).css('font-size', '10px');
							$(win.document.body).find('table').addClass('compact').css('font-size', 'inherit');
						}
					}
				]
			});

			$("#modalhistorialsmsdin").modal("show");
		}
		
		$("#modalhistorialsmsdin").on("hidden.bs.modal", function () {
			var table = $('#TabledinHistorysms').DataTable();
			table.destroy();
		});
		
		
		$("#historialsmsDin").click(function(){
			var lista = [],otros = [];
			var ver = JSON.parse(window.sessionStorage.getItem("punteados"));
			for (var h = 0; h < ver.length; h++){
				lista.push(ver[h].nom);
				otros.push(h);
			}
		
			var selectList = document.createElement("select");
			selectList.id = "mySelect";
			for (var i = 0; i < lista.length; i++) {
				var option = document.createElement("option");
				option.value = otros[i];
				option.text = lista[i];
				selectList.appendChild(option);
			}
			
			swal("Seleccione elemento especifico", {
			  content: selectList,
			}).then((value) => {
				var valor = ver[$("#mySelect").select()[0].value];
				histoarialdmdin(valor);
			});
		});
		
		function historialdintrama(elem){
		
			var textox = JSON.parse(window.sessionStorage.getItem("tramaInbox")),mista = [];
			for (var d = 0; d < textox.length; d++){
				var timesr = textox[d].time.split(" "),fecham = timesr[0],hourm = timesr[1];
				if(textox[d].port == elem.port && textox[d].text.indexOf("DIM") > -1){
					
					var nets = JSON.parse(textox[d].text);
					for (var m = 0; m < nets.length; m++){
					
						if (nets[m]!==""){
							
							var te = nets[m].split("*");
							if(te[0].indexOf("DIM")>-1){
								var nues = te[0].replace("DIM","DIN");
									
								var inid = te[2].toString();
								if (inid.indexOf("268435457")>-1){
									var texs = "Nc";
								}else if(inid.indexOf("536870913")>-1){
									var texs = "No";
								}else if(inid.indexOf("805306369")>-1){
									var texs = "Change";
								}else if (parseInt(inid) > 0){
									var texs = "Couter";
								}
								
								mista.push([nues+te[1],texs,fecham,hourm]);
							}
							
						}
					}
					
					
				}
			}
			
			if (mista.length==0){
				mista.push(["No posee","No posee","No posee","No posee"]);
			}
			
			$('#Tabletramadin').DataTable({
				columns: [
					{title: "Sensor"},
					{title: "Valor"},
					{title: "Fecha"},
					{title: "Hora"}
				],
				data: mista,
				pageLength: 25,
				responsive: true,
				dom: '<"html5buttons"B>lTfgitp',
				buttons: [
					{extend: 'csv'},
					{extend: 'excel', title: 'M2M_reporte_din_trama_history'},
					{extend: 'pdf', title: 'M2M_reporte_din_trama_history'},
					{extend: 'print',
						customize: function (win){
							$(win.document.body).addClass('white-bg');
							$(win.document.body).css('font-size', '10px');
							$(win.document.body).find('table').addClass('compact').css('font-size', 'inherit');
						}
					}
				]
			});
						
			$("#modaltramadin").modal("show");
		}
		
		$("#historialtramadin").click(function(){
			
			var lista = [],otros = [];
			var ver = JSON.parse(window.sessionStorage.getItem("punteados"));
			for (var h = 0; h < ver.length; h++){
				lista.push(ver[h].nom);
				otros.push(h);
			}
		
			var selectList = document.createElement("select");
			selectList.id = "mySelect";
			for (var i = 0; i < lista.length; i++) {
				var option = document.createElement("option");
				option.value = otros[i];
				option.text = lista[i];
				selectList.appendChild(option);
			}
			
			swal("Seleccione elemento especifico", {
			  content: selectList,
			}).then((value) => {
				var valor = ver[$("#mySelect").select()[0].value];
				historialdintrama(valor);
			});
			
		});
		
		$("#Modaltramasms").click(function(){
			var lista = [],otros = [];
			var ver = JSON.parse(window.sessionStorage.getItem("punteados"));
			for (var h = 0; h < ver.length; h++){
				lista.push(ver[h].nom);
				otros.push(h);
			}
		
			var selectList = document.createElement("select");
			selectList.id = "mySelect";
			for (var i = 0; i < lista.length; i++) {
				var option = document.createElement("option");
				option.value = otros[i];
				option.text = lista[i];
				selectList.appendChild(option);
			}
			
			swal("Seleccione elemento especifico", {
			  content: selectList,
			}).then((value) => {
				var valor = ver[$("#mySelect").select()[0].value];
				graftramasms(valor);
			});
		});
		
		$("#grafrelaytemp").click(function(){
			
			var lista = [],otros = [];
			var ver = JSON.parse(window.sessionStorage.getItem("punteados"));
			for (var h = 0; h < ver.length; h++){
				lista.push(ver[h].nom);
				otros.push(h);
			}
		
			var selectList = document.createElement("select");
			selectList.id = "mySelect";
			for (var i = 0; i < lista.length; i++) {
				var option = document.createElement("option");
				option.value = otros[i];
				option.text = lista[i];
				selectList.appendChild(option);
			}
			
			swal("Seleccione elemento especifico", {
			  content: selectList,
			}).then((value) => {
				var valor = ver[$("#mySelect").select()[0].value];
				temperatureG(valor);
			});
			
		});
		
		function humedyG(elem){
			
			var textox = JSON.parse(window.sessionStorage.getItem("smsInbox")),mista = [];
			for (var d = 0; d < textox.length; d++){
				var timesr = textox[d].time.split(" "),fecham = timesr[0],hourm = timesr[1];

				if(textox[d].number == elem.tel && textox[d].text.indexOf("Humi") > -1){
					
					var texto = textox[d].text;
					String.prototype.replaceAll = function(search, replacement) {
						var target = this;return target.replace(new RegExp(search, 'g'), replacement);
					};

					var limpio = texto.replaceAll("\r","");
					var filtro = limpio.replaceAll("\n","");
					var nets = filtro.split(";");

					for (var m = 0; m < nets.length; m++){

						if (nets[m]!=="" && nets[m].indexOf("Humi")>-1){
							var te = nets[m].split(":");
							var oto = te[1].split(",");
							var fechax = moment().format('DD/MM/YYYY',fecham);
							
							mista.push([oto[1],oto[0],fechax,hourm]);

						}
					}
				}
			}
                        
			if (mista.length==0){
				mista.push(["No posee","No posee","No posee","No posee"]);
			}

			$('#TableRelayHistoryHume').DataTable({
				columns: [
					{title: "Estado"},
					{title: "Valor"},
					{title: "Fecha"},
					{title: "Hora"}
				],
				data: mista,
				pageLength: 25,
				responsive: true,
				dom: '<"html5buttons"B>lTfgitp',
				buttons: [
					{extend: 'csv'},
					{extend: 'excel', title: 'M2M_reporte_humedad_history'},
					{extend: 'pdf', title: 'M2M_reporte_humedad_history'},
					{extend: 'print',
						customize: function (win){
							$(win.document.body).addClass('white-bg');
							$(win.document.body).css('font-size', '10px');
							$(win.document.body).find('table').addClass('compact').css('font-size', 'inherit');
						}
					}
				]
			});

			$("#modalRelayhistoryHume").modal("show");

		}
		
		function grafdinsms(elem){
			
			var textox = JSON.parse(window.sessionStorage.getItem("smsInbox")),mista = [];
			for (var d = 0; d < textox.length; d++){
				var timesr = textox[d].time.split(" "),fecham = timesr[0],hourm = timesr[1];
				if(textox[d].number == elem.tel && textox[d].text.indexOf("DIN") > -1){
					
					String.prototype.replaceAll = function(search, replacement) {
						var target = this;return target.replace(new RegExp(search, 'g'), replacement);
					};

					var nombr = textox[d].text.replaceAll("\r","");
					var netsx = nombr.replaceAll("\n","");
					var nets = netsx.split(";");

					for (var m = 0; m < nets.length; m++){
						
						if (nets[m]!==""){

							if (nets[m].indexOf("DIN")>-1){
								var te = nets[m].split(":");
								var fes = te[1].split(",");
								if(fes[0].indexOf(".")>-1){
									mista.push([fecham,hourm,fes[0],te[0]]);
								}
							}

						}
					}
				}
			} 
			
			window.sessionStorage.setItem("temporalRelayhistory",JSON.stringify(mista));
			
			var ano = []; 
			for (var h = 0; h <mista.length; h++ ){
				var extra = mista[h][0];
				var nuevo = extra.split("/");
				ano.push(nuevo[0]);
			}
			
			var listaw = Array.from(new Set(ano));
			var texti4='<option value=""></option>';
			for (var gc = 0; gc < listaw.length; gc++){
				texti4=texti4+'<option value="'+listaw[gc]+'">'+listaw[gc]+'</option>';
			}
			$("#anoslisrdinsms").html(texti4);
			
			$("#smodalDinsms").modal("show");
			
			$("#anoslisrdinsms").change(function(){
				
				var mes = []; 
				var anos = $("#anoslisrdinsms").val();
				var lista = JSON.parse(window.sessionStorage.getItem("temporalRelayhistory"));
				for (var h = 0; h <lista.length; h++ ){
					var extra = lista[h][0];
					var nuevo = extra.split("/");
					if (nuevo[0] == anos){
						mes.push(nuevo[1]);
					}
				}
				var listaw = Array.from(new Set(mes));
				var texti4='<option value=""></option>';
				for (var gc = 0; gc < listaw.length; gc++){
					texti4=texti4+'<option value="'+listaw[gc]+'">'+listaw[gc]+'</option>';
				}
				$("#meslisrdinsms").html(texti4);
						
			});
			
			$("#meslisrdinsms").change(function(){
		
				var dia = []; 
				var rel =ids;
				var anos = $("#anoslisrdinsms").val();
				var mes = $("#meslisrdinsms").val();
				var lista = JSON.parse(window.sessionStorage.getItem("temporalRelayhistory"));
				for (var h = 0; h <lista.length; h++ ){
					var extra = lista[h][0];
					var nuevo = extra.split("/");
					if (nuevo[0] == anos && nuevo[1] == mes){
						dia.push(nuevo[2]);
					}
				}
				var listaw = Array.from(new Set(dia));
				var texti4='<option value=""></option>';
				for (var gc = 0; gc < listaw.length; gc++){
					texti4=texti4+'<option value="'+listaw[gc]+'">'+listaw[gc]+'</option>';
				}
				$("#diaslisrHumsms").html(texti4);
				
			});
			
			$("#diaslisrdinsms").change(function(){
				
				var uniqueItems = [],valoresdonu =[],colores=[];
				var rel = ids;
				var anos = $("#anoslisrdinsms").val();
				var mes = $("#meslisrdinsms").val();
				var dia = $("#diaslisrdinsms").val();
				var lista = JSON.parse(window.sessionStorage.getItem("temporalRelayhistory"));
				for (var h = 0; h <lista.length; h++ ){
					var extra = lista[h][0];
					var nuevo = extra.split("/");
					if (nuevo[0] == anos && nuevo[1] == mes && nuevo[2] == dia){
						uniqueItems.push(lista[h][3]+" "+lista[h][0]+" "+lista[h][1]);
						valoresdonu.push(lista[h][2]);
						colores.push("#1c84c6");
					}
				}
									
				if(window.donusm){
					window.donusm.destroy();
				}

				var doughions3 = {
					responsive: true,
					title: {
						display: false
					},
					legend: {
						display: false
					}
				};
				var doughnutDa = {
					labels: uniqueItems,
					datasets: [{
						label:"Datos din via sms",
						data: valoresdonu,
						backgroundColor: colores
					}]
				};
				var ctxz = document.getElementById("realgrafidin").getContext("2d");
				window.donusm = new Chart(ctxz, {type: 'bar', data: doughnutDa, options:doughions3});

				window.donusm.update();
			});
			
		}
		
		$("#Modaldinsms").click(function(){
			var lista = [],otros = [];
			var ver = JSON.parse(window.sessionStorage.getItem("punteados"));
			for (var h = 0; h < ver.length; h++){
				lista.push(ver[h].nom);
				otros.push(h);
			}
		
			var selectList = document.createElement("select");
			selectList.id = "mySelect";
			for (var i = 0; i < lista.length; i++) {
				var option = document.createElement("option");
				option.value = otros[i];
				option.text = lista[i];
				selectList.appendChild(option);
			}
			
			swal("Seleccione elemento especifico", {
			  content: selectList,
			}).then((value) => {
				var valor = ver[$("#mySelect").select()[0].value];
				grafdinsms(valor);
			});
		});
		
		$("#grafrelayHume").click(function(){
			
			var lista = [],otros = [];
			var ver = JSON.parse(window.sessionStorage.getItem("punteados"));
			for (var h = 0; h < ver.length; h++){
				lista.push(ver[h].nom);
				otros.push(h);
			}
		
			var selectList = document.createElement("select");
			selectList.id = "mySelect";
			for (var i = 0; i < lista.length; i++) {
				var option = document.createElement("option");
				option.value = otros[i];
				option.text = lista[i];
				selectList.appendChild(option);
			}
			
			swal("Seleccione elemento especifico", {
			  content: selectList,
			}).then((value) => {
				var valor = ver[$("#mySelect").select()[0].value];
				humedyG(valor);
			});
			
		});
		
		$("#modalRelayhistoryHume").on("hidden.bs.modal", function () {
			var table = $('#TableRelayHistory').DataTable();
			table.destroy();
		});
		
		$("#modaltramadin").on("hidden.bs.modal", function () {
			var table = $('#Tabletramadin').DataTable();
			table.destroy();
		});
		
		$("#modalRelayhistory").on("hidden.bs.modal", function () {
			var table = $('#TableRelayHistoryHume').DataTable();
			table.destroy();
		});
		
		$("#modalRelayhistoryTemp").on("hidden.bs.modal", function () {
			var table = $('#TableRelayHistoryTemp').DataTable();
			table.destroy();
		});
		
		function lanzarModalrelay2t(elem){
			
			var textox = JSON.parse(window.sessionStorage.getItem("tramaInbox")),mista = [];
			for (var d = 0; d < textox.length; d++){
				var timesr = textox[d].time.split(" "),fecham = timesr[0],hourm = timesr[1];
				if(textox[d].port == elem.port && textox[d].text.indexOf("Dout") > -1){
					
					var nets = JSON.parse(textox[d].text);
					for (var m = 0; m < nets.length; m++){
					
						var te = nets[m].split("*");
						if (te[2].indexOf("Close")>-1){
							mista.push(["Close","Dout"+te[1],fecham,hourm]);
						}else{
							mista.push(["Open","Dout"+te[1],fecham,hourm]);
						}

					}
					
				}
			}
			
			if (mista.length==0){
				mista.push(["No posee","No posee","No posee","No posee"]);
			}
			
			$('#TableRelayHistorytrama').DataTable({
				columns: [
					{title: "Estado"},
					{title: "Id relay"},
					{title: "Fecha"},
					{title: "Hora"}
				],
				data: mista,
				pageLength: 25,
				responsive: true,
				dom: '<"html5buttons"B>lTfgitp',
				buttons: [
					{extend: 'csv'},
					{extend: 'excel', title: 'M2M_reporte_relays_history'},
					{extend: 'pdf', title: 'M2M_reporte_relays_history'},
					{extend: 'print',
						customize: function (win){
							$(win.document.body).addClass('white-bg');
							$(win.document.body).css('font-size', '10px');
							$(win.document.body).find('table').addClass('compact').css('font-size', 'inherit');
						}
					}
				]
			});
						
			$("#modalRelayhistorytrama").modal("show");
		}
		
		$("#ModalRelayHistorial2").click(function(){
			
			var lista = [],otros = [];
			var ver = JSON.parse(window.sessionStorage.getItem("punteados"));
			for (var h = 0; h < ver.length; h++){
				lista.push(ver[h].nom);
				otros.push(h);
			}
		
			var selectList = document.createElement("select");
			selectList.id = "mySelect";
			for (var i = 0; i < lista.length; i++) {
				var option = document.createElement("option");
				option.value = otros[i];
				option.text = lista[i];
				selectList.appendChild(option);
			}
			
			swal("Seleccione elemento especifico", {
			  content: selectList,
			}).then((value) => {
				var valor = ver[$("#mySelect").select()[0].value];
				lanzarModalrelay2t(valor);
			});
			
		});
		
		function lanzarModalrelay2ttemp(elem){
			
			var textox = JSON.parse(window.sessionStorage.getItem("tramaInbox")),mista = [];
			for (var d = 0; d < textox.length; d++){
				var timesr = textox[d].time.split(" "),fecham = timesr[0],hourm = timesr[1];
				if(textox[d].port == elem.port && textox[d].text.indexOf("Temperature") > -1){
					
					var nets = JSON.parse(textox[d].text);
					for (var m = 0; m < nets.length; m++){
					
						if (nets[m]!==""){
							
							var te = nets[m].split("*");
							if(te[0].indexOf("Temperature")>-1){
								mista.push(["Temperatura",te[2],fecham,hourm]);
							}
							
						}
					}
					
					
				}
			}
			
			if (mista.length==0){
				mista.push(["No posee","No posee","No posee","No posee"]);
			}
			
			$('#TableTempHistory').DataTable({
				columns: [
					{title: "Sensor"},
					{title: "Valor"},
					{title: "Fecha"},
					{title: "Hora"}
				],
				data: mista,
				pageLength: 25,
				responsive: true,
				dom: '<"html5buttons"B>lTfgitp',
				buttons: [
					{extend: 'csv'},
					{extend: 'excel', title: 'M2M_reporte_temperatura_history'},
					{extend: 'pdf', title: 'M2M_reporte_temperatura_history'},
					{extend: 'print',
						customize: function (win){
							$(win.document.body).addClass('white-bg');
							$(win.document.body).css('font-size', '10px');
							$(win.document.body).find('table').addClass('compact').css('font-size', 'inherit');
						}
					}
				]
			});
						
			$("#modaltemphistorytrama").modal("show");
		}
		
		$("#ModalRelayHistorial2temp").click(function(){
						
			var lista = [],otros = [];
			var ver = JSON.parse(window.sessionStorage.getItem("punteados"));
			for (var h = 0; h < ver.length; h++){
				lista.push(ver[h].nom);
				otros.push(h);
			}
		
			var selectList = document.createElement("select");
			selectList.id = "mySelect";
			for (var i = 0; i < lista.length; i++) {
				var option = document.createElement("option");
				option.value = otros[i];
				option.text = lista[i];
				selectList.appendChild(option);
			}
			
			swal("Seleccione elemento especifico", {
			  content: selectList,
			}).then((value) => {
				var valor = ver[$("#mySelect").select()[0].value];
				lanzarModalrelay2ttemp(valor);
			});
			
		});
		
		$("#ModalRelayHistorial").click(function(){
			
			var lista = [],otros = [];
			var ver = JSON.parse(window.sessionStorage.getItem("punteados"));
			for (var h = 0; h < ver.length; h++){
				lista.push(ver[h].nom);
				otros.push(h);
			}
		
			var selectList = document.createElement("select");
			selectList.id = "mySelect";
			for (var i = 0; i < lista.length; i++) {
				var option = document.createElement("option");
				option.value = otros[i];
				option.text = lista[i];
				selectList.appendChild(option);
			}
			
			swal("Seleccione elemento especifico", {
			  content: selectList,
			}).then((value) => {
				var valor = ver[$("#mySelect").select()[0].value];
				lanzarModalrelay(valor);
			});
			
		});
		
		function grafSmshume(elem){
			
			var textox = JSON.parse(window.sessionStorage.getItem("smsInbox")),mista = [];
			for (var d = 0; d < textox.length; d++){
				var timesr = textox[d].time.split(" "),fecham = timesr[0],hourm = timesr[1];
				if(textox[d].number == elem.tel && textox[d].text.indexOf("Humi") > -1){
					
					String.prototype.replaceAll = function(search, replacement) {
						var target = this;return target.replace(new RegExp(search, 'g'), replacement);
					};

					var nombr = textox[d].text.replaceAll("\r","");
					var netsx = nombr.replaceAll("\n","");
					var nets = netsx.split(";");

					for (var m = 0; m < nets.length; m++){
						
						if (nets[m]!==""){

							if (nets[m].indexOf("Humi")>-1){
								var te = nets[m].split(":");
								var fes = te[1].split(",");
								mista.push([fecham,hourm,fes[0]]);
							}

						}
					}
				}
			} 
			
			window.sessionStorage.setItem("temporalRelayhistory",JSON.stringify(mista));
			
			var ano = []; 
			for (var h = 0; h <mista.length; h++ ){
				var extra = mista[h][0];
				var nuevo = extra.split("/");
				ano.push(nuevo[0]);
			}
			
			var listaw = Array.from(new Set(ano));
			var texti4='<option value=""></option>';
			for (var gc = 0; gc < listaw.length; gc++){
				texti4=texti4+'<option value="'+listaw[gc]+'">'+listaw[gc]+'</option>';
			}
			$("#anoslisrHumesms").html(texti4);
			
			$("#modalGrafaHume").modal("show");
			
			$("#anoslisrHumesms").change(function(){
				
				var mes = []; 
				var anos = $("#anoslisrHumesms").val();
				var lista = JSON.parse(window.sessionStorage.getItem("temporalRelayhistory"));
				for (var h = 0; h <lista.length; h++ ){
					var extra = lista[h][0];
					var nuevo = extra.split("/");
					if (nuevo[0] == anos){
						mes.push(nuevo[1]);
					}
				}
				var listaw = Array.from(new Set(mes));
				var texti4='<option value=""></option>';
				for (var gc = 0; gc < listaw.length; gc++){
					texti4=texti4+'<option value="'+listaw[gc]+'">'+listaw[gc]+'</option>';
				}
				$("#meslisrHumesms").html(texti4);
						
			});
			
			$("#meslisrHumesms").change(function(){
		
				var dia = []; 
				var anos = $("#anoslisrHumesms").val();
				var mes = $("#meslisrHumesms").val();
				var lista = JSON.parse(window.sessionStorage.getItem("temporalRelayhistory"));
				for (var h = 0; h <lista.length; h++ ){
					var extra = lista[h][0];
					var nuevo = extra.split("/");
					if (nuevo[0] == anos && nuevo[1] == mes){
						dia.push(nuevo[2]);
					}
				}
				var listaw = Array.from(new Set(dia));
				var texti4='<option value=""></option>';
				for (var gc = 0; gc < listaw.length; gc++){
					texti4=texti4+'<option value="'+listaw[gc]+'">'+listaw[gc]+'</option>';
				}
				$("#diaslisrHumesms").html(texti4);
				
			});
			
			$("#diaslisrHumesms").change(function(){
				
				var uniqueItems = [],valoresdonu =[],colores=[];
				var anos = $("#anoslisrHumesms").val();
				var mes = $("#meslisrHumesms").val();
				var dia = $("#diaslisrHumesms").val();
				var lista = JSON.parse(window.sessionStorage.getItem("temporalRelayhistory"));
				for (var h = 0; h <lista.length; h++ ){
					var extra = lista[h][0];
					var nuevo = extra.split("/");
					if (nuevo[0] == anos && nuevo[1] == mes && nuevo[2] == dia){
						uniqueItems.push(lista[h][0]+" "+lista[h][1]);
						valoresdonu.push(lista[h][2]);
						colores.push("#1c84c6");
					}
				}
									
				if(window.donus3t3){
					window.donus3t3.destroy();
				}

				var doughnutOptions3t = {
					responsive: true,
					title: {
						display: false
					},
					legend: {
						display: false
					}
				};
				var doughnutData2t3 = {
					labels: uniqueItems,
					datasets: [{
						label:"Datos del Humedad",
						data: valoresdonu,
						backgroundColor: colores
					}]
				};
				var ctx3t3 = document.getElementById("realgrafihume2").getContext("2d");
				window.donus3t3 = new Chart(ctx3t3, {type: 'bar', data: doughnutData2t3, options:doughnutOptions3t});

				window.donus3t3.update();
			});
			
		}
		
		function graftramahumedad(elem){
		
			var textox = JSON.parse(window.sessionStorage.getItem("tramaInbox")),mista = [];
			for (var d = 0; d < textox.length; d++){
				var timesr = textox[d].time.split(" "),fecham = timesr[0],hourm = timesr[1];
				
				if(textox[d].port == elem.port && textox[d].text.indexOf("Humedy") > -1){
					var nomr = elem.nom;
					var nets = JSON.parse(textox[d].text);
					
					for (var m = 0; m < nets.length; m++){
						
						var info = nets[m].split("*");
						if (info[0].indexOf("Humedy")>-1){
							mista.push([info[2],nomr,fecham,hourm]);
						}
						
					}
				}
				
			}
			
			window.sessionStorage.setItem("temporalRelayhistorytrama",JSON.stringify(mista));
						
			var ano = []; 
			for (var h = 0; h <mista.length; h++ ){
				var extra = mista[h][2];
				var nuevo = extra.split("/");
				ano.push(nuevo[2]);
			}
			
			var listaw = Array.from(new Set(ano));
			var texti4='<option value=""></option>';
			for (var gc = 0; gc < listaw.length; gc++){
				texti4=texti4+'<option value="'+listaw[gc]+'">'+listaw[gc]+'</option>';
			}
			$("#anoslisrtramahume").html(texti4);
			
			$("#modalgraftramaHumedy").modal("show");
			
			$("#anoslisrtramahume").change(function(){
				
				var mes = []; 
				var anos = $("#anoslisrtramahume").val();
				var lista = JSON.parse(window.sessionStorage.getItem("temporalRelayhistorytrama"));
				for (var h = 0; h <lista.length; h++ ){
					var extra = lista[h][2];
					var nuevo = extra.split("/");
					if (nuevo[2] == anos){
						mes.push(nuevo[1]);
					}
				}
				var listaw = Array.from(new Set(mes));
				var texti4='<option value=""></option>';
				for (var gc = 0; gc < listaw.length; gc++){
					texti4=texti4+'<option value="'+listaw[gc]+'">'+listaw[gc]+'</option>';
				}
				$("#meslisrtramahume").html(texti4);
						
			});
			
			$("#meslisrtramahume").change(function(){
		
				var dia = []; 
				var anos = $("#anoslisrtramahume").val();
				var mes = $("#meslisrtramahume").val();
				var lista = JSON.parse(window.sessionStorage.getItem("temporalRelayhistorytrama"));
				for (var h = 0; h <lista.length; h++ ){
					var extra = lista[h][2];
					var nuevo = extra.split("/");
					if (nuevo[2] == anos && nuevo[1] == mes){
						dia.push(nuevo[0]);
					}
				}
				var listaw = Array.from(new Set(dia));
				var texti4='<option value=""></option>';
				for (var gc = 0; gc < listaw.length; gc++){
					texti4=texti4+'<option value="'+listaw[gc]+'">'+listaw[gc]+'</option>';
				}
				$("#diaslisrtramahume").html(texti4);
				
			});
		
			$("#diaslisrtramahume").change(function(){
				
				var uniqueItems = [],valoresdonu =[],colores=[];
				var anos = $("#anoslisrtramahume").val();
				var mes = $("#meslisrtramahume").val();
				var dia = $("#diaslisrtramahume").val();
				var lista = JSON.parse(window.sessionStorage.getItem("temporalRelayhistorytrama"));
				for (var h = 0; h <lista.length; h++ ){
					
					var extra = lista[h][2];
					var nuevo = extra.split("/");
					if (nuevo[2] == anos && nuevo[1] == mes && nuevo[0] == dia){
						
						uniqueItems.push(lista[h][2]+" "+lista[h][3]);
						valoresdonu.push(lista[h][0]);
						colores.push("#1c84c6");

					}
				
				}
				
					
				if(window.donustsmq){
					window.donustsmq.destroy();
				}

				var doughnutOptions2q2w = {
					responsive: true,
					title: {
						display: false
					},
					legend: {
						display: false
					}
				};
				var doughnutDatatq2w = {
					labels: uniqueItems,
					datasets: [{
						label:"Datos de humedad via trama",
						data: valoresdonu,
						backgroundColor: colores
					}]
				};
				var ctx3sz = document.getElementById("realDatostramahumedy").getContext("2d");
				window.donustsmq = new Chart(ctx3sz, {type: 'bar', data: doughnutDatatq2w, options:doughnutOptions2q2w});

				window.donustsmq.update();
			});
			
		}
		
		$("#grafrelay2hume").click(function(){
			var lista = [],otros = [];
			var ver = JSON.parse(window.sessionStorage.getItem("punteados"));
			for (var h = 0; h < ver.length; h++){
				lista.push(ver[h].nom);
				otros.push(h);
			}
		
			var selectList = document.createElement("select");
			selectList.id = "mySelect";
			for (var i = 0; i < lista.length; i++) {
				var option = document.createElement("option");
				option.value = otros[i];
				option.text = lista[i];
				selectList.appendChild(option);
			}
			
			swal("Seleccione elemento especifico", {
			  content: selectList,
			}).then((value) => {
				var valor = ver[$("#mySelect").select()[0].value];
				graftramahumedad(valor);
			});
		});
		
		$("#ModalRelayHistorialhume").click(function(){
			var lista = [],otros = [];
			var ver = JSON.parse(window.sessionStorage.getItem("punteados"));
			for (var h = 0; h < ver.length; h++){
				lista.push(ver[h].nom);
				otros.push(h);
			}
		
			var selectList = document.createElement("select");
			selectList.id = "mySelect";
			for (var i = 0; i < lista.length; i++) {
				var option = document.createElement("option");
				option.value = otros[i];
				option.text = lista[i];
				selectList.appendChild(option);
			}
			
			swal("Seleccione elemento especifico", {
			  content: selectList,
			}).then((value) => {
				var valor = ver[$("#mySelect").select()[0].value];
				grafSmshume(valor);
			});
		});
		
		function eliminarProgEncendido(hor,min,dia){
		
			var auth = JSON.parse(window.sessionStorage.getItem("sesion"));
			var token = auth.t,email = auth.e;
			backend.query({"t":token,"e":email,"a":"delRelayProgEncen","d":{"horaFre": hor,"minutoFre":min,"diasFrecue":dia}},block.ip,"8088",function(salida){

				var sali = JSON.parse(salida);
				if (!sali.e){
					toastr.info('Se elimino la programación de encendido del relay');
					
					if(window.sessionStorage.getItem("Encendidos")){
						var nuevo = JSON.parse(window.sessionStorage.getItem("Encendidos")),otro =[];
						for (var j = 0; j < nuevo.length; j++){
							var uno = nuevo[j].horaFre;
							var dos = nuevo[j].minutoFre;
							if(uno!==hor && dos!==min  && nuevo[j].diasFrecue!==dia){
								otro.push(nuevo[j]);
							}
						}
						window.sessionStorage.setItem("Encendidos",JSON.stringify(otro));
						
					}else{
						toastr.info('No posee programación encendido a eliminar');
						
					}
				}else{
					toastr.info('No es posible eliminar');
					
				}
			});
		}
		
		$("#E_encendido").click(function(){
			
			var selectList = document.createElement("select");
			selectList.id = "mySelect";
			
			var sens = JSON.parse(window.sessionStorage.getItem("Encendidos"));
			for (var f =0; f < sens.length; f++){
				var option = document.createElement("option");
				option.value = sens[f].horaFre+":"+sens[f].minutoFre+":"+sens[f].diasFrecue;
				option.text = sens[f].horaFre+":"+sens[f].minutoFre;
				selectList.appendChild(option);
			}
			
			swal("Seleccione programado de encendido especifico a eliminar", {
			  content: selectList,
			}).then((value) => {
				var valor = $("#mySelect").select()[0].value.split(":");
				eliminarProgEncendido(valor[0],valor[1],valor[2]);
			});
		});
		
		function eliminarProgApagados(hor,min,dia){
		
			var auth = JSON.parse(window.sessionStorage.getItem("sesion"));
			var token = auth.t,email = auth.e;
			backend.query({"t":token,"e":email,"a":"delRelayProgApaga","d":{"horaFre": hor,"minutoFre":min,"diasFrecue":dia}},block.ip,"8088",function(salida){
				var sali = JSON.parse(salida);
				if (!sali.e){
					toastr.info('Se elimino la programación de apagado del relay');
					
					if(window.sessionStorage.getItem("Apagados")){
						var nuevo = JSON.parse(window.sessionStorage.getItem("Apagados")),otro =[];
						for (var j = 0; j < nuevo.length; j++){
							var uno = nuevo[j].horaFre;
							var dos = nuevo[j].minutoFre;
							if(uno!==hor && dos!==min && nuevo[j].diasFrecue!==dia){
								otro.push(nuevo[j]);
							}
						}
						window.sessionStorage.setItem("Apagados",JSON.stringify(otro));
						
					}else{
						toastr.info('No posee programación apagado a eliminar');
					
					}
				}else{
					toastr.info('No es posible eliminar');
					
				}
			});
		}
		
		$("#E_apagado").click(function(){
			
			var selectList = document.createElement("select");
			selectList.id = "mySelect";
			
			var sens = JSON.parse(window.sessionStorage.getItem("Apagados"));
			for (var f =0; f < sens.length; f++){
				var option = document.createElement("option");
				option.value = sens[f].horaFre+":"+sens[f].minutoFre+":"+sens[f].diasFrecue;
				option.text = sens[f].horaFre+":"+sens[f].minutoFre;
				selectList.appendChild(option);
			}
			
			swal("Seleccione programado de apagado especifico a eliminar", {
			  content: selectList,
			}).then((value) => {
				var valor = $("#mySelect").select()[0].value.split(":");
				eliminarProgApagados(valor[0],valor[1],valor[2]);
			});
		});
		
		$("#C_encendido").click(function(){
			if ($("#frecuencia").val()!=="" && $("#horaFre").val()!=="" && $("#minutoFre").val()!=="" ){
				if ($("#frecuencia").val()=="2" && $("#diasFrecue").val()=="" && $("#relaySele").val()==""){
					swal("Error","Faltan seleccionar los datos","error");
				}else{
										
					if ($("#frecuencia").val()=="1"){ var mas = "nullo"; } else { var mas = $("#diasFrecue").val();  }
					
					var jues = JSON.parse(window.sessionStorage.getItem("Previsualizado"));
					
					if(window.sessionStorage.getItem("Encendidos")){
						var nuevo = JSON.parse(window.sessionStorage.getItem("Encendidos"));
						nuevo.push({"pass":jues.pass,"relay":$("#relaySele").val(),"telefono":jues.tel,"frecuencia":$("#frecuencia").val(),"diasFrecue":mas,"horaFre":$("#horaFre").val(),"minutoFre":$("#minutoFre").val()});
						window.sessionStorage.setItem("Encendidos",JSON.stringify(nuevo));
					}else{
						var nuevo = [{"pass":jues.pass,"relay":$("#relaySele").val(),"telefono":jues.tel,"frecuencia":$("#frecuencia").val(),"diasFrecue":mas,"horaFre":$("#horaFre").val(),"minutoFre":$("#minutoFre").val()}];
						window.sessionStorage.setItem("Encendidos",JSON.stringify(nuevo));
					}
					
					var auth = JSON.parse(window.sessionStorage.getItem("sesion"));
					var token = auth.t,email = auth.e;
					backend.query({"t":token,"e":email,"a":"addRelayConfigON","d":{"relay":$("#relaySele").val(),"pass":jues.pass,"telefono":jues.tel,"frecuencia":$("#frecuencia").val(),"diasFrecue":mas,"horaFre":$("#horaFre").val(),"minutoFre":$("#minutoFre").val()}},block.ip,"8088",function(salida){
						var agregado = JSON.parse(salida);
						var fin = JSON.parse(agregado.m);
						if (fin.m){
							
							$("#frecuencia").val("");
							$("#diasFrecue").val("");
							$("#horaFre").val("");
							$("#minutoFre").val("");
							toastr.info('Programado el relay para acción de encendido con éxito');
					
						}else{
							toastr.info('No es posible registrar');
							
						}
						
					});
					
				}
			}else{
				swal("Error","Faltan seleccionar los datos","error");
			}
		});
		
		$("#C_apagado").click(function(){
	
			if ($("#frecuenciaA").val()!=="" && $("#horaFreA").val()!=="" && $("#minutoFreA").val()!=="" ){
				if ($("#frecuenciaA").val()=="2" && $("#diasFrecueA").val()=="" && $("#relaySele2").val()==""){
					swal("Error","Faltan seleccionar los datos","error");
				}else{
										
					if ($("#frecuenciaA").val()=="1"){ var mas = "nullo"; } else { var mas = $("#diasFrecueA").val();  }
					
					var jues = JSON.parse(window.sessionStorage.getItem("Previsualizado"));
					
					if(window.sessionStorage.getItem("Apagados")){
						var nuevo = JSON.parse(window.sessionStorage.getItem("Apagados"));
						nuevo.push({"pass":jues.pass,"relay":$("#relaySele2").val(),"telefono":jues.tel,"frecuencia":$("#frecuenciaA").val(),"diasFrecue":mas,"horaFre":$("#horaFreA").val(),"minutoFre":$("#minutoFreA").val()});
						window.sessionStorage.setItem("Apagados",JSON.stringify(nuevo));
					}else{
						var nuevo = [{"pass":jues.pass,"relay":$("#relaySele2").val(),"telefono":jues.tel,"frecuencia":$("#frecuenciaA").val(),"diasFrecue":mas,"horaFre":$("#horaFreA").val(),"minutoFre":$("#minutoFreA").val()}];
						window.sessionStorage.setItem("Apagados",JSON.stringify(nuevo));
					}
					
					var auth = JSON.parse(window.sessionStorage.getItem("sesion"));
					var token = auth.t,email = auth.e;
					backend.query({"t":token,"e":email,"a":"addRelayConfigOFF","d":{"relay":$("#relaySele2").val(),"pass":jues.pass,"telefono":jues.tel,"frecuencia":$("#frecuenciaA").val(),"diasFrecue":mas,"horaFre":$("#horaFreA").val(),"minutoFre":$("#minutoFreA").val()}},block.ip,"8088",function(salida){
						var agregado = JSON.parse(salida);
						var fin = JSON.parse(agregado.m);
						if (fin.m){
							
							$("#frecuenciaA").val("");
							$("#diasFrecueA").val("");
							$("#horaFreA").val("");
							$("#minutoFreA").val("");
							toastr.info('Programado el relay para acción de apagado con éxito');
					
						}else{
							toastr.info('No es posible registrar');
							
						}
						
					});
					
				}
			}else{
				swal("Error","Faltan seleccionar los datos","error");
			}
			
		});
		
		$("#C_relaylis").click(function(){
		
			function asignarNumeric(nombre,fecha,telefono,nombreSensor,numer){
				var auth = JSON.parse(window.sessionStorage.getItem("sesion"));
				var token = auth.t,email = auth.e;
				backend.query({"t":token,"e":email,"a":"addRelay","d":{"ids":numer,"sensor":nombreSensor,"creado":fecha,"telefono":telefono,"nombreRelay":nombre}},block.ip,"8088",function(salida){
					var agregado = JSON.parse(salida);
					var fin = JSON.parse(agregado.m);
					if (fin.m){
					
						toastr.info('Relay agregado con éxito');
						
						if(window.sessionStorage.getItem("Relays")){
							var nuevo = JSON.parse(window.sessionStorage.getItem("Relays"));
							nuevo.push({"ids":numer,"sensor":nombreSensor,"creado":fecha,"telefono":telefono,"nombreRelay":nombre});
							window.sessionStorage.setItem("Relays",JSON.stringify(nuevo));
						}else{
							var nuevo = [{"ids":numer,"sensor":nombreSensor,"creado":fecha,"telefono":telefono,"nombreRelay":nombre}];
							window.sessionStorage.setItem("Relays",JSON.stringify(nuevo));
						}
				
					}else{
						toastr.info('No es posible registrar');
						
					}
					
				});
			}
			
			function nombreRelay(){
				swal("Inserte nombre de Relay:", {
				  content: "input",
				}).then((value) => {
					var req = /[a-zA-Z0-9]{1,50}/;
					if (value && req.test(value)){
						var creacion = moment().format('MMMM Do YYYY, h:mm:ss a');
						var visual = JSON.parse(window.sessionStorage.getItem("Previsualizado"));
						
						if (window.sessionStorage.getItem("Relays")){
							var nu = JSON.parse(window.sessionStorage.getItem("Relays")),
								num = nu.length;
						}else{
							var num = 0;
						}
						
						asignarNumeric(value,creacion,visual.tel,visual.nom,num);
					}else{
						toastr.info('Solo acepta de 50 caracteres alfanuméricos');
						nombreRelay();
					}
				});
			}
			
			nombreRelay();
			
		});
		
		$("#SeleccionRelay").click(function(){
			
			var selectList = document.createElement("select");
			selectList.id = "mySelect";
			
			for (var f =0; f < 4; f++){
				var option = document.createElement("option");
				option.value = f;
				option.text = "DOUT "+f;
				selectList.appendChild(option);
			}
			
			swal("Seleccione relay especifico", {
			  content: selectList,
			}).then((value) => {
			
				var valor = $("#mySelect").select()[0].value;
				
				var dataset2 = [];
				var sens = JSON.parse(window.sessionStorage.getItem("Encendidos"));
				for (var f =0; f <sens.length; f++){
					
					if (valor == sens[f].relay){
					
						if (sens[f].frecuencia=="1"){
							var fes = "Todos los dias";
						}else{
							var fes = "Especifico";
						}
						if (sens[f].diasFrecue=="nullo"){
							var diaso = "Fijo";
						}else if (sens[f].diasFrecue == "0"){
							var diaso = "Domingo";
						}else if (sens[f].diasFrecue == "1"){
							var diaso = "Lunes";
						}else if (sens[f].diasFrecue == "2"){
							var diaso = "Martes";
						}else if (sens[f].diasFrecue == "3"){
							var diaso = "Miercoles";
						}else if (sens[f].diasFrecue == "4"){
							var diaso = "Jueves";
						}else if (sens[f].diasFrecue == "5"){
							var diaso = "Viernes";
						}else if (sens[f].diasFrecue == "6"){
							var diaso = "Sabado";
						}
						
						var horat = sens[f].horaFre,
							minut = sens[f].minutoFre,
							teles = sens[f].telefono,
							relays = "Dout "+valor;
							
						dataset2.push([relays,teles,fes,diaso,horat,minut]);
						
					}
					
				}
				
				if (dataset2.length==0){
					dataset2.push(["No posee","No posee","No posee","No posee","No posee","No posee"]);
				}
				
				$('#TableEncendido').DataTable({
					columns: [
						{title: "Id"},
						{title: "Teléfono"},
						{title: "Frecuencia"},
						{title: "Día"},
						{title: "Hora"},
						{title: "Minuto"}
					],
					data: dataset2,
					pageLength: 20,
					responsive: true,
					dom: '<"html5buttons"B>lTfgitp',
					buttons: [
						{extend: 'csv'},
						{extend: 'excel', title: 'M2M_reporte_relays_encendidos'},
						{extend: 'pdf', title: 'M2M_reporte_relays_encendidos'},
						{extend: 'print',
							customize: function (win){
								$(win.document.body).addClass('white-bg');
								$(win.document.body).css('font-size', '10px');
								$(win.document.body).find('table').addClass('compact').css('font-size', 'inherit');
							}
						}
					]
				});
				
				var dataset3 = [];
				var sens2 = JSON.parse(window.sessionStorage.getItem("Apagados"));
				for (var f =0; f <sens2.length; f++){
				
					if (valor == sens[f].relay){
					
						if (sens2[f].frecuencia=="1"){
							var fes = "Todos los dias";
						}else{
							var fes = "Especifico";
						}
						if (sens2[f].diasFrecue=="nullo"){
							var diaso = "Fijo";
						}else if (sens2[f].diasFrecue == "0"){
							var diaso = "Domingo";
						}else if (sens2[f].diasFrecue == "1"){
							var diaso = "Lunes";
						}else if (sens2[f].diasFrecue == "2"){
							var diaso = "Martes";
						}else if (sens2[f].diasFrecue == "3"){
							var diaso = "Miercoles";
						}else if (sens2[f].diasFrecue == "4"){
							var diaso = "Jueves";
						}else if (sens2[f].diasFrecue == "5"){
							var diaso = "Viernes";
						}else if (sens2[f].diasFrecue == "6"){
							var diaso = "Sabado";
						}
						
						var horat = sens[f].horaFre,
							minut = sens[f].minutoFre,
							teles = sens[f].telefono,
							relays = "Dout "+valor;
							
						dataset3.push([relays,teles,fes,diaso,horat,minut]);
					}
				}
				
				if (dataset3.length==0){
					dataset3.push(["No posee","No posee","No posee","No posee","No posee","No posee"]);
				}
				
				$('#TableApagado').DataTable({
					columns: [
						{title: "Id"},
						{title: "Teléfono"},
						{title: "Frecuencia"},
						{title: "Día"},
						{title: "Hora"},
						{title: "Minuto"}
					],
					data: dataset3,
					pageLength: 20,
					responsive: true,
					dom: '<"html5buttons"B>lTfgitp',
					buttons: [
						{extend: 'csv'},
						{extend: 'excel', title: 'M2M_reporte_relays_apagados'},
						{extend: 'pdf', title: 'M2M_reporte_relays_apagados'},
						{extend: 'print',
							customize: function (win){
								$(win.document.body).addClass('white-bg');
								$(win.document.body).css('font-size', '10px');
								$(win.document.body).find('table').addClass('compact').css('font-size', 'inherit');
							}
						}
					]
				});
				
				$("#modalRelay").modal("hide");
				$("#relaysModalConfig").modal("show");
				
			});
			
		});
		
		$("#relaysModalConfig").on("hidden.bs.modal", function () {
			var table = $('#TableApagado').DataTable();
			table.destroy();
			
			var table2 = $('#TableEncendido').DataTable();
			table2.destroy();
		});
		
		$("#modalRelayhistorytrama").on("hidden.bs.modal", function () {
			var table = $('#TableRelayHistorytrama').DataTable();
			table.destroy();
		});
		
		$("#modaltemphistorytrama").on("hidden.bs.modal", function () {
			var table = $('#TableTempHistory').DataTable();
			table.destroy();
		});
		
		$("#C_relay").click(function(){
		
			$("#configModal").modal("hide");
			$("#modalRelay").modal("show");
			
			var dataset2 = [];
			dataset2.push(["1","DOUT"],["2","DOUT"],["3","DOUT"],["4","DOUT"]);
			
			$('#TableRelaysTodos').DataTable({
				columns: [
					{title: "Id"},
					{title: "Relay"}
				],
				data: dataset2,
				pageLength: 20,
				responsive: true,
				dom: '<"html5buttons"B>lTfgitp',
				buttons: [
					{extend: 'csv'},
					{extend: 'excel', title: 'M2M_reporte_relays_asignados'},
					{extend: 'pdf', title: 'M2M_reporte_relays_asignados'},
					{extend: 'print',
						customize: function (win){
							$(win.document.body).addClass('white-bg');
							$(win.document.body).css('font-size', '10px');
							$(win.document.body).find('table').addClass('compact').css('font-size', 'inherit');
						}
					}
				]
			});
		
			
		});
		
		$("#modalRelay").on("hidden.bs.modal", function () {
			var table = $('#TableRelaysTodos').DataTable();
			table.destroy();
		});
		
		var texti3='<option value=""></option>';
		for (var g = 0; g < 60; g++){
			if (g < 10) { v = "0"+g; }else { v = g; }
			texti3=texti3+'<option value="'+v+'">'+v+'</option>';
		}
		$("#minutoFre").html(texti3);
		$("#minutoFreA").html(texti3);
		
		var texti4='<option value=""></option>';
		for (var gc = 0; gc < 24; gc++){
			if (gc < 10) { v = "0"+gc; }else { v = gc; }
			texti4=texti4+'<option value="'+v+'">'+v+'</option>';
		}
		$("#horaFre").html(texti4);
		$("#horaFreA").html(texti4);
		
		var texti ='<option value=""></option><option value="1">Todos los dias</option><option value="2">Especifico</option>';
		$("#frecuencia").html(texti);
		
		var textiA ='<option value=""></option><option value="1">Todos los dias</option><option value="2">Especifico</option>';
		$("#frecuenciaA").html(textiA);
		
		var texti2 ='<option value=""></option><option value="0">Domingo</option><option value="1">Lunes</option><option value="2">Marte</option><option value="3">Miercoles</option><option value="4">Jueves</option><option value="5">Viernes</option><option value="6">Sabado</option>';
		$("#diasFrecue").html(texti2);
	
		var texti2A ='<option value=""></option><option value="0">Domingo</option><option value="1">Lunes</option><option value="2">Marte</option><option value="3">Miercoles</option><option value="4">Jueves</option><option value="5">Viernes</option><option value="6">Sabado</option>';
		$("#diasFrecueA").html(texti2A);
		
		$("#frecuencia").change(function(){
			if($("#frecuencia").val()=="1"){
				$("#diasFrecue" ).prop( "disabled", true );
			}else{
				$("#diasFrecue" ).prop( "disabled", false );
			}
		});
		
		$("#frecuenciaA").change(function(){
			if($("#frecuenciaA").val()=="1"){
				$("#diasFrecueA" ).prop( "disabled", true );
			}else{
				$("#diasFrecueA" ).prop( "disabled", false );
			}
		});
		
		function graf(elem){
			
			
			var textox = JSON.parse(window.sessionStorage.getItem("smsInbox")),agre = [];
			for (var d = 0; d < textox.length; d++){
				var nombre = textox[d].text;
				var sensor = nombre.substr(0,nombre.indexOf(" "));
				if(textox[d].number == elem.tel){
					if(textox[d].text.indexOf("AIN0")){
						agre.push("AIN0");
					}
					if(textox[d].text.indexOf("AIN1")){
						agre.push("AIN1");
					}
					if(textox[d].text.indexOf("AIN2")){
						agre.push("AIN2");
					}
					if(textox[d].text.indexOf("AIN3")){
						agre.push("AIN3");
					}
					if(textox[d].text.indexOf("AIN4")){
						agre.push("AIN4");
					}
					if(textox[d].text.indexOf("AIN5")){
						agre.push("AIN5");
					}
					if(textox[d].text.indexOf("AIN6")){
						agre.push("AIN6");
					}
					if(textox[d].text.indexOf("AIN7")){
						agre.push("AIN7");
					}
				}
			}
			var listao = Array.from(new Set(agre)),texti='<option value=""></option>';
			for (var g =0; g<listao.length; g++){
				texti=texti+'<option value="'+listao[g]+'">'+listao[g]+'</option>';
			}
			
			$("#modalGrafica").modal("show");
			
			$("#sens").html(texti);
			
			$("#sens").change(function(){
				var sensorS = $("#sens").val();
				var textox = JSON.parse(window.sessionStorage.getItem("smsInbox")),agre = [];
				for (var d = 0; d < textox.length; d++){
					var times = textox[d].time.split(" ");
						dats = times[0].split("/");
					if (textox[d].text.indexOf(sensorS)>-1){
						agre.push(dats[0]);
					}
				}
				var listao = Array.from(new Set(agre)),texti='<option value=""></option>';
				for (var g =0; g<listao.length; g++){
					texti=texti+'<option value="'+listao[g]+'">'+listao[g]+'</option>';
				}
				$("#anoslis").html(texti);
			});
		
			$("#anoslis").change(function(){
				var sensorS = $("#sens").val();
				var Anos = $("#anoslis").val();
				var textox = JSON.parse(window.sessionStorage.getItem("smsInbox")),agre = [];
				for (var d = 0; d < textox.length; d++){
					var times = textox[d].time.split(" ");
						dats = times[0].split("/");
					if (textox[d].text.indexOf(sensorS)>-1 && Anos == dats[0]){
						agre.push(dats[1]);
					}
				}
				var listao = Array.from(new Set(agre)),texti='<option value=""></option>';
				for (var g =0; g<listao.length; g++){
					texti=texti+'<option value="'+listao[g]+'">'+listao[g]+'</option>';
				}
				$("#meslis").html(texti);
			});
			
			$("#meslis").change(function(){
				var sensorS = $("#sens").val();
				var Anos = $("#anoslis").val();
				var Mes = $("#meslis").val();
				var textox = JSON.parse(window.sessionStorage.getItem("smsInbox")),agre = [];
				for (var d = 0; d < textox.length; d++){
					var times = textox[d].time.split(" ");
						dats = times[0].split("/");
					if (textox[d].text.indexOf(sensorS)>-1 && Anos == dats[0] && Mes == dats[1]){
						agre.push(dats[2]);
					}
				}
				var listao = Array.from(new Set(agre)),texti='<option value=""></option>';
				for (var g =0; g<listao.length; g++){
					texti=texti+'<option value="'+listao[g]+'">'+listao[g]+'</option>';
				}
				$("#diaslis").html(texti);
			});
			
			$("#diaslis").change(function(){
			
				var sensorS = $("#sens").val(),
					Anos = $("#anoslis").val(),
					Mes = $("#meslis").val(),
					Dia = $("#diaslis").val();
					
				var textox = JSON.parse(window.sessionStorage.getItem("smsInbox")),todo=[],tiempos=[],colores=[];
				for (var d = 0; d < textox.length; d++){
					var times = textox[d].time.split(" ");
						dats = times[0].split("/");
					if (textox[d].text.indexOf(sensorS)>-1 && Anos == dats[0] && Mes == dats[1] && Dia == dats[2]){
						
						
						String.prototype.replaceAll = function(search, replacement) {
							var target = this;return target.replace(new RegExp(search, 'g'), replacement);
						};

						var limpio = textox[d].text.replaceAll("\r","");
						var filtro = limpio.replaceAll("\n","");

						var tesx = filtro.split(";");
						for(var u=0; u < tesx.length; u++){
							var iten = tesx[u];
							if (iten.indexOf(sensorS)>-1){
								if (iten.indexOf(":")>-1){
									var nuea = iten.split(":");
									var valoes = nuea[1].split(",");
									todo.push(valoes[0]);
									tiempos.push(textox[d].time);
									colores.push("#1155cc");
								}else{
									var nuea = iten.split(" ");
									todo.push(nuea[3]);
									tiempos.push(textox[d].time);
									colores.push("#1155cc");
								}
							}
						}
						
					}
				}

				if( window.donus2s!==undefined){
					window.donus2s.destroy();
				}

				var doughnutOptionss = {
					responsive: true,
					title: {
						display: false
					}
				};
				var doughnutData2s = {
					labels: tiempos,
					datasets: [{
						label:"Datos de sensores via sms",
						data: todo,
						backgroundColor: colores
					}]
				};
				var ctxs = document.getElementById("doughnutChartDos").getContext("2d");
				window.donus2s = new Chart(ctxs, {type: 'bar', data: doughnutData2s, options:doughnutOptionss});
				
				window.donus2s.update();
			});
		
		}
		
		function graf2(elem){
			
			$("#modalGrafica2").modal("show");
			
			var textox = JSON.parse(window.sessionStorage.getItem("tramaInbox")),agre = [];
			for (var d = 0; d < textox.length; d++){
				if(textox[d].port == elem.port){
					if(textox[d].text.indexOf("Sensor*0")){
						agre.push("AIN0");
					}
					if(textox[d].text.indexOf("Sensor*1")){
						agre.push("AIN1");
					}
					if(textox[d].text.indexOf("Sensor*2")){
						agre.push("AIN2");
					}
					if(textox[d].text.indexOf("Sensor*3")){
						agre.push("AIN3");
					}
					if(textox[d].text.indexOf("Sensor*4")){
						agre.push("AIN4");
					}
					if(textox[d].text.indexOf("Sensor*5")){
						agre.push("AIN5");
					}
					if(textox[d].text.indexOf("Sensor*6")){
						agre.push("AIN6");
					}
					if(textox[d].text.indexOf("Sensor*7")){
						agre.push("AIN7");
					}
				}
			}
			var listao = Array.from(new Set(agre)),texti='<option value=""></option>';
			for (var g =0; g<listao.length; g++){
				texti=texti+'<option value="'+listao[g]+'">'+listao[g]+'</option>';
			}
			
			$("#sensD").html(texti);
			
			$("#sensD").change(function(){
				var textox = JSON.parse(window.sessionStorage.getItem("tramaInbox")),agre = [];
				for (var d = 0; d < textox.length; d++){
					var times = textox[d].time.split(" ");
						dats = times[0].split("/");
					var sensorS = $("#sensD").val();
					var inb = sensorS.split("AIN");
					if (textox[d].text.indexOf("Sensor*"+inb[1])>-1){
						agre.push(dats[2]);
					}
				}

				var listaw = Array.from(new Set(agre));
				var texti4='<option value=""></option>';
				for (var gc = 0; gc < listaw.length; gc++){
					texti4=texti4+'<option value="'+listaw[gc]+'">'+listaw[gc]+'</option>';
				}
				
				$("#anoslisD").html(texti4);
				
			});
			

			$("#anoslisD").change(function(){
				var sensorS = $("#sensD").val();
				var Anos = $("#anoslisD").val();
				var textox = JSON.parse(window.sessionStorage.getItem("tramaInbox")),agre = [];
				for (var d = 0; d < textox.length; d++){
					var times = textox[d].time.split(" ");
						dats = times[0].split("/");
					var inb = sensorS.split("AIN");
					if (textox[d].text.indexOf("Sensor*"+inb[1])>-1 && Anos == dats[2]){
						agre.push(dats[1]);
					}
				}
				var listao = Array.from(new Set(agre)),texti='<option value=""></option>';
				for (var g =0; g<listao.length; g++){
					texti=texti+'<option value="'+listao[g]+'">'+listao[g]+'</option>';
				}
				$("#meslisD").html(texti);
			});

			$("#meslisD").change(function(){
				var sensorS = $("#sensD").val();
				var Anos = $("#anoslisD").val();
				var Mes = $("#meslisD").val();
				var textox = JSON.parse(window.sessionStorage.getItem("tramaInbox")),agre = [];
				for (var d = 0; d < textox.length; d++){
					var times = textox[d].time.split(" ");
						dats = times[0].split("/");
					var inb = sensorS.split("AIN");
					if (textox[d].text.indexOf("Sensor*"+inb[1])>-1 && Anos == dats[2] && Mes == dats[1]){
						agre.push(dats[0]);
					}
				}
				var listao = Array.from(new Set(agre)),texti='<option value=""></option>';
				for (var g =0; g<listao.length; g++){
					texti=texti+'<option value="'+listao[g]+'">'+listao[g]+'</option>';
				}
				$("#diaslisD").html(texti);
			});

			$("#diaslisD").change(function(){

				var sensorS = $("#sensD").val(),
					Anos = $("#anoslisD").val(),
					Mes = $("#meslisD").val(),
					Dia = $("#diaslisD").val();

				var textox = JSON.parse(window.sessionStorage.getItem("tramaInbox")),todo=[],tiempos=[],colores=[];
				for (var d = 0; d < textox.length; d++){
					var times = textox[d].time.split(" ");
						dats = times[0].split("/");
					var inb = sensorS.split("AIN");
					if (textox[d].text.indexOf("Sensor*"+inb[1])>-1 && Anos == dats[2] && Mes == dats[1] && Dia == dats[0]){


						var tesx = JSON.parse(textox[d].text);
						for(var u=0; u < tesx.length; u++){
							var iten = tesx[u];
							if (iten.indexOf("Sensor*"+inb[1])>-1){
								var tes = iten.split("*");

								todo.push(tes[2]);
								tiempos.push(textox[d].time);
								colores.push("#1155cc");

							}
						}

					}
				}

				if( window.donus2!==undefined){
					window.donus2.destroy();
				}

				var doughnutOptions = {
					responsive: true,
					title: {
						display: false
					}
				};
				var doughnutData2 = {
					labels: tiempos,
					datasets: [{
						label:"Datos de ains via trama",
						data: todo,
						backgroundColor: colores
					}]
				};
				var ctx = document.getElementById("doughnutChartDos2").getContext("2d");
				window.donus2 = new Chart(ctx, {type: 'bar', data: doughnutData2, options:doughnutOptions});

				window.donus2.update();
			});

		}
		
		$("#graficaModal").click(function(){
			
			var lista = [],otros = [],extra =[];
			var ver = JSON.parse(window.sessionStorage.getItem("punteados"));
			for (var h = 0; h < ver.length; h++){
				lista.push(ver[h].nom);
				otros.push(h);
				extra.push(ver[h]);
			}
		
			var selectList = document.createElement("select");
			selectList.id = "mySelect";
			for (var i = 0; i < lista.length; i++) {
				var option = document.createElement("option");
				option.value = otros[i];
				option.text = lista[i];
				selectList.appendChild(option);
			}
			
			swal("Seleccione elemento especifico", {
			  content: selectList,
			}).then((value) => {
				var valor = $("#mySelect").select()[0].value;
				var reali = extra[valor];
				graf(reali);
				
			});
		});
		
		$("#graficaModal2").click(function(){
			
			var lista = [],otros = [],extra =[];
			var ver = JSON.parse(window.sessionStorage.getItem("punteados"));
			for (var h = 0; h < ver.length; h++){
				lista.push(ver[h].nom);
				otros.push(h);
				extra.push(ver[h]);
			}
		
			var selectList = document.createElement("select");
			selectList.id = "mySelect";
			for (var i = 0; i < lista.length; i++) {
				var option = document.createElement("option");
				option.value = otros[i];
				option.text = lista[i];
				selectList.appendChild(option);
			}
			
			swal("Seleccione elemento especifico", {
			  content: selectList,
			}).then((value) => {
				var valor = $("#mySelect").select()[0].value;
				var reali = extra[valor];
				graf2(reali);
			});
			
		});
		
		$("#equiposM").click(function(){
			$("#dash").css("display","block");
			$("#map").show();
			$("#grafica").hide();
		});
		
		$("#usersM").click(function(){
			$("#dash").css("display","block");
			$("#map").show();
			$("#grafica").hide();
		});
		
		$("#Eliminar_El").click(function(){
			var dat = JSON.parse(window.sessionStorage.getItem("Previsualizado"));
			eliminarPunteo(dat.tel);
		});
		
		function cambioEnsensor(cel,sensor,valor,pass){
			$("#AvanzadoConfigModal").modal("hide");
		}
		
		function envioSms(telefono,sms){
			var auth = JSON.parse(window.sessionStorage.getItem("sesion"));
			var token = auth.t,email = auth.e;
			var lis ={"cel":telefono,"mjs":sms};
			backend.query({"t":token,"e":email,"a":"EnviarSms","d":lis},block.ip,"8088",function(salida){
				var das = JSON.parse(salida);
				if (!das.e){
					toastr.info('Se envio el sms');
				}else{
					toastr.info('Ocurrio un problema con su conexión de red para el envio de sms');
				}
			});
		}
		
		
		function reooter(elem){
			var nume = elem.tel;
			var pass = elem.pass;
			var msj = pass+"Reboot";
			envioSms(nume,msj);
		}
		
		$("#reboot").click(function(){
		
			var lista = [],otros = [];
			var ver = JSON.parse(window.sessionStorage.getItem("punteados"));
			for (var h = 0; h < ver.length; h++){
				lista.push(ver[h].nom);
				otros.push(h);
			}
		
			var selectList = document.createElement("select");
			selectList.id = "mySelect";
			for (var i = 0; i < lista.length; i++) {
				var option = document.createElement("option");
				option.value = otros[i];
				option.text = lista[i];
				selectList.appendChild(option);
			}
			
			swal("Seleccione elemento especifico", {
			  content: selectList,
			}).then((value) => {
				var valor = ver[$("#mySelect").select()[0].value];
				reooter(valor);
			});
		});
		
		function tramaAin(elem){
			var mista = [];
			
			var nuevo = JSON.parse(window.sessionStorage.getItem("tramaInbox"));
			for (var j = 0; j < nuevo.length; j++){
				if(nuevo[j].text.length > 20){
					
					var portes = nuevo[j].port;
					var timesr = nuevo[j].time.split(" "),fecham = timesr[0].replace("2018","18"),hourm = timesr[1];

					var nombreE = "";
					var accion = JSON.parse(window.sessionStorage.getItem("punteados"));
					for (var m = 0; m < accion.length; m++){
						if(accion[m].port == elem.port){
							nombreE = accion[m].nom;
						}
					}
					
					if (portes == elem.port){
					
						var tods = JSON.parse(nuevo[j].text);
						for (var x = 0; x < tods.length; x++){
					
							if (tods[x].indexOf("Sensor")>-1){
							
								var info = tods[x].split("*"),
									sensor = info[1],
									valor = info[2];
								
								mista.push(["Ain"+sensor,valor,portes,fecham,hourm,nombreE]);
								
							}
							
						}
					
					}
				}
			}
		
			$("#tramaModalHistorial").modal("show");
			
			$('#TableTramax').DataTable({
				columns: [
					{title: "Sensor"},
					{title: "Valor"},
					{title: "Puerto"},
					{title: "Dia"},
					{title: "Hora"},
					{title: "Nombre"}
				],
				data: mista,
				pageLength: 100,
				responsive: true,
				dom: '<"html5buttons"B>lTfgitp',
				buttons: [
					{extend: 'csv'},
					{extend: 'excel', title: 'M2M_reporte_history'},
					{extend: 'pdf', title: 'M2M_reporte_history'},
					{extend: 'print',
						customize: function (win){
							$(win.document.body).addClass('white-bg');
							$(win.document.body).css('font-size', '10px');
							$(win.document.body).find('table').addClass('compact').css('font-size', 'inherit');
						}
					}
				]
			});
		
			
		}
		
		$("#tramahistorialM1").click(function(){
			var lista = [],otros = [];
			var ver = JSON.parse(window.sessionStorage.getItem("punteados"));
			for (var h = 0; h < ver.length; h++){
				lista.push(ver[h].nom);
				otros.push(h);
			}
		
			var selectList = document.createElement("select");
			selectList.id = "mySelect";
			for (var i = 0; i < lista.length; i++) {
				var option = document.createElement("option");
				option.value = otros[i];
				option.text = lista[i];
				selectList.appendChild(option);
			}
			
			swal("Seleccione elemento especifico", {
			  content: selectList,
			}).then((value) => {
				var valor = ver[$("#mySelect").select()[0].value];
				tramaAin(valor);
			});
		});
		
		
		$("#smshistorialM").click(function(){
		
			
			var dataSet = [];
			if(window.sessionStorage.getItem("smsInbox")){
				var nuevo = JSON.parse(window.sessionStorage.getItem("smsInbox"));
				for (var j = 0; j < nuevo.length; j++){
					if((nuevo[j].text.length > 20 || nuevo[j].text.indexOf("Humi")>-1) && (nuevo[j].text.indexOf("Humi")>-1 || nuevo[j].text.indexOf("AIN")>-1 || nuevo[j].text.indexOf("DO3")>-1 || nuevo[j].text.indexOf("DO2")>-1 || nuevo[j].text.indexOf("DO1")>-1 || nuevo[j].text.indexOf("DIN")>-1)){
						
						var nombre = nuevo[j].text;
						String.prototype.replaceAll = function(search, replacement) {
							var target = this;return target.replace(new RegExp(search, 'g'), replacement);
						};

						var limpio = nombre.replaceAll("\r","");
						var filtro = limpio.replaceAll("\n","");

						if (nombre.indexOf("AIN")>-1){
							var lista = filtro.split(";");
							for (var p = 0; p <lista.length; p++){
							
								if(lista[p]!=="" && lista[p].indexOf("AIN")>-1 && lista[p].indexOf("Empty")==-1 && lista[p].indexOf(":AIN")==-1){
									var todes = lista[p];
									var nomb = todes.split(":");
									var sens = nomb[0];
									if (nomb[1]!==undefined){
										var sens2 = nomb[1].split(",");
										var numeos ="*"+ nuevo[j].number.substr(-3);
										var timesr = nuevo[j].time.split(" "),fecham = timesr[0].replace("2018","18"),hourm = timesr[1];
										dataSet.push([numeos,sens,sens2[1],sens2[0],fecham +" "+ hourm]);
									}else{
										var sens2 = nomb[0].split(" ");
										var numeos ="*"+ nuevo[j].number.substr(-3);
										var timesr = nuevo[j].time.split(" "),fecham = timesr[0].replace("2018","18"),hourm = timesr[1];
										dataSet.push([numeos,sens2[0],sens2[1],sens2[3],fecham +" "+ hourm]);
									}
								}
								
							}
						}
						
						/*if (nombre.indexOf("DO")>-1){
							var lista = filtro.split(";");
							for (var p = 0; p <lista.length; p++){
							
								if(lista[p]!=="" && lista[p].indexOf("DO")>-1 && lista[p].indexOf("Empty")==-1){
									var todes = lista[p];
									var nomb = todes.split(":");
									var numeos ="*"+ nuevo[j].number.substr(-3);
									var timesr = nuevo[j].time.split(" "),fecham = timesr[0].replace("2018","18"),hourm = timesr[1].substr(0,5);
									
									//toastr.info(numeos+" "+nomb[0]+" ... "+nomb[1]+" "+fecham+" "+hourm);
									
									dataSet.push([numeos,nomb[0],"...",nomb[1],fecham +" "+ hourm]);
								}
							}
						}
						
						if (nombre.indexOf("DIN")>-1){
							var lista = filtro.split(";");
							for (var p = 0; p <lista.length; p++){
							
								if(lista[p]!=="" && lista[p].indexOf("DIM")>-1 && lista[p].indexOf("Empty")==-1 && lista[p].indexOf(":DIM")==-1){
									var todes = lista[p];
									var nomb = todes.split(":");
									var sens = nomb[0];
									var numeos ="*"+ nuevo[j].number.substr(-3);
									var timesr = nuevo[j].time.split(" "),fecham = timesr[0].replace("2018","18"),hourm = timesr[1].substr(0,5);
									
									//toastr.info(numeos+" "+sens+"  "+sens+" "+fecham+" "+ hourm);
									
									dataSet.push([numeos,sens,sens,"...",fecham +" "+ hourm]);
								}

							}
						}
						
						if (nombre.indexOf("Temp")>-1){
							var lista = filtro.split(";");
							for (var p = 0; p <lista.length; p++){
								if(lista[p]!=="" && lista[p].indexOf("Temp")>-1 && lista[p].indexOf("Empty")==-1){
									var todes = lista[p];
									var nomb = todes.split(":");
									var valr = nomb[1].split(",");
									var sens = nomb[0];
									var valor = valr[0];
									var status =valr[1];
									var numeos ="*"+ nuevo[j].number.substr(-3);
									var timesr = nuevo[j].time.split(" "),fecham = timesr[0].replace("2018","18"),hourm = timesr[1].substr(0,5);
									
									//toastr.info(numeos+" "+sens+"  "+status+" "+valor+" "+fecham+" "+ hourm);
									
									dataSet.push([numeos,sens,status,valor,fecham +" "+ hourm]);
								}
							
							}
						}
						
						if (nombre.indexOf("Humi")>-1){
							var lista = filtro.split(";");
							for (var p = 0; p <lista.length; p++){
								if(lista[p]!=="" && lista[p].indexOf("Humi")>-1 && lista[p].indexOf("Empty")==-1){
									var todes = lista[p];
									var nomb = todes.split(":");
									var valr = nomb[1].split(",");
									var sens = nomb[0];
									var valor = valr[0];
									var status =valr[1];
									var numeos ="*"+ nuevo[j].number.substr(-3);
									var timesr = nuevo[j].time.split(" "),fecham = timesr[0].replace("2018","18"),hourm = timesr[1].substr(0,5);
									
									//toastr.info(numeos+" "+sens+"  "+status+" "+valor+" "+fecham+" "+ hourm);
									
									dataSet.push([numeos,sens,status,valor,fecham +" "+ hourm]);
								}
								
							}
						}
						
						if (nombre.indexOf("Status")>-1){
							var lista = filtro.split(";");
							for (var p = 0; p <lista.length; p++){
								if(lista[p].indexOf("Status")>-1){
									var todes = lista[p];
									var nomb = todes.split(":");
									var numeos ="*"+ nuevo[j].number.substr(-3);
									var timesr = nuevo[j].time.split(" "),fecham = timesr[0].replace("2018","18"),hourm = timesr[1].substr(0,5);
									
									//toastr.info(numeos+" "+nomb[0]+" "+nomb[1]+" ... "+fecham+" "+ hourm);
									
									dataSet.push([numeos,nomb[0],nomb[1],"...",fecham +" "+ hourm]);
								}
							}
						}
						*/
												
					}
				}
			}else{
				dataSet.push(["No posee","No posee","No posee","No posee","No posee"]);
			}
			
			$('#TableSms').DataTable({
				columns: [
					{title: "Nº"},
					{title: "A"},
					{title: "E"},
					{title: "V"},
					{title: "Dia"}
				],
				data: dataSet,
				pageLength: 25,
				responsive: true,
				dom: '<"html5buttons"B>lTfgitp',
				buttons: [
					{extend: 'csv'},
					{extend: 'excel', title: 'M2M_reporte_sms'},
					{extend: 'pdf', title: 'M2M_reporte_sms'},
					{extend: 'print',
						customize: function (win){
							$(win.document.body).addClass('white-bg');
							$(win.document.body).css('font-size', '10px');
							$(win.document.body).find('table').addClass('compact').css('font-size', 'inherit');
						}
					}
				],
				fnRowCallback: function( nRow, aData, iDisplayIndex, iDisplayIndexFull ) {
					
					if (aData[3].indexOf("Lower")>-1 || aData[2].indexOf("Low")>-1){
						$(nRow).css({"background-color":"#4DAF2C"});
					}else if (aData[3].indexOf("Normal")>-1){
						$(nRow).css({"background-color":"#57bff7"});
					}else if(aData[3].indexOf("Higher")>-1 || aData[2].indexOf("High")>-1){
						$(nRow).css({"background-color":"#E74C3C"});
					}
					
				}
			});
			
			$("#smsModalHistorial").modal("show");
			
		});
		
		$("#smsModalHistorial").on("hidden.bs.modal", function () {
			var table = $('#TableSms').DataTable();
			table.destroy();
		});
		
		$("#tramaModalHistorial").on("hidden.bs.modal", function () {
			var table = $('#TableTramax').DataTable();
			table.destroy();
		});
		
		function configPunteo(data){
			
			window.sessionStorage.setItem("Previsualizado",JSON.stringify(data));
			
			$("#nomE").html(data.nom);
			$("#telE").html(data.tel);
			$("#logE").html(data.log);
			$("#latE").html(data.lat);

			//$("#configModal").modal("show");
			
			window.sessionStorage.setItem("visualTrama",data.port);
			
			cargarModalTrama();
			
		}
		
		function eliminarUser(emailborrar){
			var auth = JSON.parse(window.sessionStorage.getItem("sesion"));
			var token = auth.t,email = auth.e;
			backend.query({"t":token,"e":email,"a":"eliminarUser","d":{"email":emailborrar}},block.ip,"8088",function(salida){
				var das = JSON.parse(salida);
				if (!das.e){
					toastr.info('Se eliminó usuario');
					
				}else{
					toastr.info('Ocurrio un problema con su conexión de red');
				}
			});
		}
		
		function deleUser(){
			swal("Inserte email de usuario para ser eliminado:", {
			  content: "input",
			}).then((value) => {
				var req = /^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/;
				if (value && req.test(value)){
					eliminarUser(value);
				}else{
					toastr.info('Solo acepta de 328 caracteres con formato de correo');
					$("#D_Users").click();
				}
			});
		}
		
		function ejecucionTotal(correo,pass,username,rol){
			var auth = JSON.parse(window.sessionStorage.getItem("sesion"));
			var token = auth.t,email = auth.e;
			backend.query({"t":token,"e":email,"a":"CrearUser","d":{"email":correo,"passw0rd":pass,"name":username,"rol":rol}},block.ip,"8088",function(salida){
				var das = JSON.parse(salida);
				if (!das.e){
					toastr.info('Se ha creado el usuario');
					
				}else{
					toastr.info('Ocurrio un problema con su conexión de red o no es admin@root.com');
				}
			});
		}
		
		function perdir_rol(correo,pass,username){
			
			var lista = ["1","2"];
			var mon = ["Administrador","User"];
			var selectList = document.createElement("select");
			selectList.id = "mySelect";
			for (var i = 0; i < lista.length; i++) {
				var option = document.createElement("option");
				option.value = lista[i];
				option.text = mon[i];
				selectList.appendChild(option);
			}
			
			swal("Seleccione rol", {
			  content: selectList,
			}).then((value) => {
				var ele = $("#mySelect").select()[0].options.selectedIndex;
				var ejecu = lista[ele];
				ejecucionTotal(correo,pass,username,ejecu);
			});

		}
		
		function perdir_nombre(correo,pass){
			swal("Inserte nombre de usuario:", {
			  content: "input",
			}).then((value) => {
				var req = /[a-zA-Z0-9]{1,50}/;
				if (value && req.test(value)){
					perdir_rol(correo,pass,value);
				}else{
					toastr.info('Solo acepta de 50 caracteres alfanuméricos');
					perdir_nombre(correo,pass);
				}
			});
		}
		
		function pedir_pass(correo){
			swal("Inserte contraseña alfanumérica de 8 caractares:", {
			  content: "input",
			  attributes: {
				  placeholder: "Coloque contraseña",
				  type: "password",
			  }
			}).then((value) => {
				var req = /[a-zA-Z0-9]{1,8}/;
				if (value && req.test(value)){
					perdir_nombre(correo,value);
				}else{
					toastr.info('Solo acepta de 8 caracteres alfanuméricos');
					pedir_pass(correo);
				}
			});
		}
		
		function crearUs(){
			swal("Inserte email para crear usuario:", {
			  content: "input",
			}).then((value) => {
				var req = /^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/;
				if (value && req.test(value)){
					pedir_pass(value);
				}else{
					toastr.info('Error','Solo acepta de 328 caracteres con formato de correo');
					$("#C_Users").click();
				}
			});
		}
		
		$("#r_estado_relay").click(function(){
			var nues = JSON.parse(window.sessionStorage.getItem("EstadoRelay"));
			envioSms(nues[1],nues[0]);
			toastr.info('Enviando orden al servidor');
		});
		
		$("#usersManager").click(function(){
		
			swal("Operaciones de usuario que dispone?", {
			  buttons: {
				cancel: "Crear",
				catch: {
				  text: "Eliminar",
				  value: "catch",
				},
				defeat: {
					text: "Cancelado"
				},
			  },
			})
			.then((value) => {
			  switch (value) {
			 
				case "defeat":
				  break;
			 
				case "catch":
				  deleUser();
				  break;
			 
				default:
				  crearUs();
			  }
			});
		});
		
		function lectura(){
			
			/*var auth = JSON.parse(window.sessionStorage.getItem("sesion"));
			var token = auth.t,email = auth.e;
			backend.query({"t":token,"e":email,"a":"readSms"},block.ip,"8088",function(salida){
				var das = JSON.parse(salida);
				if (!das.e){
					var lista = JSON.parse(das.m);
					window.sessionStorage.setItem("smsInbox",JSON.stringify(lista.m));
					
					if (window.sessionStorage.getItem("iniciaTable2")){
						var table = $('#TableSms').DataTable();
						table.destroy();	
						window.sessionStorage.removeItem("iniciaTable2");
					}
				}
			});
			*/
			
			var auth = JSON.parse(window.sessionStorage.getItem("sesion"));
			var token = auth.t,email = auth.e;
			backend.query({"t":token,"e":email,"a":"readHistory24"},block.ip,"8088",function(salida2){
				var das = JSON.parse(salida2);
				if (!das.e){
					var lista = JSON.parse(das.m);
					window.sessionStorage.setItem("tramaInbox",JSON.stringify(lista.m));
					
					/*if (window.sessionStorage.getItem("iniciaTable3")){
						var table = $('#TableTramax').DataTable();
						table.destroy();	
						window.sessionStorage.removeItem("iniciaTable3");
					}*/
				}
			});
			
		}
		
		lectura();
		
		function updateBd(icon,nombre){
			var edi = {"ico":icon,"nom":nombre};
			var auth = JSON.parse(window.sessionStorage.getItem("sesion"));
			var token = auth.t,email = auth.e;
			backend.query({"t":token,"e":email,"a":"updateIcon","d":edi},block.ip,"8088",function(salida){
				var das = JSON.parse(salida);
				if (!das.e){
					toastr.info('Actualizado en base de datos ');
					
				}
			});
		}
		
		function tiempoReal(){
		
			if (window.sessionStorage.getItem("Previsualizado")){
			
				var visual = JSON.parse(window.sessionStorage.getItem("Previsualizado"));
				var numero2 = visual.tel.replace("+","");
				var numero = numero2.replace(" ","");
				
				
				//******************************************** Dout
				
				if (window.sessionStorage.getItem("Graf_dout_v_DOUT0_"+numero)){
					var dout0V = JSON.parse(window.sessionStorage.getItem("Graf_dout_v_DOUT0_"+numero));
					var dout0F = JSON.parse(window.sessionStorage.getItem("Graf_dout_f_DOUT0_"+numero));
				}else{
					var dout0V = [];
					var dout0F = [];
				}
				
				if (window.sessionStorage.getItem("Graf_dout_v_DOUT1_"+numero)){
					var dout1V = JSON.parse(window.sessionStorage.getItem("Graf_dout_v_DOUT1_"+numero));
					var dout1F = JSON.parse(window.sessionStorage.getItem("Graf_dout_f_DOUT1_"+numero));
				}else{
					var dout1V = [];
					var dout1F = [];
				}
				
				if (window.sessionStorage.getItem("Graf_dout_v_DOUT2_"+numero)){
					var dout2V = JSON.parse(window.sessionStorage.getItem("Graf_dout_v_DOUT2_"+numero));
					var dout2F = JSON.parse(window.sessionStorage.getItem("Graf_dout_f_DOUT2_"+numero));
				}else{
					var dout2V = [];
					var dout2F = [];
				}
				
				if (window.sessionStorage.getItem("Graf_dout_v_DOUT3_"+numero)){
					var dout3V = JSON.parse(window.sessionStorage.getItem("Graf_dout_v_DOUT3_"+numero));
					var dout3F = JSON.parse(window.sessionStorage.getItem("Graf_dout_f_DOUT3_"+numero));
				}else{
					var dout3V = [];
					var dout3F = [];
				}
				
				if(window.myLineTemp2){
					window.myLineTemp2.destroy();
				}
				
				if (dout0V.length==0 && dout1V.length==0 && dout2V.length==0 && dout3V.length==0){
					var canvas = document.getElementById("realdout");
					var ctx = canvas.getContext("2d");
					ctx.font = "bold 22px sans-serif";
					ctx.fillText("Sin datos para graficar ",20,70);
				}else{
				
					var listColor = ["#e696b1","#705ad4","#71c366",
								 "#e2a339","#ec6654","#d698ad",
								 "#7c5894","#7a70a7"];
				
					var datisDout = [];
					datisDout.push({"label":"Dout0","backgroundColor":listColor[0],"fill":false,"data":dout0V});
					datisDout.push({"label":"Dout1","backgroundColor":listColor[1],"fill":false,"data":dout1V});
					datisDout.push({"label":"Dout2","backgroundColor":listColor[2],"fill":false,"data":dout2V});
					datisDout.push({"label":"Dout3","backgroundColor":listColor[3],"fill":false,"data":dout3V});
					
					var lineChartDataD = {
						labels: dout0F,
						datasets: datisDout
					};
					
					var ctx = document.getElementById('realdout').getContext('2d');
					window.myLineTemp2 = Chart.Line(ctx, {
						data: lineChartDataD,
						options: {
							responsive: true,
							hoverMode: 'index',
							stacked: false,
							title: {
								display: false
							},
							scales: {
								yAxes: [{
									type: 'linear',
									display: true,
									position: 'left',
									id: 'y-axis-1',
								}, {
									type: 'linear',
									display: true,
									position: 'right',
									id: 'y-axis-2',
									gridLines: {
										drawOnChartArea: false,
									},
								}],
							}
						}
					});
					
				}
				
				
				//******************************************** temp
				
				if(window.sessionStorage.getItem("Graf_temp_v_"+numero)){
					var tempV = JSON.parse(window.sessionStorage.getItem("Graf_temp_v_"+numero));
					var tempF = JSON.parse(window.sessionStorage.getItem("Graf_temp_f_"+numero));
				}else{
					var tempV = [];
					var tempF = [];
				}
								
				if(window.sessionStorage.getItem("Graf_hume_v_"+numero)){
					var humeV = JSON.parse(window.sessionStorage.getItem("Graf_hume_v_"+numero));
					var humeF = JSON.parse(window.sessionStorage.getItem("Graf_hume_f_"+numero));
				}else{
					var humeV = [];
					var humeF = [];
				}
				
				if (window.sessionStorage.getItem("Graf_ain_v_AIN0_"+numero)){
					var ain0V = JSON.parse(window.sessionStorage.getItem("Graf_ain_v_AIN0_"+numero));
					var ain0F = JSON.parse(window.sessionStorage.getItem("Graf_ain_f_AIN0_"+numero));
				}else{
					var ain0V = [];
					var ain0F = [];
				}
				
				if (window.sessionStorage.getItem("Graf_ain_v_AIN1_"+numero)){
					var ain1V = JSON.parse(window.sessionStorage.getItem("Graf_ain_v_AIN1_"+numero));
					var ain1F = JSON.parse(window.sessionStorage.getItem("Graf_ain_f_AIN1_"+numero));
				}else{
					var ain1V = [];
					var ain1F = [];
				}
				
				if (window.sessionStorage.getItem("Graf_ain_v_AIN2_"+numero)){
					var ain2V = JSON.parse(window.sessionStorage.getItem("Graf_ain_v_AIN2_"+numero));
					var ain2F = JSON.parse(window.sessionStorage.getItem("Graf_ain_f_AIN2_"+numero));
				}else{
					var ain2V = [];
					var ain2F = [];
				}
				
				if (window.sessionStorage.getItem("Graf_ain_v_AIN3_"+numero)){
					var ain3V = JSON.parse(window.sessionStorage.getItem("Graf_ain_v_AIN3_"+numero));
					var ain3F = JSON.parse(window.sessionStorage.getItem("Graf_ain_f_AIN3_"+numero));
				}else{
					var ain3V = [];
					var ain3F = [];
				}
				
				if (window.sessionStorage.getItem("Graf_ain_v_AIN4_"+numero)){
					var ain4V = JSON.parse(window.sessionStorage.getItem("Graf_ain_v_AIN4_"+numero));
					var ain4F = JSON.parse(window.sessionStorage.getItem("Graf_ain_f_AIN4_"+numero));
				}else{
					var ain4V = [];
					var ain4F = [];
				}
				
				if (window.sessionStorage.getItem("Graf_ain_v_AIN5_"+numero)){
					var ain5V = JSON.parse(window.sessionStorage.getItem("Graf_ain_v_AIN5_"+numero));
					var ain5F = JSON.parse(window.sessionStorage.getItem("Graf_ain_f_AIN5_"+numero));
				}else{
					var ain5V = [];
					var ain5F = [];
				}
				
				if (window.sessionStorage.getItem("Graf_ain_v_AIN6_"+numero)){
					var ain6V = JSON.parse(window.sessionStorage.getItem("Graf_ain_v_AIN6_"+numero));
					var ain6F = JSON.parse(window.sessionStorage.getItem("Graf_ain_f_AIN6_"+numero));
				}else{
					var ain6V = [];
					var ain6F = [];
				}
				
				if (window.sessionStorage.getItem("Graf_ain_v_AIN7_"+numero)){
					var ain7V = JSON.parse(window.sessionStorage.getItem("Graf_ain_v_AIN7_"+numero));
					var ain7F = JSON.parse(window.sessionStorage.getItem("Graf_ain_f_AIN7_"+numero));
				}else{
					var ain7V = [];
					var ain7F = [];
				}
				
				if (window.sessionStorage.getItem("Graf_din_v_DIN0_"+numero)){
					var din0V = JSON.parse(window.sessionStorage.getItem("Graf_din_v_DIN0_"+numero));
					var din0F = JSON.parse(window.sessionStorage.getItem("Graf_din_f_DIN0_"+numero));
				}else{
					var din0V = [];
					var din0F = [];
				}
				
				if(window.sessionStorage.getItem("Graf_din_v_DIN1_"+numero)){
					var din1V = JSON.parse(window.sessionStorage.getItem("Graf_din_v_DIN1_"+numero));
					var din1F = JSON.parse(window.sessionStorage.getItem("Graf_din_f_DIN1_"+numero));
				}else{
					var din1V = [];
					var din1F = [];
				}
				
				if (window.sessionStorage.getItem("Graf_din_v_DIN2_"+numero)){
					var din2V = JSON.parse(window.sessionStorage.getItem("Graf_din_v_DIN2_"+numero));
					var din2F = JSON.parse(window.sessionStorage.getItem("Graf_din_f_DIN2_"+numero));
				}else{
					var din2V = [];
					var din2F = [];
				}
				
				if (window.sessionStorage.getItem("Graf_din_v_DIN3_"+numero)){
					var din3V = JSON.parse(window.sessionStorage.getItem("Graf_din_v_DIN3_"+numero));
					var din3F = JSON.parse(window.sessionStorage.getItem("Graf_din_f_DIN3_"+numero));
				}else{
					var din3V = [];
					var din3F = [];
				}
				
				if(window.sessionStorage.getItem("Graf_din_v_DIN4_"+numero)){
					var din4V = JSON.parse(window.sessionStorage.getItem("Graf_din_v_DIN4_"+numero));
					var din4F = JSON.parse(window.sessionStorage.getItem("Graf_din_f_DIN4_"+numero));
				}else{
					var din4V = [];
					var din4F = [];
				}
				
				if (window.sessionStorage.getItem("Graf_din_v_DIN5_"+numero)){
					var din5V = JSON.parse(window.sessionStorage.getItem("Graf_din_v_DIN5_"+numero));
					var din5F = JSON.parse(window.sessionStorage.getItem("Graf_din_f_DIN5_"+numero));
				}else{
					var din5V = [];
					var din5F = [];
				}
				
				if (window.sessionStorage.getItem("Graf_din_v_DIN6_"+numero)){
					var din6V = JSON.parse(window.sessionStorage.getItem("Graf_din_v_DIN6_"+numero));
					var din6F = JSON.parse(window.sessionStorage.getItem("Graf_din_f_DIN6_"+numero));
				}else{
					var din6V = [];
					var din6F = [];
				}
				
				if (window.sessionStorage.getItem("Graf_din_v_DIN7_"+numero)){
					var din7V = JSON.parse(window.sessionStorage.getItem("Graf_din_v_DIN7_"+numero));
					var din7F = JSON.parse(window.sessionStorage.getItem("Graf_din_f_DIN7_"+numero));
				}else{
					var din7V = [];
					var din7F = [];
				}
				
				//******************************************** Temperatura
				
				
				if(window.myLineTemp){
					window.myLineTemp.destroy();
				}
				
				if (tempV.length==0){
					var canvas = document.getElementById("realtemp");
					var ctx = canvas.getContext("2d");
					ctx.font = "bold 22px sans-serif";
					ctx.fillText("Sin datos para graficar ",20,70);
				}else{
				
					var listColor = ["#e696b1","#705ad4","#71c366",
								 "#e2a339","#ec6654","#d698ad",
								 "#7c5894","#7a70a7"];
								 
					var datisTEMP = [];
					datisTEMP.push({"label":"Temperatura","backgroundColor":listColor[0],"fill":false,"data":tempV});
					
					var lineChartData = {
						labels: tempF,
						datasets: datisTEMP
					};
					
					var ctx = document.getElementById('realtemp').getContext('2d');
					window.myLineTemp = Chart.Line(ctx, {
						data: lineChartData,
						options: {
							responsive: true,
							hoverMode: 'index',
							stacked: false,
							title: {
								display: false
							},
							scales: {
								yAxes: [{
									type: 'linear',
									display: true,
									position: 'left',
									id: 'y-axis-1',
								}, {
									type: 'linear',
									display: true,
									position: 'right',
									id: 'y-axis-2',
									gridLines: {
										drawOnChartArea: false,
									},
								}],
							}
						}
					});
					
				}
				
				
				//******************************************** Humedad
				
				if(window.myLineHumedad){
					window.myLineHumedad.destroy();
				}
				
				if (humeV.length==0){
					
					var canvas = document.getElementById("realhumedy");
					var ctx = canvas.getContext("2d");
					ctx.font = "bold 22px sans-serif";
					ctx.fillText("Sin datos para graficar ",20,70);
					
				}else{
				
					var listColor = ["#e696b1","#705ad4","#71c366",
								 "#e2a339","#ec6654","#d698ad",
								 "#7c5894","#7a70a7"];
				
					var datisHUME = [];
					datisHUME.push({"label":"Humedad","backgroundColor":listColor[1],"fill":false,"data":humeV});
					
					var lineChartData2 = {
						labels: humeF,
						datasets: datisHUME
					};
					
					var ctx = document.getElementById('realhumedy').getContext('2d');
					window.myLineHumedad = Chart.Line(ctx, {
						data: lineChartData2,
						options: {
							responsive: true,
							hoverMode: 'index',
							stacked: false,
							title: {
								display: false
							},
							scales: {
								yAxes: [{
									type: 'linear',
									display: true,
									position: 'left',
									id: 'y-axis-1',
								}, {
									type: 'linear',
									display: true,
									position: 'right',
									id: 'y-axis-2',
									gridLines: {
										drawOnChartArea: false,
									},
								}],
							}
						}
					});
					
					
				}
				//******************************************** Ains
				
				if(window.myLineAins){
					window.myLineAins.destroy();
				}
				
				if (ain1V.length==0 && ain2V.length==0 && ain3V.length==0 && ain4V.length==0 && ain5V.length==0 && ain6V.length==0 && ain7V.length==0){
					
					var canvas = document.getElementById("realtime");
					var ctx = canvas.getContext("2d");
					ctx.font = "bold 22px sans-serif";
					ctx.fillText("Sin datos para graficar ",20,70);
					
				}else{
				
					var listColor = ["#e696b1","#705ad4","#71c366",
								 "#e2a339","#ec6654","#d698ad",
								 "#7c5894","#7a70a7"];
					
					var datisAINS = [];
					datisAINS.push({"label":"Ain0","backgroundColor":listColor[0],"fill":false,"data":ain0V});
					datisAINS.push({"label":"Ain1","backgroundColor":listColor[1],"fill":false,"data":ain1V});
					datisAINS.push({"label":"Ain2","backgroundColor":listColor[2],"fill":false,"data":ain2V});
					datisAINS.push({"label":"Ain3","backgroundColor":listColor[3],"fill":false,"data":ain3V});
					datisAINS.push({"label":"Ain4","backgroundColor":listColor[4],"fill":false,"data":ain4V});
					datisAINS.push({"label":"Ain5","backgroundColor":listColor[5],"fill":false,"data":ain5V});
					datisAINS.push({"label":"Ain6","backgroundColor":listColor[6],"fill":false,"data":ain6V});
					datisAINS.push({"label":"Ain7","backgroundColor":listColor[7],"fill":false,"data":ain7V});
					
					var lineChartData3 = {
						labels: ain0F,
						datasets: datisAINS
					};
				
				
					var ctx = document.getElementById('realtime').getContext('2d');
					window.myLineAins = Chart.Line(ctx, {
						data: lineChartData3,
						options: {
							responsive: true,
							hoverMode: 'index',
							stacked: false,
							title: {
								display: false
							},
							scales: {
								yAxes: [{
									type: 'linear',
									display: true,
									position: 'left',
									id: 'y-axis-1',
								}, {
									type: 'linear',
									display: true,
									position: 'right',
									id: 'y-axis-2',
									gridLines: {
										drawOnChartArea: false,
									},
								}],
							}
						}
					});
					
					
				}
				//****************************************** Din
				
				if(window.myLineDins){
					window.myLineDins.destroy();
				}
				
				if (din1V.length==0 && din2V.length==0 && din3V.length==0 && din4V.length==0 && din5V.length==0 && din6V.length==0 && din7V.length==0){
					
					var canvas = document.getElementById("realtDin");
					var ctx = canvas.getContext("2d");
					ctx.font = "bold 22px sans-serif";
					ctx.fillText("Sin datos para graficar ",20,70);
					
				}else{
				
					var listColor = ["#e696b1","#705ad4","#71c366",
								 "#e2a339","#ec6654","#d698ad",
								 "#7c5894","#7a70a7"];
				
					var datisDINS = [];
					datisDINS.push({"label":"Din0","backgroundColor":listColor[0],"fill":false,"data":din0V});
					datisDINS.push({"label":"Din1","backgroundColor":listColor[1],"fill":false,"data":din1V});
					datisDINS.push({"label":"Din2","backgroundColor":listColor[2],"fill":false,"data":din2V});
					datisDINS.push({"label":"Din3","backgroundColor":listColor[3],"fill":false,"data":din3V});
					datisDINS.push({"label":"Din4","backgroundColor":listColor[4],"fill":false,"data":din4V});
					datisDINS.push({"label":"Din5","backgroundColor":listColor[5],"fill":false,"data":din5V});
					datisDINS.push({"label":"Din6","backgroundColor":listColor[6],"fill":false,"data":din6V});
					datisDINS.push({"label":"Din7","backgroundColor":listColor[7],"fill":false,"data":din7V});
					
					var lineChartData4 = {
						labels: din0F,
						datasets: datisDINS
					};
					
					var ctx = document.getElementById('realtDin').getContext('2d');
					window.myLineDins = Chart.Line(ctx, {
						data: lineChartData4,
						options: {
							responsive: true,
							hoverMode: 'index',
							stacked: false,
							title: {
								display: false
							},
							scales: {
								yAxes: [{
									type: 'linear',
									display: true,
									position: 'left',
									id: 'y-axis-1',
								}, {
									type: 'linear',
									display: true,
									position: 'right',
									id: 'y-axis-2',
									gridLines: {
										drawOnChartArea: false,
									},
								}],
							}
						}
					});
					
				}
			}
		
		}
		
		function tiempoRealTrama(){
			
			if (window.sessionStorage.getItem("visualTrama")){
					
				if(window.lineIncred){
					window.lineIncred.destroy();
				}
				
				var sen0 = window.sessionStorage.getItem("sUk0"+window.sessionStorage.getItem("visualTrama")),
					sen1 = window.sessionStorage.getItem("sUk1"+window.sessionStorage.getItem("visualTrama")),
					sen2 = window.sessionStorage.getItem("sUk2"+window.sessionStorage.getItem("visualTrama")),
					sen3 = window.sessionStorage.getItem("sUk3"+window.sessionStorage.getItem("visualTrama")),
					sen4 = window.sessionStorage.getItem("sUk4"+window.sessionStorage.getItem("visualTrama")),
					sen5 = window.sessionStorage.getItem("sUk5"+window.sessionStorage.getItem("visualTrama")),
					sen6 = window.sessionStorage.getItem("sUk6"+window.sessionStorage.getItem("visualTrama")),
					sen7 = window.sessionStorage.getItem("sUk7"+window.sessionStorage.getItem("visualTrama"));
					
				if (sen0==null){ sen0 = 0; }
				if (sen1==null){ sen1 = 0; }
				if (sen2==null){ sen2 = 0; }
				if (sen3==null){ sen3 = 0; }
				if (sen4==null){ sen4 = 0; }
				if (sen5==null){ sen5 = 0; }
				if (sen6==null){ sen6 = 0; }
				if (sen7==null){ sen7 = 0; }
				
				var sen0old = window.sessionStorage.getItem("sUkOLD0"+window.sessionStorage.getItem("visualTrama")),
					sen1old = window.sessionStorage.getItem("sUkOLD1"+window.sessionStorage.getItem("visualTrama")),
					sen2old = window.sessionStorage.getItem("sUkOLD2"+window.sessionStorage.getItem("visualTrama")),
					sen3old = window.sessionStorage.getItem("sUkOLD3"+window.sessionStorage.getItem("visualTrama")),
					sen4old = window.sessionStorage.getItem("sUkOLD4"+window.sessionStorage.getItem("visualTrama")),
					sen5old = window.sessionStorage.getItem("sUkOLD5"+window.sessionStorage.getItem("visualTrama")),
					sen6old = window.sessionStorage.getItem("sUkOLD6"+window.sessionStorage.getItem("visualTrama")),
					sen7old = window.sessionStorage.getItem("sUkOLD7"+window.sessionStorage.getItem("visualTrama"));
				
				if (sen0old==null){ sen0old = 0; }
				if (sen1old==null){ sen1old = 0; }
				if (sen2old==null){ sen2old = 0; }
				if (sen3old==null){ sen3old = 0; }
				if (sen4old==null){ sen4old = 0; }
				if (sen5old==null){ sen5old = 0; }
				if (sen6old==null){ sen6old = 0; }
				if (sen7old==null){ sen7old = 0; }
				
				var f1 = window.sessionStorage.getItem("FsUk"+window.sessionStorage.getItem("visualTrama"));
				var f2 = window.sessionStorage.getItem("FsUkOLD"+window.sessionStorage.getItem("visualTrama"));
				
				if (f1 == null){ f1 = "" };
				if (f2 == null){ f2 = "" };
				
					var lineData = {
					labels: ["Ultima trama "+f1,"Vieja trama "+f2],
					datasets: [
						{
							label: "AIN 0",
							backgroundColor: 'rgba(237,85,51,0.5)',
							borderColor: "rgba(237,85,51,0.7)",
							pointBackgroundColor: "rgba(237,85,51,1)",
							pointBorderColor: "#fff",
							data: [sen0,sen0old]
						},{
							label: "AIN 1",
							backgroundColor: 'rgba(153,50,237,0.5)',
							borderColor: "rgba(153,50,237,0.7)",
							pointBackgroundColor: "rgba(153,50,237,1)",
							pointBorderColor: "#fff",
							data: [sen1,sen1old]
						},{
							label: "AIN 2",
							backgroundColor: 'rgba(226,206,20,0.5)',
							borderColor: "rgba(226,206,20,0.7)",
							pointBackgroundColor: "rgba(226,206,20,1)",
							pointBorderColor: "#fff",
							data: [sen2,sen2old]
						},{
							label: "AIN 3",
							backgroundColor: 'rgba(76,175,80,0.5)',
							borderColor: "rgba(76,175,80,0.7)",
							pointBackgroundColor: "rgba(76,175,80,1)",
							pointBorderColor: "#fff",
							data: [sen3,sen3old]
						},{
							label: "AIN 4",
							backgroundColor: 'rgba(176,39,80,0.5)',
							borderColor: "rgba(176,39,80,0.7)",
							pointBackgroundColor: "rgba(176,39,80,1)",
							pointBorderColor: "#fff",
							data: [sen4,sen4old]
						},{
							label: "AIN 5",
							backgroundColor: 'rgba(26,100,148,0.5)',
							borderColor: "rgba(26,100,148,0.7)",
							pointBackgroundColor: "rgba(26,100,148,1)",
							pointBorderColor: "#fff",
							data: [sen5,sen5old]
						},{
							label: "AIN 6",
							backgroundColor: 'rgba(76,175,80,0.5)',
							borderColor: "rgba(76,175,80,0.7)",
							pointBackgroundColor: "rgba(76,175,80,1)",
							pointBorderColor: "#fff",
							data: [sen6,sen6old]
						},{
							label: "AIN 7",
							backgroundColor: 'rgba(249,135,105,0.5)',
							borderColor: "rgba(249,135,105,0.7)",
							pointBackgroundColor: "rgba(249,135,105,1)",
							pointBorderColor: "#fff",
							data: [sen7,sen7old]
						}
					]
				};

				var lineOptions = {
					responsive: true
				};


				function isMobile() {
				   return (/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) );
				}
				
				var ctx = document.getElementById("lineChart").getContext("2d");
				
				if (isMobile()) {
					window.lineIncred = new Chart(ctx, {type: 'line', data: lineData, options:lineOptions});
				}else{
					window.lineIncred = new Chart(ctx, {type: 'bar', data: lineData, options:lineOptions});
				}
				
				window.lineIncred.update();

				var data0 = JSON.parse(window.sessionStorage.getItem("sensor0"+window.sessionStorage.getItem("visualTrama"))),
					data1 = JSON.parse(window.sessionStorage.getItem("sensor1"+window.sessionStorage.getItem("visualTrama"))),
					data2 = JSON.parse(window.sessionStorage.getItem("sensor2"+window.sessionStorage.getItem("visualTrama"))),
					data3 = JSON.parse(window.sessionStorage.getItem("sensor3"+window.sessionStorage.getItem("visualTrama"))),
					data4 = JSON.parse(window.sessionStorage.getItem("sensor4"+window.sessionStorage.getItem("visualTrama"))),
					data5 = JSON.parse(window.sessionStorage.getItem("sensor5"+window.sessionStorage.getItem("visualTrama"))),
					data6 = JSON.parse(window.sessionStorage.getItem("sensor6"+window.sessionStorage.getItem("visualTrama"))),
					data7 = JSON.parse(window.sessionStorage.getItem("sensor7"+window.sessionStorage.getItem("visualTrama")));
				
				if (data0==null){
					data0 = 0;
				}
				if (data1==null){
					data1 = 0;
				}
				if (data2==null){
					data2 = 0;
				}
				if (data3==null){
					data3 = 0;
				}
				if (data4==null){
					data4 = 0;
				}
				if (data5==null){
					data5 = 0;
				}
				if (data6==null){
					data6 = 0;
				}
				if (data7==null){
					data7 = 0;
				}
				
				$("#flot-dashboard5-chart").length && $.plot($("#flot-dashboard5-chart"), [ data0, data1,  data2, data3 , data4, data5, data6, data7],
					{
						series: {
							lines: {
								show: false,
								fill: true
							},
							splines: {
								show: true,
								tension: 0.4,
								lineWidth: 1,
								fill: 0.4
							},
							points: {
								radius: 0,
								show: true
							},
							shadowSize: 2
						},
						grid: {
							hoverable: true,
							clickable: true,
							borderWidth: 2,
							color: 'transparent'
						},
						colors: ["#ed553380", "#9932ed80", "#e2ce1480", "#4caf5080", "#b027508f", "#1a649480", "#4caf5080", "#f98769ed"],
						xaxis:{},
						yaxis:{},
						tooltip: false
					}
				);
				
				
				//**************************************************************** temperatura
				
				if(window.lineIncred2){
					window.lineIncred2.destroy();
				}
				
				var temp0 = window.sessionStorage.getItem("tUk1"+window.sessionStorage.getItem("visualTrama"));
					
				if (temp0==null){ temp0 = 0; }
				
				var temp0old = window.sessionStorage.getItem("tUkOLD1"+window.sessionStorage.getItem("visualTrama"));
				
				if (temp0old==null){ temp0old = 0; }
				
				var f1 = window.sessionStorage.getItem("FtUk"+window.sessionStorage.getItem("visualTrama"));
				var f2 = window.sessionStorage.getItem("FtUkOLD"+window.sessionStorage.getItem("visualTrama"));
				
				if (f1 == null){ f1 = "" };
				if (f2 == null){ f2 = "" };
				
				var lineData2 = {
					labels: ["Ultima trama "+f1,"Vieja trama "+f2],
					datasets: [
						{
							label: "Temperatura",
							backgroundColor: 'rgba(237,85,51,0.5)',
							borderColor: "rgba(237,85,51,0.7)",
							pointBackgroundColor: "rgba(237,85,51,1)",
							pointBorderColor: "#fff",
							data: [temp0,temp0old]
						}
					]
				};

				var lineOptions2 = {
					responsive: true
				};

				var ctxTemp = document.getElementById("lineChartTemp").getContext("2d");
				
				if (isMobile()) {
					window.lineIncred2 = new Chart(ctxTemp, {type: 'line', data: lineData2, options:lineOptions2});
				}else{
					window.lineIncred2 = new Chart(ctxTemp, {type: 'bar', data: lineData2, options:lineOptions2});
				}
				
				window.lineIncred2.update();
				
				var dataTemp0 = JSON.parse(window.sessionStorage.getItem("temperature0"+window.sessionStorage.getItem("visualTrama")));
				
				if (dataTemp0==null){
					dataTemp0 = 0;
				}
				
				$("#flot-dashboard5-charTemperature").length && $.plot($("#flot-dashboard5-charTemperature"), [ dataTemp0],
					{
						series: {
							lines: {
								show: false,
								fill: true
							},
							splines: {
								show: true,
								tension: 0.4,
								lineWidth: 1,
								fill: 0.4
							},
							points: {
								radius: 0,
								show: true
							},
							shadowSize: 2
						},
						grid: {
							hoverable: true,
							clickable: true,
							borderWidth: 2,
							color: 'transparent'
						},
						colors: ["#8ab14d"],
						xaxis:{},
						yaxis:{},
						tooltip: false
					}
				);
				
				
				//**************************************************************** humedad
				
				if(window.lineIncred3){
					window.lineIncred3.destroy();
				}
				
				var hume0 = window.sessionStorage.getItem("hUk1"+window.sessionStorage.getItem("visualTrama"));
					
				if (hume0==null){ hume0 = 0; }
				
				var hume0old = window.sessionStorage.getItem("hUkOLD1"+window.sessionStorage.getItem("visualTrama"));
				
				if (hume0old==null){ hume0old = 0; }
				
				var f1 = window.sessionStorage.getItem("FhUk"+window.sessionStorage.getItem("visualTrama"));
				var f2 = window.sessionStorage.getItem("FhUkOLD"+window.sessionStorage.getItem("visualTrama"));
				
				if (f1 == null){ f1 = "" };
				if (f2 == null){ f2 = "" };
				
				var lineData3 = {
					labels: ["Ultima trama "+f1,"Vieja trama "+f2],
					datasets: [
						{
							label: "Humedad",
							backgroundColor: 'rgba(237,85,51,0.5)',
							borderColor: "rgba(237,85,51,0.7)",
							pointBackgroundColor: "rgba(237,85,51,1)",
							pointBorderColor: "#fff",
							data: [hume0,hume0old]
						}
					]
				};

				var lineOptions3 = {
					responsive: true
				};

				var ctxHume = document.getElementById("lineChartHume").getContext("2d");
				
				if (isMobile()) {
					window.lineIncred3 = new Chart(ctxHume, {type: 'line', data: lineData3, options:lineOptions3});
				}else{
					window.lineIncred3 = new Chart(ctxHume, {type: 'bar', data: lineData3, options:lineOptions3});
				}
				
				window.lineIncred3.update();
				
				var dataHume0 = JSON.parse(window.sessionStorage.getItem("humedy0"+window.sessionStorage.getItem("visualTrama")));
				
				if (dataHume0==null){
					dataHume0 = 0;
				}
				
				$("#flot-dashboard5-charHume").length && $.plot($("#flot-dashboard5-charHume"), [ dataHume0],
					{
						series: {
							lines: {
								show: false,
								fill: true
							},
							splines: {
								show: true,
								tension: 0.4,
								lineWidth: 1,
								fill: 0.4
							},
							points: {
								radius: 0,
								show: true
							},
							shadowSize: 2
						},
						grid: {
							hoverable: true,
							clickable: true,
							borderWidth: 2,
							color: 'transparent'
						},
						colors: ["#8ab14d"],
						xaxis:{},
						yaxis:{},
						tooltip: false
					}
				);
				
				//**************************************************************** relay
				
				if(window.lineIncred4){
					window.lineIncred4.destroy();
				}
				
				var dout0 = window.sessionStorage.getItem("dUk0"+window.sessionStorage.getItem("visualTrama")),
					dout1 = window.sessionStorage.getItem("dUk1"+window.sessionStorage.getItem("visualTrama")),
					dout2 = window.sessionStorage.getItem("dUk2"+window.sessionStorage.getItem("visualTrama")),
					dout3 = window.sessionStorage.getItem("dUk3"+window.sessionStorage.getItem("visualTrama"));
					
				if (dout0==null){ dout0 = 0; }
				if (dout1==null){ dout1 = 0; }
				if (dout2==null){ dout2 = 0; }
				if (dout3==null){ dout3	= 0; }
				
				var dout0old = window.sessionStorage.getItem("dUkOLD0"+window.sessionStorage.getItem("visualTrama")),
					dout1old = window.sessionStorage.getItem("dUkOLD1"+window.sessionStorage.getItem("visualTrama")),
					dout2old = window.sessionStorage.getItem("dUkOLD2"+window.sessionStorage.getItem("visualTrama")),
					dout3old = window.sessionStorage.getItem("dUkOLD3"+window.sessionStorage.getItem("visualTrama"));
				
				if (dout0old==null){ dout0old = 0; }
				if (dout1old==null){ dout1old = 0; }
				if (dout2old==null){ dout2old = 0; }
				if (dout3old==null){ dout3old = 0; }
				
				var f1 = window.sessionStorage.getItem("FdUk"+window.sessionStorage.getItem("visualTrama"));
				var f2 = window.sessionStorage.getItem("FdUkOLD"+window.sessionStorage.getItem("visualTrama"));
				
				if (f1 == null){ f1 = "" };
				if (f2 == null){ f2 = "" };
				
				var lineData4 = {
					labels: ["Ultima trama "+f1,"Vieja trama "+f2],
					datasets: [
						{
							label: "Dout 0",
							backgroundColor: 'rgba(237,85,51,0.5)',
							borderColor: "rgba(237,85,51,0.7)",
							pointBackgroundColor: "rgba(237,85,51,1)",
							pointBorderColor: "#fff",
							data: [dout0,dout0old]
						},
						{
							label: "Dout 1",
							backgroundColor: 'rgba(26,100,148,0.5)',
							borderColor: "rgba(26,100,148,0.7)",
							pointBackgroundColor: "rgba(26,100,148,1)",
							pointBorderColor: "#fff",
							data: [dout1,dout1old]
						},
						{
							label: "Dout 2",
							backgroundColor: 'rgba(76,175,80,0.5)',
							borderColor: "rgba(76,175,80,0.7)",
							pointBackgroundColor: "rgba(76,175,80,1)",
							pointBorderColor: "#fff",
							data: [dout2,dout2old]
						},
						{
							label: "Dout 3",
							backgroundColor: 'rgba(156,39,176,0.5)',
							borderColor: "rgba(156,39,176,0.7)",
							pointBackgroundColor: "rgba(156,39,176,1)",
							pointBorderColor: "#fff",
							data: [dout3,dout3old]
						}
						
					]
				};

				var lineOptions4 = {
					responsive: true
				};

				/*var ctxRelay = document.getElementById("lineChartRelay").getContext("2d");
				
				if (isMobile()) {
					window.lineIncred4 = new Chart(ctxRelay, {type: 'line', data: lineData4, options:lineOptions4});
				}else{
					window.lineIncred4 = new Chart(ctxRelay, {type: 'bar', data: lineData4, options:lineOptions4});
				}
				
				window.lineIncred4.update();*/
			
				var dataRelay0 = JSON.parse(window.sessionStorage.getItem("tdout0"+window.sessionStorage.getItem("visualTrama")));
				
				if (dataRelay0==null){
					dataRelay0 = 0;
				}
				
				/*
				$("#flot-dashboard5-chartRelay").length && $.plot($("#flot-dashboard5-chartRelay"), [ dataRelay0],
					{
						series: {
							lines: {
								show: false,
								fill: true
							},
							splines: {
								show: true,
								tension: 0.4,
								lineWidth: 1,
								fill: 0.4
							},
							points: {
								radius: 0,
								show: true
							},
							shadowSize: 2
						},
						grid: {
							hoverable: true,
							clickable: true,
							borderWidth: 2,
							color: 'transparent'
						},
						colors: ["#8ab14d"],
						xaxis:{},
						yaxis:{},
						tooltip: false
					}
				);
				*/
				//**************************************************************** din
				
				if(window.lineIncred5){
					window.lineIncred5.destroy();
				}
				
				var din0 = window.sessionStorage.getItem("rUk0"+window.sessionStorage.getItem("visualTrama")),
					din1 = window.sessionStorage.getItem("rUk1"+window.sessionStorage.getItem("visualTrama")),
					din2 = window.sessionStorage.getItem("rUk2"+window.sessionStorage.getItem("visualTrama")),
					din3 = window.sessionStorage.getItem("rUk3"+window.sessionStorage.getItem("visualTrama")),
					din4 = window.sessionStorage.getItem("rUk4"+window.sessionStorage.getItem("visualTrama")),
					din5 = window.sessionStorage.getItem("rUk5"+window.sessionStorage.getItem("visualTrama")),
					din6 = window.sessionStorage.getItem("rUk6"+window.sessionStorage.getItem("visualTrama")),
					din7 = window.sessionStorage.getItem("rUk7"+window.sessionStorage.getItem("visualTrama"));
					
				if (din0==null){ din0 = 0; }
				if (din1==null){ din1 = 0; }
				if (din2==null){ din2 = 0; }
				if (din3==null){ din3 = 0; }
				if (din4==null){ din4 = 0; }
				if (din5==null){ din5 = 0; }
				if (din6==null){ din6 = 0; }
				if (din7==null){ din7 = 0; }
				
				var din0old = window.sessionStorage.getItem("rUkOLD0"+window.sessionStorage.getItem("visualTrama")),
					din1old = window.sessionStorage.getItem("rUkOLD1"+window.sessionStorage.getItem("visualTrama")),
					din2old = window.sessionStorage.getItem("rUkOLD2"+window.sessionStorage.getItem("visualTrama")),
					din3old = window.sessionStorage.getItem("rUkOLD3"+window.sessionStorage.getItem("visualTrama")),
					din4old = window.sessionStorage.getItem("rUkOLD4"+window.sessionStorage.getItem("visualTrama")),
					din5old = window.sessionStorage.getItem("rUkOLD5"+window.sessionStorage.getItem("visualTrama")),
					din6old = window.sessionStorage.getItem("rUkOLD6"+window.sessionStorage.getItem("visualTrama")),
					din7old = window.sessionStorage.getItem("rUkOLD7"+window.sessionStorage.getItem("visualTrama"));
				
				if (din0old==null){ din0old = 0; }
				if (din1old==null){ din1old = 0; }
				if (din2old==null){ din2old = 0; }
				if (din3old==null){ din3old = 0; }
				if (din4old==null){ din4old = 0; }
				if (din5old==null){ din5old = 0; }
				if (din6old==null){ din6old = 0; }
				if (din7old==null){ din7old = 0; }
				
				var f1 = window.sessionStorage.getItem("FrUk"+window.sessionStorage.getItem("visualTrama"));
				var f2 = window.sessionStorage.getItem("FdUkOLD"+window.sessionStorage.getItem("visualTrama"));
				
				if (f1 == null){ f1 = "" };
				if (f2 == null){ f2 = "" };
				
				
					din0 = din0.toString();
				if (din0.indexOf("268435457")>-1){
					var di0a = parseInt(din0);
					var di1a = 0;
					var di2a = 0;
					var di3a = 0;
				}else if(din0.indexOf("536870913")>-1){
					var di0a = 0;
					var di1a = parseInt(din0);
					var di2a = 0;
					var di3a = 0;
				}else if(din0.indexOf("805306369")>-1){
					var di0a = 0;
					var di1a = 0;
					var di2a = parseInt(din0);
					var di3a = 0;
				}else if (parseInt(din0) > 0){
					var di0a = 0;
					var di1a = 0;
					var di2a = 0;
					var di3a = parseInt(din0);
				}
				
					din1 = din1.toString();
				if (din1.indexOf("268435457")>-1){
					var di0b = parseInt(din1);
					var di1b = 0;
					var di2b = 0;
					var di3b = 0;
				}else if(din1.indexOf("536870913")>-1){
					var di0b = 0;
					var di1b = parseInt(din1);
					var di2b = 0;
					var di3b = 0;
				}else if(din1.indexOf("805306369")>-1){
					var di0b = 0;
					var di1b = 0;
					var di2b = parseInt(din1);
					var di3b = 0;
				}else if (parseInt(din1) > 0){
					var di0b = 0;
					var di1b = 0;
					var di2b = 0;
					var di3b = parseInt(din1);
				}
				
					din2 = din2.toString();
				if (din2.indexOf("268435457")>-1){
					var di0c = parseInt(din2);
					var di1c = 0;
					var di2c = 0;
					var di3c = 0;
				}else if(din2.indexOf("536870913")>-1){
					var di0c = 0;
					var di1c = parseInt(din2);
					var di2c = 0;
					var di3c = 0;
				}else if(din2.indexOf("805306369")>-1){
					var di0c = 0;
					var di1c = 0;
					var di2c = parseInt(din2);
					var di3c = 0;
				}else if(parseInt(din2) > 0){
					var di0c = 0;
					var di1c = 0;
					var di2c = 0;
					var di3c = parseInt(din2);
				}
					din3 = din3.toString();
				if (din3.indexOf("268435457")>-1){
					var di0d = parseInt(din3);
					var di1d = 0;
					var di2d = 0;
					var di3d = 0;
				}else if(din3.indexOf("536870913")>-1){
					var di0d = 0;
					var di1d = parseInt(din3);
					var di2d = 0;
					var di3d = 0;
				}else if(din3.indexOf("805306369")>-1){
					var di0d = 0;
					var di1d = 0;
					var di2d = parseInt(din3);
					var di3d = 0;
				}else if(parseInt(din3) > 0){
					var di0d = 0;
					var di1d = 0;
					var di2d = 0;
					var di3d = parseInt(din3);
				}
					din4 = din4.toString();
				if (din4.indexOf("268435457")>-1){
					var di0f = parseInt(din4);
					var di1f = 0;
					var di2f = 0;
					var di3f = 0;
				}else if(din4.indexOf("536870913")>-1){
					var di0f = 0;
					var di1f = parseInt(din4);
					var di2f = 0;
					var di3f = 0;
				}else if(din4.indexOf("805306369")>-1){
					var di0f = 0;
					var di1f = 0;
					var di2f = parseInt(din4);
					var di3f = 0;
				}else if(parseInt(din4) > 0){
					var di0f = 0;
					var di1f = 0;
					var di2f = 0;
					var di3f = parseInt(din4);
				}
					din5 = din5.toString();
				if (din5.indexOf("268435457")>-1){
					var di0g = parseInt(din5);
					var di1g = 0;
					var di2g = 0;
					var di3g = 0;
				}else if(din5.indexOf("536870913")>-1){
					var di0g = 0;
					var di1g = parseInt(din5);
					var di2g = 0;
					var di3g = 0;
				}else if(din5.indexOf("805306369")>-1){
					var di0g = 0;
					var di1g = 0;
					var di2g = parseInt(din5);
					var di3g = 0;
				}else if(parseInt(din5) > 0){
					var di0g = 0;
					var di1g = 0;
					var di2g = 0;
					var di3g = parseInt(din5);
				}
					din6 = din6.toString();
				if (din6.indexOf("268435457")>-1){
					var di0h = parseInt(din6);
					var di1h = 0;
					var di2h = 0;
					var di3h = 0;
				}else if(din6.indexOf("536870913")>-1){
					var di0h = 0;
					var di1h = parseInt(din6);
					var di2h = 0;
					var di3h = 0;
				}else if(din6.indexOf("805306369")>-1){
					var di0h = 0;
					var di1h = 0;
					var di2h = parseInt(din6);
					var di3h = 0;
				}else if(parseInt(din6) > 0){
					var di0h = 0;
					var di1h = 0;
					var di2h = 0;
					var di3h = parseInt(din6);
				}
					din7 = din7.toString();
				if (din7.indexOf("268435457")>-1){
					var di0i = parseInt(din7);
					var di1i = 0;
					var di2i = 0;
					var di3i = 0;
				}else if(din7.indexOf("536870913")>-1){
					var di0i = 0;
					var di1i = parseInt(din7);
					var di2i = 0;
					var di3i = 0;
				}else if(din7.indexOf("805306369")>-1){
					var di0i = 0;
					var di1i = 0;
					var di2i = parseInt(din7);
					var di3i = 0;
				}else if (parseInt(din7) > 0){
					var di0i = 0;
					var di1i = 0;
					var di2i = 0;
					var di3i = parseInt(din7);
				}
				
				var todoso = [
							['data1', di0a, di0b, di0c, di0d, di0f, di0g, di0h, di0i],
							['data2', di1a, di1b, di1c, di1d, di1f, di1g, di1h, di1i],
							['data3', di2a, di2b, di2c, di2d, di2f, di2g, di2h, di2i],
							['data4', di3a, di3b, di3c, di3d, di3f, di3g, di3h, di3i]
						];
				
				console.log(todoso);
				
				/*
				c3.generate({
					bindto: '#stocked',
					data:{
						columns: [
							['data1', di0a, di0b, di0c, di0d, di0f, di0g, di0h, di0i],
							['data2', di1a, di1b, di1c, di1d, di1f, di1g, di1h, di1i],
							['data3', di2a, di2b, di2c, di2d, di2f, di2g, di2h, di2i],
							['data4', di3a, di3b, di3c, di3d, di3f, di3g, di3h, di3i]
						],
						colors:{
							data1: '#79d2c0',
							data2: '#d3d3d3',
							data3: '#1ab394',
							data4: '#1c84c6'
						},
						type: 'bar',
						groups: [
							['Din 0','Din 1', 'Din 2', 'Din 3', 'Din 4','Din 5', 'Din 6', 'Din 7']
						]
					}
				});
				*/
				
				var dataDin0 = JSON.parse(window.sessionStorage.getItem("dinTrama0"+window.sessionStorage.getItem("visualTrama"))),
					dataDin1 = JSON.parse(window.sessionStorage.getItem("dinTrama1"+window.sessionStorage.getItem("visualTrama"))),
					dataDin2 = JSON.parse(window.sessionStorage.getItem("dinTrama2"+window.sessionStorage.getItem("visualTrama"))),
					dataDin3 = JSON.parse(window.sessionStorage.getItem("dinTrama3"+window.sessionStorage.getItem("visualTrama"))),
					dataDin4 = JSON.parse(window.sessionStorage.getItem("dinTrama4"+window.sessionStorage.getItem("visualTrama"))),
					dataDin5 = JSON.parse(window.sessionStorage.getItem("dinTrama5"+window.sessionStorage.getItem("visualTrama"))),
					dataDin6 = JSON.parse(window.sessionStorage.getItem("dinTrama6"+window.sessionStorage.getItem("visualTrama"))),
					dataDin7 = JSON.parse(window.sessionStorage.getItem("dinTrama7"+window.sessionStorage.getItem("visualTrama")));
				
				if (dataDin0==null){
					dataDin0 = 0;
				}
				if (dataDin1==null){
					dataDin1 = 0;
				}
				if (dataDin2==null){
					dataDin2 = 0;
				}
				if (dataDin3==null){
					dataDin3 = 0;
				}
				if (dataDin4==null){
					dataDin4 = 0;
				}
				if (dataDin5==null){
					dataDin5 = 0;
				}
				if (dataDin6==null){
					dataDin6 = 0;
				}
				if (dataDin7==null){
					dataDin7 = 0;
				}
				
				$("#flot-dashboard5-chartDin").length && $.plot($("#flot-dashboard5-chartDin"), [ dataDin0, dataDin1,  dataDin2, dataDin3 , dataDin4, dataDin5, dataDin6, dataDin7],
					{
						series: {
							lines: {
								show: false,
								fill: true
							},
							splines: {
								show: true,
								tension: 0.4,
								lineWidth: 1,
								fill: 0.4
							},
							points: {
								radius: 0,
								show: true
							},
							shadowSize: 2
						},
						grid: {
							hoverable: true,
							clickable: true,
							borderWidth: 2,
							color: 'transparent'
						},
						colors: ["#8ab14d", "#0b4c8f", "#ef562c", "#cf3074", "#ea4335", "#34a853", "#fbbc05", "#4e0084"],
						xaxis:{},
						yaxis:{},
						tooltip: false
					}
				);
				
			}
		}
		
		if (window.sessionStorage.getItem("visualTrama")!==undefined && window.sessionStorage.getItem("visualTrama")!==null){
			window.sessionStorage.setItem("sensor1"+window.sessionStorage.getItem("visualTrama"),"[]");
			window.sessionStorage.setItem("sensor2"+window.sessionStorage.getItem("visualTrama"),"[]");
			window.sessionStorage.setItem("sensor3"+window.sessionStorage.getItem("visualTrama"),"[]");
			window.sessionStorage.setItem("sensor4"+window.sessionStorage.getItem("visualTrama"),"[]");
			window.sessionStorage.setItem("sensor5"+window.sessionStorage.getItem("visualTrama"),"[]");
			window.sessionStorage.setItem("sensor6"+window.sessionStorage.getItem("visualTrama"),"[]");
			window.sessionStorage.setItem("sensor7"+window.sessionStorage.getItem("visualTrama"),"[]");
			window.sessionStorage.setItem("sensor8"+window.sessionStorage.getItem("visualTrama"),"[]");
			window.sessionStorage.setItem("sensor0"+window.sessionStorage.getItem("visualTrama"),"[]");
			
		}
		
		function cargarModalTrama(){
			$("#modalnew").modal("show");
		}
				
		$("#modalnew").on("hidden.bs.modal", function () {
			var table = $('#TableNueva').DataTable();
			table.destroy();
		});
		
		
		function cambioIcono(port,icono){
			
			var doto = JSON.parse(window.sessionStorage.getItem("punteados"));
			for (var hx = 0; hx < doto.length; hx++) {
												
				if (doto[hx].port == port) {
					var exits = doto[hx].ico.replace("/img/m2m/","");
					var icones2 = exits.replace("c.png",""),
						icones3 = icones2.replace("v.png",""),
						icones = icones3.replace("r.png","");
					
					if (icono == "Bajo"){
						doto[hx].ico = "/img/m2m/"+icones+"v.png";
					}else if (icono == "Normal"){
						doto[hx].ico = "/img/m2m/"+icones+"c.png";
					}else if (icono == "Alto"){
						doto[hx].ico = "/img/m2m/"+icones+"r.png";
					}
					
					updateBd(doto[hx].ico,doto[hx].nom);
					
				}
			}
			
			window.sessionStorage.setItem("punteados",JSON.stringify(doto));
		
		}
		
		function popups(){
			
			$("#bar1").text("Recone.");
			$("#bar1").removeClass("progress-bar-danger");
			$("#bar1").addClass("progress-bar-warning");
			
			if (window.sessionStorage.getItem("visualTrama")!==undefined && window.sessionStorage.getItem("visualTrama")!==null){	
					
				var pourt = window.sessionStorage.getItem("visualTrama");
				backend.grafica("acceso",block.ip,window.sessionStorage.getItem("visualTrama"),function(salida){
					
					if (salida!==window.sessionStorage.getItem("ultimaTrama"+pourt)){
						
						toastr.info("Recepción de trama distinta a la anterior");
						
						var nombreE = "";
						var accion = JSON.parse(window.sessionStorage.getItem("punteados"));
						for (var m = 0; m < accion.length; m++){
							if(accion[m].port == pourt){
								nombreE = accion[m].nom;
							}
						}
												
						var text = JSON.parse(salida);
						var mista = [],fecha = moment().format('MMMM Do YYYY, h:mm:ss a');
						for (var d = 0; d < text.length; d++){
							
							if (text[d].indexOf("Sensor")>-1){
							
								var info = text[d].split("*"),
									sensor = info[1],
									valor = info[2];
									
								if (window.sessionStorage.getItem("ain"+sensor)=="true"){
									$("#ain"+sensor+"T").text("Ain "+sensor+" input "+ valor);
									mista.push(["Sensor "+sensor+" input "+ valor,fecha]);
									
								}
								
								var bajo = window.sessionStorage.getItem("Sensor_Bajo_"+sensor);
								var alto = window.sessionStorage.getItem("Sensor_Alto_"+sensor);
								
								if(bajo!==null){
									var bajoide = parseInt(bajo);
									if (valor < bajoide){
										
										var msj ='Evento con Ain'+sensor+' \n del elemento ' + nombreE + '\n está con estatus Bajo \n y con valor ' + valor + ' y el dia ' + fecha;
										toastr.success(msj);
										
										cambioIcono(pourt,"Bajo");
										
										var nume = parseInt($("#numaprob").html()) + 1;
										$("#numaprob").html(nume);
										var nuevo = '<li id="texto' + nume + 'k"><div class="dropdown-messages-box"><a class="pull-left"><img alt="image" class="img-circle" src="img/m2m.png"></a><div class="media-body" onclick="javascript:leido(' + String.fromCharCode(39) + nume + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '2' + String.fromCharCode(39) + ');"><small class="pull-right">' + moment().format('MMMM Do YYYY, h:mm:ss a') + '</small><strong>'+msj+'</strong> <br><small class="text-muted">Web</small></div></div></li><li id="div' + nume + 'k" class="divider"></li>' + $("#menusListab").html();
										$("#menusListab").html(nuevo);
										
									}
								}
								
								if(alto!==null){
									var bajoide = parseInt(alto);
									if (valor > bajoide){
										
										var msj ='Evento con Ain'+sensor+' \n del elemento ' + nombreE + '\n está con estatus Alto \n y con valor ' + valor + ' y el dia ' + fecha ;
										toastr.error(msj);

										cambioIcono(pourt,"Alto");
										
										var nume = parseInt($("#numaproc").html()) + 1;
										$("#numaproc").html(nume);
										var nuevo = '<li id="texto' + nume + 'h"><div class="dropdown-messages-box"><a class="pull-left"><img alt="image" class="img-circle" src="img/m2m.png"></a><div class="media-body" onclick="javascript:leido(' + String.fromCharCode(39) + nume + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '3' + String.fromCharCode(39) + ');"><small class="pull-right">' + moment().format('MMMM Do YYYY, h:mm:ss a') + '</small><strong>'+msj+'</strong> <br><small class="text-muted">Web</small></div></div></li><li id="div' + nume + 'h" class="divider"></li>' + $("#menusListac").html();
										$("#menusListac").html(nuevo);
										
									}
								}
								
								if (window.sessionStorage.getItem("historicoTrama"+pourt)!==null){
									var ins = JSON.parse(window.sessionStorage.getItem("historicoTrama"+pourt));
									ins.push(mista[0]);
									window.sessionStorage.setItem("historicoTrama"+pourt,JSON.stringify(ins));
								}else{
									var hio = mista;
									window.sessionStorage.setItem("historicoTrama"+pourt,JSON.stringify(hio));
								}
								
								if (window.sessionStorage.getItem("sUk"+info[1]+pourt)!==null){
									window.sessionStorage.setItem("sUkOLD"+info[1]+pourt,window.sessionStorage.getItem("sUk"+info[1]+pourt));
								}
								
								window.sessionStorage.setItem("sUk"+info[1]+pourt,valor);
								
								if (window.sessionStorage.getItem("FsUk"+pourt)!==null){
									window.sessionStorage.setItem("FsUkOLD"+pourt,window.sessionStorage.getItem("FsUk"+pourt));
								}
								
								window.sessionStorage.setItem("FsUk"+pourt,moment().format('MMMM Do YYYY, h:mm:ss a'));
								
								if (window.sessionStorage.getItem("sensor"+info[1]+pourt)!==null){
									var lisa = JSON.parse(window.sessionStorage.getItem("sensor"+info[1]+pourt));
									var nun = lisa.length;
									lisa.push([nun,valor]);
									window.sessionStorage.setItem("sensor"+info[1]+pourt,JSON.stringify(lisa));
								}else{
									var fes = [[0,valor]];
									window.sessionStorage.setItem("sensor"+info[1]+pourt,JSON.stringify(fes));
								}
																	
							}else if (text[d].indexOf("DIM")>-1){
							
								var info = text[d].split("*"),
									sensor = info[1],
									valor = info[2];
								
								
								var inid = valor.toString();
								if (inid.indexOf("268435457")>-1){
								
									var texs = "Nc";
									var msj ='Evento con Din'+sensor+' \n del elemento ' + nombreE + '\n está con estatus Nc \n y con valor ' + valor + ' y el dia ' + fecha ;
									toastr.error(msj);
									cambioIcono(pourt,"Alto");
									var nume = parseInt($("#numaproa").html()) + 1;
									$("#numaproa").html(nume);
									var nuevo = '<li id="texto' + nume + 'w"><div class="dropdown-messages-box"><a class="pull-left"><img alt="image" class="img-circle" src="img/m2m.png"></a><div class="media-body" onclick="javascript:leido(' + String.fromCharCode(39) + nume + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '1' + String.fromCharCode(39) + ');"><small class="pull-right">' + moment().format('MMMM Do YYYY, h:mm:ss a') + '</small><strong>'+msj+'</strong> <br><small class="text-muted">Web</small></div></div></li><li id="div' + nume + 'w" class="divider"></li>' + $("#menusListaa").html();
									$("#menusListaa").html(nuevo);
									
								}else if(inid.indexOf("536870913")>-1){
									
									if(window.sessionStorage.getItem("apareceNo")==null){
										var texs = "No";
										var msj ='Evento con Din'+sensor+' \n del elemento ' + nombreE + '\n está con estatus No \n y con valor ' + valor + ' y el dia ' + fecha ;
										toastr.success(msj);
										cambioIcono(pourt,"Bajo");
										var nume = parseInt($("#numaproa").html()) + 1;
										$("#numaproa").html(nume);
										var nuevo = '<li id="texto' + nume + 'w"><div class="dropdown-messages-box"><a class="pull-left"><img alt="image" class="img-circle" src="img/m2m.png"></a><div class="media-body" onclick="javascript:leido(' + String.fromCharCode(39) + nume + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '1' + String.fromCharCode(39) + ');"><small class="pull-right">' + moment().format('MMMM Do YYYY, h:mm:ss a') + '</small><strong>'+msj+'</strong> <br><small class="text-muted">Web</small></div></div></li><li id="div' + nume + 'w" class="divider"></li>' + $("#menusListaa").html();
										$("#menusListaa").html(nuevo);
										window.sessionStorage.setItem("apareceNo","yes");
									}
								}else if(inid.indexOf("805306369")>-1){
									
									if(window.sessionStorage.getItem("apareceChange")==null){
										var texs = "Change";
										var msj ='Evento con Din'+sensor+' \n del elemento ' + nombreE + '\n está con estatus Change \n y con valor ' + valor + ' y el dia ' + fecha ;
										toastr.success(msj);
										cambioIcono(pourt,"Bajo");
										var nume = parseInt($("#numaproa").html()) + 1;
										$("#numaproa").html(nume);
										var nuevo = '<li id="texto' + nume + 'w"><div class="dropdown-messages-box"><a class="pull-left"><img alt="image" class="img-circle" src="img/m2m.png"></a><div class="media-body" onclick="javascript:leido(' + String.fromCharCode(39) + nume + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '1' + String.fromCharCode(39) + ');"><small class="pull-right">' + moment().format('MMMM Do YYYY, h:mm:ss a') + '</small><strong>'+msj+'</strong> <br><small class="text-muted">Web</small></div></div></li><li id="div' + nume + 'w" class="divider"></li>' + $("#menusListaa").html();
										$("#menusListaa").html(nuevo);
										window.sessionStorage.setItem("apareceChange","yes");
									}
									
								}else if (parseInt(inid) > 0){
									
									if(window.sessionStorage.getItem("apareceCounter")==null){
										var texs = "Couter";
										var msj ='Evento con Din'+sensor+' \n del elemento ' + nombreE + '\n está con estatus Counter \n y con valor ' + valor + ' y el dia ' + fecha ;
										toastr.success(msj);
										cambioIcono(pourt,"Bajo");
										var nume = parseInt($("#numaproa").html()) + 1;
										$("#numaproa").html(nume);
										var nuevo = '<li id="texto' + nume + 'w"><div class="dropdown-messages-box"><a class="pull-left"><img alt="image" class="img-circle" src="img/m2m.png"></a><div class="media-body" onclick="javascript:leido(' + String.fromCharCode(39) + nume + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '1' + String.fromCharCode(39) + ');"><small class="pull-right">' + moment().format('MMMM Do YYYY, h:mm:ss a') + '</small><strong>'+msj+'</strong> <br><small class="text-muted">Web</small></div></div></li><li id="div' + nume + 'w" class="divider"></li>' + $("#menusListaa").html();
										$("#menusListaa").html(nuevo);
										window.sessionStorage.setItem("apareceCounter","yes");
									}
								}
								
								
								var bajo = window.sessionStorage.getItem("DIM_Bajo_"+sensor);
								var alto = window.sessionStorage.getItem("DIM_Alto_"+sensor);
								
								
								if (window.sessionStorage.getItem("FrUk"+pourt)!==null){
									window.sessionStorage.setItem("FrUkOLD"+pourt,window.sessionStorage.getItem("FrUk"+pourt));
								}
								
								window.sessionStorage.setItem("FrUk"+pourt,moment().format('MMMM Do YYYY, h:mm:ss a'));
									
								
								if (window.sessionStorage.getItem("rUk"+info[1]+pourt)!==null){
									window.sessionStorage.setItem("rUkOLD"+info[1]+pourt,window.sessionStorage.getItem("rUk"+info[1]+pourt));
								}
								
								window.sessionStorage.setItem("rUk"+info[1]+pourt,valor);
								
								if (window.sessionStorage.getItem("dinTrama"+info[1]+pourt)!==null){
									var lisa = JSON.parse(window.sessionStorage.getItem("dinTrama"+info[1]+pourt));
									var nun = lisa.length;
									lisa.push([nun,valor]);
									window.sessionStorage.setItem("dinTrama"+info[1]+pourt,JSON.stringify(lisa));
								}else{
									var fes = [[0,valor]];
									window.sessionStorage.setItem("dinTrama"+info[1]+pourt,JSON.stringify(fes));
								}
								
								if (window.sessionStorage.getItem("dim"+sensor)=="true"){
									$("#dim"+sensor+"T").text("Dim "+sensor+" input "+ valor );
									mista.push(["Din "+sensor+" input "+ valor,fecha]);
									
								}
									
							}else if (text[d].indexOf("Temperature")>-1){
								
								var info = text[d].split("*"),
									sensor = info[1],
									valor = info[2];
								
								var bajo = window.sessionStorage.getItem("Temperature_Bajo_1");
								var alto = window.sessionStorage.getItem("Temperature_Alto_1");
								
								if(bajo!==null){
									var bajoide = parseInt(bajo);
									if (valor < bajoide){
										
										var msj ='Evento con Temperature'+sensor+' \n del elemento ' + nombreE + '\n está con estatus Bajo \n y con valor ' + valor + ' y el dia ' + fecha;
										toastr.success(msj);

										cambioIcono(pourt,"Bajo");
										
										var nume = parseInt($("#numaprob").html()) + 1;
										$("#numaprob").html(nume);
										var nuevo = '<li id="texto' + nume + 'k"><div class="dropdown-messages-box"><a class="pull-left"><img alt="image" class="img-circle" src="img/m2m.png"></a><div class="media-body" onclick="javascript:leido(' + String.fromCharCode(39) + nume + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '2' + String.fromCharCode(39) + ');"><small class="pull-right">' + moment().format('MMMM Do YYYY, h:mm:ss a') + '</small><strong>'+msj+'</strong> <br><small class="text-muted">Web</small></div></div></li><li id="div' + nume + 'k" class="divider"></li>' + $("#menusListab").html();
										$("#menusListab").html(nuevo);
										
									}
								}
								
								
								if(alto!==null){
									var bajoide = parseInt(alto);
									if (valor > bajoide){
										
										var msj ='Evento con Temperature'+sensor+' \n del elemento ' + nombreE + '\n está con estatus Alto \n y con valor ' + valor + ' y el dia ' + fecha;
										toastr.error(msj);
										
										cambioIcono(pourt,"Alto");

										var nume = parseInt($("#numaproc").html()) + 1;
										$("#numaproc").html(nume);
										var nuevo = '<li id="texto' + nume + 'h"><div class="dropdown-messages-box"><a class="pull-left"><img alt="image" class="img-circle" src="img/m2m.png"></a><div class="media-body" onclick="javascript:leido(' + String.fromCharCode(39) + nume + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '3' + String.fromCharCode(39) + ');"><small class="pull-right">' + moment().format('MMMM Do YYYY, h:mm:ss a') + '</small><strong>'+msj+'</strong> <br><small class="text-muted">Web</small></div></div></li><li id="div' + nume + 'h" class="divider"></li>' + $("#menusListac").html();
										$("#menusListac").html(nuevo);
										
									}
								}
								
								if (window.sessionStorage.getItem("FtUk"+pourt)!==null){
									window.sessionStorage.setItem("FtUkOLD"+pourt,window.sessionStorage.getItem("FtUk"+pourt));
								}
								
								window.sessionStorage.setItem("FtUk"+pourt,moment().format('MMMM Do YYYY, h:mm:ss a'));
								
								if (window.sessionStorage.getItem("tUk"+info[1]+pourt)!==null){
									window.sessionStorage.setItem("tUkOLD"+info[1]+pourt,window.sessionStorage.getItem("tUk"+info[1]+pourt));
								}
								
								window.sessionStorage.setItem("tUk"+info[1]+pourt,valor);
								
								if (window.sessionStorage.getItem("temperature0"+pourt)!==null){
									var lisa = JSON.parse(window.sessionStorage.getItem("temperature0"+pourt));
									var nun = lisa.length;
									lisa.push([nun,valor]);
									window.sessionStorage.setItem("temperature0"+pourt,JSON.stringify(lisa));
								}else{
									var fes = [[0,valor]];
									window.sessionStorage.setItem("temperature0"+pourt,JSON.stringify(fes));
								}
								
								if (window.sessionStorage.getItem("Temperature")=="true"){
									$("#TemperatureT").text("Temperature "+valor);
									mista.push(["Temperature "+valor,fecha]);
									
								}
								
							}else if (text[d].indexOf("Humedy")>-1){
								
								var info = text[d].split("*"),
									sensor = info[1],
									valor = info[2];
								
								var bajo = window.sessionStorage.getItem("Humedy_Bajo_1");
								var alto = window.sessionStorage.getItem("Humedy_Alto_1");
								
								if(bajo!==null){
									var bajoide = parseInt(bajo);
									if (valor < bajoide){
										
										var msj ='Evento con Humedad'+sensor+' \n del elemento ' + nombreE + '\n está con estatus Bajo \n y con valor ' + valor + ' y el dia ' + fecha ;
										toastr.success(msj);
										
										cambioIcono(pourt,"Bajo");

										var nume = parseInt($("#numaprob").html()) + 1;
										$("#numaprob").html(nume);
										var nuevo = '<li id="texto' + nume + 'k"><div class="dropdown-messages-box"><a class="pull-left"><img alt="image" class="img-circle" src="img/m2m.png"></a><div class="media-body" onclick="javascript:leido(' + String.fromCharCode(39) + nume + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '2' + String.fromCharCode(39) + ');"><small class="pull-right">' + moment().format('MMMM Do YYYY, h:mm:ss a') + '</small><strong>'+msj+'</strong> <br><small class="text-muted">Web</small></div></div></li><li id="div' + nume + 'k" class="divider"></li>' + $("#menusListab").html();
										$("#menusListab").html(nuevo);
										
									}
								}
								
								if(alto!==null){
									var bajoide = parseInt(alto);
									if (valor > bajoide){
										
										var msj ='Evento con Humedad'+sensor+' \n del elemento ' + nombreE + '\n está con estatus Alto \n y con valor ' + valor + ' y el dia ' + fecha;
										toastr.error(msj);

										cambioIcono(pourt,"Alto");
										
										var nume = parseInt($("#numaproc").html()) + 1;
										$("#numaproc").html(nume);
										var nuevo = '<li id="texto' + nume + 'h"><div class="dropdown-messages-box"><a class="pull-left"><img alt="image" class="img-circle" src="img/m2m.png"></a><div class="media-body" onclick="javascript:leido(' + String.fromCharCode(39) + nume + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '3' + String.fromCharCode(39) + ');"><small class="pull-right">' + moment().format('MMMM Do YYYY, h:mm:ss a') + '</small><strong>'+msj+'</strong> <br><small class="text-muted">Web</small></div></div></li><li id="div' + nume + 'h" class="divider"></li>' + $("#menusListac").html();
										$("#menusListac").html(nuevo);
										
									}
								}
								
								if (window.sessionStorage.getItem("hUk"+info[1]+pourt)!==null){
									window.sessionStorage.setItem("hUkOLD"+info[1]+pourt,window.sessionStorage.getItem("hUk"+info[1]+pourt));
								}
								
								window.sessionStorage.setItem("hUk"+info[1]+pourt,valor);
								
								if (window.sessionStorage.getItem("FhUk"+pourt)!==null){
									window.sessionStorage.setItem("FhUkOLD"+pourt,window.sessionStorage.getItem("FhUk"+pourt));
								}
								
								window.sessionStorage.setItem("FhUk"+pourt,moment().format('MMMM Do YYYY, h:mm:ss a'));
								
								
								if (window.sessionStorage.getItem("humedy0"+pourt)!==null){
									var lisa = JSON.parse(window.sessionStorage.getItem("humedy0"+pourt));
									var nun = lisa.length;
									lisa.push([nun,valor]);
									window.sessionStorage.setItem("humedy0"+pourt,JSON.stringify(lisa));
								}else{
									var fes = [[0,valor]];
									window.sessionStorage.setItem("humedy0"+pourt,JSON.stringify(fes));
								}
								
								
								if (window.sessionStorage.getItem("humedy")=="true"){
									$("#humedyT").text("Humedy "+valor);
									mista.push(["Humedy "+valor,fecha]);
									
								}
								
							}else if (text[d].indexOf("Dout")>-1){
								
								var info = text[d].split("*"),
									sensor = info[1],
									valor = info[2];
									
								var interr = 0;
								if (valor == "Close"){
									interr = 1;
									//$("#rela"+sensor).attr("src","/img/on.png");
									//toastr.success("Extra: Dout "+sensor+" esta CLOSE");
								}else{
									//$("#rela"+sensor).attr("src","/img/off.png");
									//toastr.error("Extra: Dout "+sensor+" esta OPEN");
								}
								
								
								if (window.sessionStorage.getItem("dUk"+info[1]+pourt)!==null){
									window.sessionStorage.setItem("dUkOLD"+info[1]+pourt,window.sessionStorage.getItem("dUk"+info[1]+pourt));
								}
								
								window.sessionStorage.setItem("dUk"+info[1]+pourt,interr);
								
								if (window.sessionStorage.getItem("FdUk"+pourt)!==null){
									window.sessionStorage.setItem("FdUkOLD"+pourt,window.sessionStorage.getItem("FdUk"+pourt));
								}
								
								window.sessionStorage.setItem("FdUk"+pourt,moment().format('MMMM Do YYYY, h:mm:ss a'));
								
								if (window.sessionStorage.getItem("tdout0"+pourt)!==null){
									var lisa = JSON.parse(window.sessionStorage.getItem("tdout0"+pourt));
									var nun = lisa.length;
									lisa.push([nun,interr]);
									window.sessionStorage.setItem("tdout0"+pourt,JSON.stringify(lisa));
								}else{
									var fes = [[0,interr]];
									window.sessionStorage.setItem("tdout0"+pourt,JSON.stringify(fes));
								}
								
									
								if (window.sessionStorage.getItem("dout"+sensor)=="true"){
									$("#dout"+sensor+"T").text("Dout "+sensor+" "+valor);
									mista.push(["Dout "+sensor+" "+valor,fecha]);
									
								}	
							
							}else if (text[d].indexOf("External")>-1){
							
								$("#bac").attr("src","/img/bateryOn.png");
								$("#pow").attr("src","/img/powerOff.png");
							
								var info = text[d].split("*"),
									sensor = info[1],
									valor = info[2];
									
								if (window.sessionStorage.getItem("voltage_external")=="true"){
									$("#voltage_externalT").text("The voltage of the external "+valor);
									mista.push(["The voltage of the external "+valor,fecha]);
									
								}
							
							}else if (text[d].indexOf("ac_power")>-1){
							
								$("#bac").attr("src","/img/bateryOff.png");
								$("#pow").attr("src","/img/powerOn.png");
							
								var info = text[d].split("*"),
									sensor = info[1],
									valor = info[2];
									
								if (window.sessionStorage.getItem("ac_power")=="true"){
									$("#ac_powerT").text("AC power status "+valor);
									mista.push(["AC power status "+valor,fecha]);
									
								}
								
							}else if (text[d].indexOf("SIGNAL")>-1){
								
								var info = text[d].split("*"),
									sensor = info[1],
									valor = info[2];
								
								$("#sig").text(valor);
								
								if (window.sessionStorage.getItem("gsm_signal")=="true"){
									$("#gsm_signalT").text("Gsm signal "+valor);
									mista.push(["Gsm signal "+valor,fecha]);
									
								}
									
							}else if (text[d].indexOf("Arm/Disarm")>-1){
								
								var info = text[d].split("*"),
									sensor = info[1],
									valor = info[2];
							
								if (window.sessionStorage.getItem("arm_disarm")=="true"){
									$("#arm_disarmT").text("Arm/Disarm "+valor);
									mista.push(["Arm/Disarm "+valor,fecha]);
									
								}
							
								
							}
							
						}
						
						tiempoRealTrama();
						window.sessionStorage.setItem("ultimaTrama"+pourt,salida);
					}
					
				});
				
			}
			
			toastr.options = {
				"closeButton": true,
				"debug": false,
				"progressBar": true,
				"preventDuplicates": false,
				"positionClass": "toast-top-right",
				"onclick": null,
				"showDuration": "60000",
				"hideDuration": "1000",
				"timeOut": "64000",
				"extendedTimeOut": "4000",
				"showEasing": "swing",
				"hideEasing": "linear",
				"showMethod": "fadeIn",
				"hideMethod": "fadeOut"
			}
			
			/*
			
			backend.grafica("acceso",block.ip,"8085",function(salida){
				
				$("#bar1").text("On red.");
				$("#bar1").removeClass("progress-bar-warning");
				$("#bar1").addClass("progress-bar-primary");
				
				String.prototype.replaceAll = function(search, replacement) {
					var target = this;return target.replace(new RegExp(search, 'g'), replacement);
				};

				var textDato = JSON.parse(salida);
				
				var nombre = textDato.text,
					estatus = "",
					limpio = nombre.replaceAll("\r",""),
					filtro = limpio.replaceAll("\n",""),
					lista = filtro.split(";"),
					nombreEle = "";
				
				for (var f = 0; f < lista.length; f++){
					var infe = lista[f];
					
					if (infe.indexOf("Power")>-1){
						var es = infe.split(":");
						if (parseInt(es[1])>0){
							$("#pow").attr("src","/img/powerOn.png");
							$("#bac").attr("src","/img/bateryOff.png");
						}
					}
										
					var passe = "1234";
					var accion = JSON.parse(window.sessionStorage.getItem("punteados"));
					var nues = textDato.number.replace("+","");
					var nues2 = nues.replace(" ","");
					for (var m = 0; m < accion.length; m++){
						if(accion[m].tel=="+"+nues2){
							passe = accion[m].pass;
							nombreEle = accion[m].nom;
						}
					}
					
					var timesr = textDato.time.split(" "),fecham = timesr[0],hourm = timesr[1];
					
					if (infe.indexOf("Signal")>-1){
						var es = infe.split(":");
						$("#sig").html(es[1]);
					}
					
					if(infe.indexOf("Voltage")>-1){
						$("#bac").attr("src","/img/bateryOff.png");
						$("#pow").attr("src","/img/powerOff.png");
						
						toastr.error('El equipo con el numero '+textDato.number+'\n tiene bateria baja y esta proximo a apagarse y el dia '+fecham+' y hora '+hourm);
				
						var nume = parseInt($("#numaprob").html()) + 1;
						$("#numaprob").html(nume);
						var nuevo = '<li id="texto'+nume+'k"><div class="dropdown-messages-box"><a class="pull-left"><img alt="image" class="img-circle" src="img/m2m.png"></a><div class="media-body" onclick="javascript:leido('+String.fromCharCode(39)+nume+String.fromCharCode(39)+','+String.fromCharCode(39) +'000000000'+ String.fromCharCode(39)+','+String.fromCharCode(39)+'2'+ String.fromCharCode(39)+','+String.fromCharCode(39)+'000000000'+ String.fromCharCode(39)+','+String.fromCharCode(39)+'000000000'+ String.fromCharCode(39)+');"><small class="pull-right">'+moment().format('MMMM Do YYYY, h:mm:ss a')+'</small><strong>El equipo con el numero '+textDato.number+'\n tiene bateria baja y esta proximo a apagarse </strong> <br><small class="text-muted">Web</small></div></div></li><li id="div'+nume+'k" class="divider"></li>'+$("#menusListab").html();
						$("#menusListab").html(nuevo);
						
					}else{
						var imgen = document.getElementById("pow").src;
						if (imgen.indexOf("Off")>-1){
							$("#bac").attr("src","/img/bateryOn.png");
						}
					}
					
					var infos2 = textDato.number.replace("+","");
					var infos = infos2.replace(" ","");
					if (window.sessionStorage.getItem("ultimoPopup")!==infos+textDato.time){
						
						if (infe.indexOf("DO")>-1){
							var es = infe.split(":");
							var indicador = es[0].replace("DO","");
							var lin2 = textDato.number.replace("+","");
							var lin = lin2.replace(" ","");
							
							if(es[1]=="Close"){
							
								if(window.sessionStorage.getItem("Graf_dout_v_DOUT"+indicador+"_"+lin)==null){
									var nuebs = [0];
									var nuebs2 = [textDato.time];
									window.sessionStorage.setItem("Graf_dout_v_DOUT"+indicador+"_"+lin,JSON.stringify(nuebs));
									window.sessionStorage.setItem("Graf_dout_f_DOUT"+indicador+"_"+lin,JSON.stringify(nuebs2));
								}else{
									var otrs = JSON.parse(window.sessionStorage.getItem("Graf_dout_v_DOUT"+indicador+"_"+lin));
									var otrs2 = JSON.parse(window.sessionStorage.getItem("Graf_dout_f_DOUT"+indicador+"_"+lin));
									otrs.push(0);
									otrs2.push(textDato.time);
									window.sessionStorage.setItem("Graf_dout_v_DOUT"+indicador+"_"+lin,JSON.stringify(otrs));
									window.sessionStorage.setItem("Graf_dout_f_DOUT"+indicador+"_"+lin,JSON.stringify(otrs2));
								}
								
								var nim = "DOO"+es[0].replace("DO","");
								window.sessionStorage.setItem("RelayEje",passe+nim);
								
								$("#r_estado_relay").removeClass("btn-danger").addClass("btn-primary");
								$("#r_estado_relay").html("<i class='fa fa-toggle-on'></i> Apagar");
								$("#rela"+es[0].replace("DO","")).attr("src","/img/on.png");
								
							}else if(es[1]=="Open"){
							
								if(window.sessionStorage.getItem("Graf_dout_v_DOUT"+indicador+"_"+lin)==null){
									var nuebs = [1];
									var nuebs2 = [textDato.time];
									window.sessionStorage.setItem("Graf_dout_v_DOUT"+indicador+"_"+lin,JSON.stringify(nuebs));
									window.sessionStorage.setItem("Graf_dout_f_DOUT"+indicador+"_"+lin,JSON.stringify(nuebs2));
								}else{
									var otrs = JSON.parse(window.sessionStorage.getItem("Graf_dout_v_DOUT"+indicador+"_"+lin));
									var otrs2 = JSON.parse(window.sessionStorage.getItem("Graf_dout_f_DOUT"+indicador+"_"+lin));
									otrs.push(1);
									otrs2.push(textDato.time);
									window.sessionStorage.setItem("Graf_dout_v_DOUT"+indicador+"_"+lin,JSON.stringify(otrs));
									window.sessionStorage.setItem("Graf_dout_f_DOUT"+indicador+"_"+lin,JSON.stringify(otrs2));
								}
							
								var nim = "DOC"+es[0].replace("DO","");
								window.sessionStorage.setItem("RelayEje",passe+nim);
								
								$("#r_estado_relay").removeClass("btn-primary").addClass("btn-danger");
								$("#r_estado_relay").html("<i class='fa fa-toggle-off'></i> Encender");
								$("#rela"+es[0].replace("DO","")).attr("src","/img/off.png");

							}
						}
						
						if (infe.indexOf("Temp")>-1){
							var es = infe.split(":");
							var oues = es[1].split(",");
							var otru = oues[0];
							var estatus = oues[1]; 
							
							
							var lin2 = textDato.number.replace("+","");
							var lin = lin2.replace(" ","");
							
							if(window.sessionStorage.getItem("Graf_temp_v_"+lin)==null){
								var nuebs = [otru];
								var nuebs2 = [textDato.time];
								window.sessionStorage.setItem("Graf_temp_v_"+lin,JSON.stringify(nuebs));
								window.sessionStorage.setItem("Graf_temp_f_"+lin,JSON.stringify(nuebs2));
							}else{
								var otrs = JSON.parse(window.sessionStorage.getItem("Graf_temp_v_"+lin));
								var otrs2 = JSON.parse(window.sessionStorage.getItem("Graf_temp_f_"+lin));
								otrs.push(otru);
								otrs2.push(textDato.time);
								window.sessionStorage.setItem("Graf_temp_v_"+lin,JSON.stringify(otrs));
								window.sessionStorage.setItem("Graf_temp_f_"+lin,JSON.stringify(otrs2));
							}
							
							if (estatus.indexOf("Lower") > -1) {
								
								toastr.success('Evento con sensor temperatura \n con el numéro ' + textDato.number + '\n del elemento ' + nombreEle + '\n está con estatus Normal \n y con valor ' + otru + ' y el dia ' + fecham + ' y hora ' + hourm);

								var nume = parseInt($("#numaproa").html()) + 1;
								$("#numaproa").html(nume);
								var nuevo = '<li id="texto' + nume + 'w"><div class="dropdown-messages-box"><a class="pull-left"><img alt="image" class="img-circle" src="img/m2m.png"></a><div class="media-body" onclick="javascript:leido(' + String.fromCharCode(39) + nume + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '000000000' + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '1' + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '000000000' + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '000000000' + String.fromCharCode(39) + ');"><small class="pull-right">' + moment().format('MMMM Do YYYY, h:mm:ss a') + '</small><strong>El elemento temperatura siendo el sensor con resultado Normal</strong> <br><small class="text-muted">Web</small></div></div></li><li id="div' + nume + 'w" class="divider"></li>' + $("#menusListaa").html();
								$("#menusListaa").html(nuevo);

							} else if (estatus.indexOf("Normal") > -1) {

								toastr.info('Evento con sensor temperatura \n con el numéro ' + textDato.number + '\n del elemento ' + nombreEle + '\n está con estatus Bajo \n con valor ' + otru + ' y el dia ' + fecham + ' y hora ' + hourm);

								var nume = parseInt($("#numaproa").html()) + 1;
								$("#numaproa").html(nume);
								var nuevo = '<li id="texto' + nume + 'w"><div class="dropdown-messages-box"><a class="pull-left"><img alt="image" class="img-circle" src="img/m2m.png"></a><div class="media-body" onclick="javascript:leido(' + String.fromCharCode(39) + nume + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '000000000' + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '1' + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '000000000' + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '000000000' + String.fromCharCode(39) + ');"><small class="pull-right">' + moment().format('MMMM Do YYYY, h:mm:ss a') + '</small><strong>El elemento temperatura siendo el sensor con resultado Bajo</strong> <br><small class="text-muted">Web</small></div></div></li><li id="div' + nume + 'w" class="divider"></li>' + $("#menusListaa").html();
								$("#menusListaa").html(nuevo);

							} else if (estatus.indexOf("Higher") > -1) {

								toastr.error('Evento con sensor temperatura \n con el numéro ' + textDato.number + '\n del elemento ' + nombreEle + '\n está con estatus Alto \n con valor ' + otru + ' y el dia ' + fecham + ' y hora ' + hourm);

								var nume = parseInt($("#numaprob").html()) + 1;
								$("#numaprob").html(nume);
								var nuevo = '<li id="texto' + nume + 'k"><div class="dropdown-messages-box"><a class="pull-left"><img alt="image" class="img-circle" src="img/m2m.png"></a><div class="media-body" onclick="javascript:leido(' + String.fromCharCode(39) + nume + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '000000000' + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '2' + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '000000000' + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '000000000' + String.fromCharCode(39) + ');"><small class="pull-right">' + moment().format('MMMM Do YYYY, h:mm:ss a') + '</small><strong>El elemento temperatura siendo el sensor con resultado Alto</strong> <br><small class="text-muted">Web</small></div></div></li><li id="div' + nume + 'k" class="divider"></li>' + $("#menusListab").html();
								$("#menusListab").html(nuevo);

							}
							
						}
						
						if (infe.indexOf("Humi")>-1){
							var es = infe.split(":");
							var oues = es[1].split(",");
							var otru = oues[0];
							var estatus = oues[1]; 
							
							var lin2 = textDato.number.replace("+","");
							var lin = lin2.replace(" ","");
							if(window.sessionStorage.getItem("Graf_hume_v_"+lin)==null){
								var nuebs = [otru];
								var nuebs2 = [textDato.time];
								window.sessionStorage.setItem("Graf_hume_v_"+lin,JSON.stringify(nuebs));
								window.sessionStorage.setItem("Graf_hume_f_"+lin,JSON.stringify(nuebs2));
							}else{
								var otrs = JSON.parse(window.sessionStorage.getItem("Graf_hume_v_"+lin));
								var otrs2 = JSON.parse(window.sessionStorage.getItem("Graf_hume_f_"+lin));
								otrs.push(otru);
								otrs2.push(textDato.time);
								window.sessionStorage.setItem("Graf_hume_v_"+lin,JSON.stringify(otrs));
								window.sessionStorage.setItem("Graf_hume_f_"+lin,JSON.stringify(otrs2));
							}
							
							if (estatus.indexOf("Lower") > -1) {

								toastr.success('Evento con sensor humedad \n con el numéro ' + textDato.number + '\n del elemento ' + nombreEle + '\n está con estatus Normal \n y con valor ' + otru + ' y el dia ' + fecham + ' y hora ' + hourm);

								var nume = parseInt($("#numaproa").html()) + 1;
								$("#numaproa").html(nume);
								var nuevo = '<li id="texto' + nume + 'w"><div class="dropdown-messages-box"><a class="pull-left"><img alt="image" class="img-circle" src="img/m2m.png"></a><div class="media-body" onclick="javascript:leido(' + String.fromCharCode(39) + nume + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '000000000' + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '1' + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '000000000' + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '000000000' + String.fromCharCode(39) + ');"><small class="pull-right">' + moment().format('MMMM Do YYYY, h:mm:ss a') + '</small><strong>El elemento humedad siendo el sensor con resultado Normal</strong> <br><small class="text-muted">Web</small></div></div></li><li id="div' + nume + 'w" class="divider"></li>' + $("#menusListaa").html();
								$("#menusListaa").html(nuevo);

							} else if (estatus.indexOf("Normal") > -1) {

								toastr.info('Evento con sensor humedad \n con el numéro ' + textDato.number + '\n del elemento ' + nombreEle + '\n está con estatus Bajo \n con valor ' + otru + ' y el dia ' + fecham + ' y hora ' + hourm);

								var nume = parseInt($("#numaproa").html()) + 1;
								$("#numaproa").html(nume);
								var nuevo = '<li id="texto' + nume + 'w"><div class="dropdown-messages-box"><a class="pull-left"><img alt="image" class="img-circle" src="img/m2m.png"></a><div class="media-body" onclick="javascript:leido(' + String.fromCharCode(39) + nume + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '000000000' + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '1' + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '000000000' + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '000000000' + String.fromCharCode(39) + ');"><small class="pull-right">' + moment().format('MMMM Do YYYY, h:mm:ss a') + '</small><strong>El elemento humedad siendo el sensor con resultado Bajo</strong> <br><small class="text-muted">Web</small></div></div></li><li id="div' + nume + 'w" class="divider"></li>' + $("#menusListaa").html();
								$("#menusListaa").html(nuevo);

							} else if (estatus.indexOf("Higher") > -1) {

								toastr.error('Evento con sensor humedad \n con el numéro ' + textDato.number + '\n del elemento ' + nombreEle + '\n está con estatus Alto \n con valor ' + otru + ' y el dia ' + fecham + ' y hora ' + hourm);

								var nume = parseInt($("#numaprob").html()) + 1;
								$("#numaprob").html(nume);
								var nuevo = '<li id="texto' + nume + 'k"><div class="dropdown-messages-box"><a class="pull-left"><img alt="image" class="img-circle" src="img/m2m.png"></a><div class="media-body" onclick="javascript:leido(' + String.fromCharCode(39) + nume + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '000000000' + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '2' + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '000000000' + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '000000000' + String.fromCharCode(39) + ');"><small class="pull-right">' + moment().format('MMMM Do YYYY, h:mm:ss a') + '</small><strong>El elemento humedad siendo el sensor con resultado Alto</strong> <br><small class="text-muted">Web</small></div></div></li><li id="div' + nume + 'k" class="divider"></li>' + $("#menusListab").html();
								$("#menusListab").html(nuevo);

							}
						}
						
						if ((infe.indexOf("Higher")>-1 || infe.indexOf("Lower")>-1 || infe.indexOf("Normal")>-1) && (infe.indexOf("DIN")>-1 || infe.indexOf("AIN")>-1)){
							
							if(infe.indexOf("DIN")>-1){
								var es = infe.split(":"),estatus ="";
								var sensor = es[0];
								var valorYEstado = es[1].split(",");
								var valor = valorYEstado[0];
								
								if(valor!=="NO" || valor!=="NC"){
									var lin2 = textDato.number.replace("+","");
									var lin = lin2.replace(" ","");
									if(window.sessionStorage.getItem("Graf_din_v_"+sensor+"_"+lin)==null){
										var nuebs = [valor];
										var nuebs2 = [textDato.time];
										window.sessionStorage.setItem("Graf_din_v_"+sensor+"_"+lin,JSON.stringify(nuebs));
										window.sessionStorage.setItem("Graf_din_f_"+sensor+"_"+lin,JSON.stringify(nuebs2));
									}else{
										var otrs = JSON.parse(window.sessionStorage.getItem("Graf_din_v_"+sensor+"_"+lin));
										var otrs2 = JSON.parse(window.sessionStorage.getItem("Graf_din_f_"+sensor+"_"+lin));
										otrs.push(valor);
										otrs2.push(textDato.time);
										window.sessionStorage.setItem("Graf_din_v_"+sensor+"_"+lin,JSON.stringify(otrs));
										window.sessionStorage.setItem("Graf_din_f_"+sensor+"_"+lin,JSON.stringify(otrs2));
									}
								}else{
									var lin2 = textDato.number.replace("+","");
									var lin = lin2.replace(" ","");
									if(window.sessionStorage.getItem("Graf_din_v_"+sensor+"_"+lin)==null){
										var nuebs = [0];
										var nuebs2 = [textDato.time];
										window.sessionStorage.setItem("Graf_din_v_"+sensor+"_"+lin,JSON.stringify(nuebs));
										window.sessionStorage.setItem("Graf_din_f_"+sensor+"_"+lin,JSON.stringify(nuebs2));
									}else{
										var otrs = JSON.parse(window.sessionStorage.getItem("Graf_din_v_"+sensor+"_"+lin));
										var otrs2 = JSON.parse(window.sessionStorage.getItem("Graf_din_f_"+sensor+"_"+lin));
										otrs.push(0);
										otrs2.push(textDato.time);
										window.sessionStorage.setItem("Graf_din_v_"+sensor+"_"+lin,JSON.stringify(otrs));
										window.sessionStorage.setItem("Graf_din_f_"+sensor+"_"+lin,JSON.stringify(otrs2));
									}
								}
								
							}
							
							if(infe.indexOf("AIN")>-1){
								var es = infe.split(":"),estatus ="";
								var sensor = es[0];
								var valorYEstado = es[1].split(",");
								var valor = valorYEstado[0];
								
								if(valor!=="NO" || valor!=="NC"){
									var lin2 = textDato.number.replace("+","");
									var lin = lin2.replace(" ","");
									if(window.sessionStorage.getItem("Graf_ain_v_"+sensor+"_"+lin)==null){
										var nuebs = [valor];
										var nuebs2 = [textDato.time];
										window.sessionStorage.setItem("Graf_ain_v_"+sensor+"_"+lin,JSON.stringify(nuebs));
										window.sessionStorage.setItem("Graf_ain_f_"+sensor+"_"+lin,JSON.stringify(nuebs2));
									}else{
										var otrs = JSON.parse(window.sessionStorage.getItem("Graf_ain_v_"+sensor+"_"+lin));
										var otrs2 = JSON.parse(window.sessionStorage.getItem("Graf_ain_f_"+sensor+"_"+lin));
										otrs.push(valor);
										otrs2.push(textDato.time);
										window.sessionStorage.setItem("Graf_ain_v_"+sensor+"_"+lin,JSON.stringify(otrs));
										window.sessionStorage.setItem("Graf_ain_f_"+sensor+"_"+lin,JSON.stringify(otrs2));
									}
								}else{
									var lin2 = textDato.number.replace("+","");
									var lin = lin2.replace(" ","");
									if(window.sessionStorage.getItem("Graf_ain_v_"+sensor+"_"+lin)==null){
										var nuebs = [0];
										var nuebs2 = [textDato.time];
										window.sessionStorage.setItem("Graf_ain_v_"+sensor+"_"+lin,JSON.stringify(nuebs));
										window.sessionStorage.setItem("Graf_ain_f_"+sensor+"_"+lin,JSON.stringify(nuebs2));
									}else{
										var otrs = JSON.parse(window.sessionStorage.getItem("Graf_ain_v_"+sensor+"_"+lin));
										var otrs2 = JSON.parse(window.sessionStorage.getItem("Graf_ain_f_"+sensor+"_"+lin));
										otrs.push(0);
										otrs2.push(textDato.time);
										window.sessionStorage.setItem("Graf_ain_v_"+sensor+"_"+lin,JSON.stringify(otrs));
										window.sessionStorage.setItem("Graf_ain_f_"+sensor+"_"+lin,JSON.stringify(otrs2));
									}
								}
							}
							
							var nombrex="";
							
							var nues = textDato.number.replace("+","");
							var nues2 = nues.replace(" ","");
							
							var doto = JSON.parse(window.sessionStorage.getItem("punteados"));
							for (var hx = 0; hx < doto.length; hx++) {
																
								if (doto[hx].tel == "+"+nues2) {
									var nombr = doto[hx].nom;
										nombrex = doto[hx].nom;
									
									var exits = doto[hx].ico.replace("/img/m2m/","");
									var icones2 = exits.replace("c.png",""),
										icones3 = icones2.replace("v.png",""),
										icones = icones3.replace("r.png","");
									
									if (infe.indexOf("Lower")>-1){
										doto[hx].ico = "/img/m2m/"+icones+"v.png";
									}else if (infe.indexOf("Normal")>-1){
										doto[hx].ico = "/img/m2m/"+icones+"c.png";
									}else if (infe.indexOf("Higher")>-1){
										doto[hx].ico = "/img/m2m/"+icones+"r.png";
									}
									
									updateBd(doto[hx].ico,nombr);
									
								}
							}
							
							window.sessionStorage.setItem("punteados",JSON.stringify(doto));
							
							var es = infe.split(":"),estatus ="";
							var sensor = es[0];
							var esta = es[1].split(",");
							var otru = esta[0];
							var timesr = textDato.time.split(" "),fecham = timesr[0],hourm = timesr[1];
							
							if (infe.indexOf("Lower") > -1) {

								estatus = "Bajo";
								toastr.success('Evento con sensor ' + sensor + '\n con el numéro ' + textDato.number + '\n del elemento ' + nombreEle + '\n está con estatus ' + estatus + '\n y con valor ' + otru + ' y el dia ' + fecham + ' y hora ' + hourm);

								var nume = parseInt($("#numaproa").html()) + 1;
								$("#numaproa").html(nume);
								var nuevo = '<li id="texto' + nume + 'w"><div class="dropdown-messages-box"><a class="pull-left"><img alt="image" class="img-circle" src="img/m2m.png"></a><div class="media-body" onclick="javascript:leido(' + String.fromCharCode(39) + nume + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '000000000' + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '1' + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '000000000' + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '000000000' + String.fromCharCode(39) + ');"><small class="pull-right">' + moment().format('MMMM Do YYYY, h:mm:ss a') + '</small><strong>El elemento ' + nombreEle + ' siendo el sensor ' + sensor + ' con resultado Normal</strong> <br><small class="text-muted">Web</small></div></div></li><li id="div' + nume + 'w" class="divider"></li>' + $("#menusListaa").html();
								$("#menusListaa").html(nuevo);

							} else if (infe.indexOf("Normal") > -1) {

								estatus = "Normal";
								toastr.info('Evento con sensor ' + sensor + '\n con el numéro ' + textDato.number + '\n del elemento ' + nombreEle + '\n está con estatus ' + estatus + '\n con valor ' + otru + ' y el dia ' + fecham + ' y hora ' + hourm);

								var nume = parseInt($("#numaproa").html()) + 1;
								$("#numaproa").html(nume);
								var nuevo = '<li id="texto' + nume + 'w"><div class="dropdown-messages-box"><a class="pull-left"><img alt="image" class="img-circle" src="img/m2m.png"></a><div class="media-body" onclick="javascript:leido(' + String.fromCharCode(39) + nume + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '000000000' + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '1' + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '000000000' + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '000000000' + String.fromCharCode(39) + ');"><small class="pull-right">' + moment().format('MMMM Do YYYY, h:mm:ss a') + '</small><strong>El elemento ' + nombreEle + ' siendo el sensor ' + sensor + ' con resultado Bajo</strong> <br><small class="text-muted">Web</small></div></div></li><li id="div' + nume + 'w" class="divider"></li>' + $("#menusListaa").html();
								$("#menusListaa").html(nuevo);

							} else if (infe.indexOf("Higher") > -1) {

								estatus = "Alto";
								toastr.error('Evento con sensor ' + sensor + '\n con el numéro ' + textDato.number + '\n del elemento ' + nombreEle + '\n está con estatus ' + estatus + '\n con valor ' + otru + ' y el dia ' + fecham + ' y hora ' + hourm);

								var nume = parseInt($("#numaprob").html()) + 1;
								$("#numaprob").html(nume);
								var nuevo = '<li id="texto' + nume + 'k"><div class="dropdown-messages-box"><a class="pull-left"><img alt="image" class="img-circle" src="img/m2m.png"></a><div class="media-body" onclick="javascript:leido(' + String.fromCharCode(39) + nume + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '000000000' + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '2' + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '000000000' + String.fromCharCode(39) + ',' + String.fromCharCode(39) + '000000000' + String.fromCharCode(39) + ');"><small class="pull-right">' + moment().format('MMMM Do YYYY, h:mm:ss a') + '</small><strong>El elemento ' + nombreEle + ' siendo el sensor ' + sensor + ' con resultado Alto</strong> <br><small class="text-muted">Web</small></div></div></li><li id="div' + nume + 'k" class="divider"></li>' + $("#menusListab").html();
								$("#menusListab").html(nuevo);

							} 

						}
					
					}
				}
				
				window.sessionStorage.setItem("ultimoPopup", infos + textDato.time);
				
				tiempoReal();
				
			});
			
			*/
		}
		
		$('#divId').timer({
			duration: '10s',
			callback: function() {
				//if (window.sessionStorage.getItem("smsInbox")){
				//if (window.sessionStorage.getItem("readHistory24")){
					lectura();
					//$("#bar1").css("width","70%");
					$("#bar1").text("Sin red");
					$("#bar1").removeClass("progress-bar-warning").removeClass("progress-bar-success");
					$("#bar1").addClass("progress-bar-danger");
				//}
			},
			repeat: true
		});
		
		function preguntarEstatus(cel,pass){
			
			if(window.sessionStorage.getItem("turnoConsulta")=="1"){
				window.sessionStorage.setItem("turnoConsulta","2");
				envioSms(cel,pass+"AINE");
			}else if(window.sessionStorage.getItem("turnoConsulta")=="2"){
				window.sessionStorage.setItem("turnoConsulta","3");
				envioSms(cel,pass+"DOE");
			}else if(window.sessionStorage.getItem("turnoConsulta")=="3"){
				window.sessionStorage.setItem("turnoConsulta","1");
				envioSms(cel,pass+"DINE");
			}
			
			if (!window.sessionStorage.getItem("creADOgraf"+cel)){
			
				if (window.sessionStorage.getItem("ConseGraf")){
					var num = parseInt(window.sessionStorage.getItem("ConseGraf")) + 1;
					window.sessionStorage.setItem("ConseGraf",num);
				}else{
					window.sessionStorage.setItem("ConseGraf","0");
				}
				var nestr = parseInt(window.sessionStorage.getItem("ConseGraf"));
				window.sessionStorage.setItem("creADOgraf"+cel,nestr);
			}
			
		}
		
		$('#divId2').timer({
			duration: '7s', //paso a ser 7 seg || antes eran 1s
			callback: function() {
				if (window.sessionStorage.getItem("punteados")){
					popups();
				}
				if(window.sessionStorage.getItem("recargar")){
					if (window.sessionStorage.getItem("recargar")=="9"){ // 1 minuto con 3 segundos = 7seg *9 iteraciones  || antes eran 60seg
						window.sessionStorage.removeItem("recargar");
						init();
						
						if ($("#bar2").text()=="On Sms."){
							$("#bar2").text("Off Sms");
							$("#bar2").removeClass("progress-bar-success").removeClass("progress-bar-success");
							$("#bar2").addClass("progress-bar-danger");
						}
						
					}else{
						var inits = parseInt(window.sessionStorage.getItem("recargar")) + 1;
						window.sessionStorage.setItem("recargar",inits);
					}
				}else{
					window.sessionStorage.setItem("recargar","0");
				}
				if(window.sessionStorage.getItem("recargar2")){
					if (window.sessionStorage.getItem("recargar2")=="3"){ //42 segundos = 7seg *6 iteraciones || antes eran 40seg
						window.sessionStorage.removeItem("recargar2");
						/*var ver = JSON.parse(window.sessionStorage.getItem("punteados"));
						for (var h = 0; h < ver.length; h++){
							//preguntarEstatus(ver[h].tel,ver[h].pass);
						}*/
					}else{
						var inits = parseInt(window.sessionStorage.getItem("recargar2")) + 1;
						window.sessionStorage.setItem("recargar2",inits);
					}
				}else{
					window.sessionStorage.setItem("recargar2","0");
				}
			},
			repeat: true
		});
		
        function init() {
		
			window.sessionStorage.setItem("turnoConsulta","1");
			
			if (window.sessionStorage.getItem("punteados") && !window.sessionStorage.getItem("tramaActivar")){
				var accion = JSON.parse(window.sessionStorage.getItem("punteados"));
				for (var m = 0; m < accion.length; m++){
					//envioSms(accion[m].tel,accion[m].pass+"GPRSonline");
					var nuevo = accion[m].tel.replace("+","");
					window.sessionStorage.setItem("Relays_"+nuevo,JSON.stringify({"DO0":"Close","DO1":"Close","DO2":"Close","DO3":"Close"}));
				}
				window.sessionStorage.setItem("tramaActivar","true")
			}
			
			if(!window.sessionStorage.getItem("Encendidos")){
				var auth = JSON.parse(window.sessionStorage.getItem("sesion"));
				var token = auth.t,email = auth.e;
				backend.query({"t":token,"e":email,"a":"readRelaysOn"},block.ip,"8088",function(salida){
					var das = JSON.parse(salida);
					if (!das.e){
						var lista = JSON.parse(das.m);
						window.sessionStorage.setItem("Encendidos",JSON.stringify(lista.m));
					}
				});
			}
			
			if(!window.sessionStorage.getItem("Apagados")){
				var auth = JSON.parse(window.sessionStorage.getItem("sesion"));
				var token = auth.t,email = auth.e;
				backend.query({"t":token,"e":email,"a":"readRelaysOff"},block.ip,"8088",function(salida){
					var das = JSON.parse(salida);
					if (!das.e){
						var lista = JSON.parse(das.m);
						window.sessionStorage.setItem("Apagados",JSON.stringify(lista.m));
					}
				});
			}
			
			if (!window.sessionStorage.getItem("punteados")){
			
				var auth = JSON.parse(window.sessionStorage.getItem("sesion"));
				var token = auth.t,email = auth.e;
				backend.query({"t":token,"e":email,"a":"readElements"},block.ip,"8088",function(salida){
					var das = JSON.parse(salida);
					if (!das.e){
						var nuevos = das.m;
						var lista = JSON.parse(nuevos);
						window.sessionStorage.setItem("punteados",JSON.stringify(lista.m));
						toastr.info('Cargando elementos de la base de datos');
						
						window.location.reload();
				
					}else{
						toastr.info('Ocurrio un problema con su conexión de red');
					}
				});
				
			}else{
			
				var mapOptions = {
					zoom: 5,
					center: new google.maps.LatLng(-9.68555830,-75.5999461)
				};
				
				var mapElement = document.getElementById('map');
				var map = new google.maps.Map(mapElement, mapOptions);
				
				var fenway = new google.maps.LatLng(-9.68555830,-75.5999461);
				var panoramaOptions = {
					position: fenway,
					pov: {
						heading: 10,
						pitch: 10
					}
				};
				
				var marker;
				var infowindow = new google.maps.InfoWindow();
				
				if (window.sessionStorage.getItem("punteados")){
					var ver = JSON.parse(window.sessionStorage.getItem("punteados"));
					for (var h = 0; h < ver.length; h++){
					
						var todo = ver[h];
						
						marker = new google.maps.Marker({
							map: map,
							icon: todo.ico,
							position: new google.maps.LatLng(todo.lat,todo.log)
						});
						
						
						google.maps.event.addListener(marker, 'click', (function (marker,h) {
							return function () {
								configPunteo(ver[h]);
							}
						})(marker,h));
						
						var myoverlay = new google.maps.OverlayView();
						myoverlay.draw = function () {
							this.getPanes().markerLayer.id='markerLayer';
						};
						myoverlay.setMap(map);
						
					}
				}
				
			}
			
		}
		
		function deleteBd(tel){
		
			var auth = JSON.parse(window.sessionStorage.getItem("sesion"));
			var token = auth.t,email = auth.e;
			backend.query({"t":token,"e":email,"a":"delElements","d":tel},block.ip,"8088",function(salida){
				var das = JSON.parse(salida);
				if (!das.e){
					toastr.info('Eliminado elemento en la base de datos');
					
				}else{
					toastr.info('Ocurrio un problema con su conexión de red');
				}
			});
		
		}
		
		function eliminarPunteo(tel){
		
			if (window.sessionStorage.getItem("punteados")){
			
				swal({
				  title: "Confirmar",
				  text: "Desea eliminar elemento aqui con teléfono "+tel,
				  icon: "warning",
				  buttons: true,
				  dangerMode: true,
				}).then((willDelete) => {
				  if (willDelete) {
					
					
					var nuevo = [];
					var ver = JSON.parse(window.sessionStorage.getItem("punteados"));
					for (var h = 0; h < ver.length; h++){
						if (ver[h].tel !== tel){
							nuevo.push(ver[h]);
						}
					}
					window.sessionStorage.setItem("punteados",JSON.stringify(nuevo));
				
					init();
					
					deleteBd(tel);
					
					var nuevox = tel.replace("+","");
					window.sessionStorage.removeItem("Relays_"+nuevox);
					window.sessionStorage.removeItem("Relays_"+nuevox+"_DO0");
					window.sessionStorage.removeItem("Relays_"+nuevox+"_DO1");
					window.sessionStorage.removeItem("Relays_"+nuevox+"_DO2");
					window.sessionStorage.removeItem("Relays_"+nuevox+"_DO3");
				
				  }
				});
				
			}	
			
		}
		
		function addBd(dato){
			var auth = JSON.parse(window.sessionStorage.getItem("sesion"));
			var token = auth.t,email = auth.e;
			backend.query({"t":token,"e":email,"a":"addElements","d":dato},block.ip,"8088",function(salida){
				var das = JSON.parse(salida);
				if (!das.e){
					toastr.info('Registrado elemento en la base de datos');
					
				}else{
					toastr.info('Ocurrio un problema con su conexión de red');
				}
			});
		}
		
		function agregar(lat, log, imagen){
		
			function agregarYa(lat,log,imagen,portu,nombre,telefono,pass){
					
				var add = {"lat":lat,"log":log,"ico":imagen,"nom":nombre,"tel":telefono,"pass":pass,"port":portu};
				
				if (window.sessionStorage.getItem("punteados")){
					var agrega = JSON.parse(window.sessionStorage.getItem("punteados"));
					agrega.push(add);
					window.sessionStorage.setItem("punteados",JSON.stringify(agrega));
				}else{
					var agrega = [add];
					window.sessionStorage.setItem("punteados",JSON.stringify(agrega));
				}
				
				init();
				addBd(add);
				
			}
				
			function passwors(lat, log, imagen,portu,nombre,telefono){
				swal("Inserte contraseña numérica de 4 digitos del elemento:", {
				  content: "input",
				  attributes: {
					  placeholder: "1234",
					  type: "password",
				  }
				}).then((value) => {
					
					if (!value){
						toastr.info('El elemento tendrá su password por default 1234');	
						agregarYa(lat,log,imagen,portu,nombre,telefono,"1234");
					}else{
						var req = /[0-9]{1,5}/;
						if (req.test(value)){
							agregarYa(lat,log,imagen,portu,nombre,telefono,value);
						}else{
							passwors(lat,log,imagen,portu,nombre,telefono);
						}
					}
				});
			}
		
			function pedirtelefono(lat, log, imagen,portu,nombre){
				
				swal("Inserte teléfono del elemento:", {
				  content: "input",
				}).then((value) => {
					var req = /[0-9]{1,30}/;
					if (value && req.test(value)){
						passwors(lat, log, imagen,portu,nombre,value)
					}else{
						toastr.info('Solo acepta de 1 a 30 caracteres alfanuméricos mas el operador +');
						pedirtelefono(lat, log, imagen,portu,nombre);
					}
				});
				
			}
				
			function pedirNombre(lat, log, imagen, portu){
				swal("Inserte nombre del elemento:", {
				  content: "input",
				}).then((value) => {
					var req = /[a-zA-Z0-9]{1,300}/;
					if (value && req.test(value)){
						pedirtelefono(lat, log, imagen,portu,value)
					}else{
						toastr.info('Solo acepta de 1 a 300 caracteres alfanuméricos');
						pedirNombre(lat, log, imagen,portu);
					}
				});			
			}
			
			function puertoTrama(lat, log, imagen){
				swal("Inserte puerto websocket del elemento para recibir trama:", {
				  content: "input",
				}).then((value) => {
					var req = /[0-9]{1,10}/;
					if (value && req.test(value)){
						pedirNombre(lat, log, imagen,value)
					}else{
						toastr.info('Solo acepta de 1 a 10 caracteres numéricos');
						puertoTrama(lat, log, imagen);
					}
				});			
			}
			
			puertoTrama(lat, log, imagen);
			
		}
		
		function recargarInitTime(){
			window.sessionStorage.setItem("recargar","1");
		}
		
		function puntero(imagen){
			
			$("#iconModal").modal('hide');
			
			 var mapOptions = {
				zoom: 5,
				center: new google.maps.LatLng(-9.68555830,-75.5999461)
			};
			
			var mapElement = document.getElementById('map');
			var map = new google.maps.Map(mapElement, mapOptions);
			
			var marker;
			var coords = {};
			
			marker = new google.maps.Marker({
				icon: imagen,
				map: map,
				draggable: true,
				animation: google.maps.Animation.DROP,
				position: new google.maps.LatLng(-9.685559,-75.599940),
			});
			marker.addListener('click', toggleBounce);
			marker.addListener('dragend', function (event){

				swal({
				  title: "Confirmar",
				  text: "Desea agregar elemento aqui",
				  icon: "warning",
				  buttons: true,
				  dangerMode: true,
				})
				.then((willDelete) => {
				  if (willDelete) {
					agregar(event.latLng.lat(),event.latLng.lng(),imagen);
				  }else{
					recargarInitTime();
				  }
				});
				
			});
			function toggleBounce() {
			  if (marker.getAnimation() !== null) {
				marker.setAnimation(null);
			  } else {
				marker.setAnimation(google.maps.Animation.BOUNCE);
			  }
			}
			
			var myoverlay = new google.maps.OverlayView();
			myoverlay.draw = function () {
				this.getPanes().markerLayer.id='markerLayer';
			};
			myoverlay.setMap(map);
			
		}
		
		$("#salir").click(function(){
			window.sessionStorage.removeItem("sesion");
			window.sessionStorage.removeItem("punteados");
			window.sessionStorage.removeItem("smsInbox");
			window.sessionStorage.removeItem("ultimoPopup");
			setTimeout(function(){
				location.href = "/index.html";
			},1000);
		});
		
    </script>
	
	<div id="menu" style="display:none; height: 67%;width: 94%;position: fixed;z-index: 999999; overflow-y: scroll;bottom: 12%;left: 2%; box-sizing: border-box;">
		<div class="ibox float-e-margins">
			<div class="ibox-title">
				<h5>Selección de vistas para trama</h5>
			</div>
			
			<div class="ibox-content col-xs-12 col-md-4 col-sm-4" style="clear: initial;">
				<ul class="todo-list m-t small-list">
					<li>
						<a onclick="javascript:ain0();"  class="check-link"><i class="fa fa-check-square"></i> </a>
						<span class="m-l-xs todo-completed">Ain 0 </span>
					</li>
					<li>
						<a onclick="javascript:ain1();"  class="check-link"><i class="fa fa-check-square"></i> </a>
						<span class="m-l-xs todo-completed">Ain 1 </span>
					</li>
					<li>
						<a onclick="javascript:ain2();" class="check-link"><i class="fa fa-check-square"></i> </a>
						<span class="m-l-xs todo-completed">Ain 2 </span>
					</li>
					<li>
						<a onclick="javascript:ain3();" class="check-link"><i class="fa fa-check-square"></i> </a>
						<span class="m-l-xs todo-completed">Ain 3 </span>
					</li>
					<li>
						<a onclick="javascript:ain4();" class="check-link"><i class="fa fa-check-square"></i> </a>
						<span class="m-l-xs todo-completed">Ain 4 </span>
					</li>
					<li>
						<a onclick="javascript:ain5();" class="check-link"><i class="fa fa-check-square"></i> </a>
						<span class="m-l-xs todo-completed">Ain 5</span>
					</li>
					<li>
						<a onclick="javascript:ain6();" class="check-link"><i class="fa fa-check-square"></i> </a>
						<span class="m-l-xs todo-completed">Ain 6</span>
					</li>
					<li>
						<a onclick="javascript:ain7();" class="check-link"><i class="fa fa-check-square"></i> </a>
						<span class="m-l-xs todo-completed">Ain 7</span>
					</li>
					<li>
						<a onclick="javascript:batery_voltage();" class="check-link"><i class="fa fa-check-square"></i> </a>
						<span class="m-l-xs todo-completed">Battery Voltage</span>
					</li>
				</ul>
			</div>
			<div class="ibox-content col-xs-12 col-md-4 col-sm-4" style="clear: initial;">
				<ul class="todo-list m-t small-list">
					<li>
						<a onclick="javascript:dim1();" class="check-link"><i class="fa fa-check-square"></i> </a>
						<span class="m-l-xs todo-completed">Din 0 </span>
					</li>
					<li>
						<a onclick="javascript:dim2();" class="check-link"><i class="fa fa-check-square"></i> </a>
						<span class="m-l-xs todo-completed">Din 1 </span>
					</li>
					<li>
						<a onclick="javascript:dim3();" class="check-link"><i class="fa fa-check-square"></i> </a>
						<span class="m-l-xs todo-completed">Din 2 </span>
					</li>
					<li>
						<a onclick="javascript:dim4();" class="check-link"><i class="fa fa-check-square"></i> </a>
						<span class="m-l-xs todo-completed">Din 3 </span>
					</li>
					<li>
						<a onclick="javascript:dim5();" class="check-link"><i class="fa fa-check-square"></i> </a>
						<span class="m-l-xs todo-completed">Din 4 </span>
					</li>
					<li>
						<a onclick="javascript:dim6();" class="check-link"><i class="fa fa-check-square"></i> </a>
						<span class="m-l-xs todo-completed">Din 5</span>
					</li>
					<li>
						<a onclick="javascript:dim7();" class="check-link"><i class="fa fa-check-square"></i> </a>
						<span class="m-l-xs todo-completed">Din 6</span>
					</li>
					<li>
						<a onclick="javascript:dim8();" class="check-link"><i class="fa fa-check-square"></i> </a>
						<span class="m-l-xs todo-completed">Din 7</span>
					</li>
					<li>
						<a onclick="javascript:temperature();" class="check-link"><i class="fa fa-check-square"></i> </a>
						<span class="m-l-xs todo-completed">Temperature</span>
					</li>
				</ul>
			</div>
			<div class="ibox-content col-xs-12 col-md-4 col-sm-4" style="clear: initial;">
				<ul class="todo-list m-t small-list">
					<li>
						<a onclick="javascript:ac_power();" class="check-link"><i class="fa fa-check-square"></i> </a>
						<span class="m-l-xs todo-completed">Ac power</span>
					</li>
					<li>
						<a onclick="javascript:gsm_signal();" class="check-link"><i class="fa fa-check-square"></i> </a>
						<span class="m-l-xs todo-completed">Gsm signal</span>
					</li>
					<li>
						<a onclick="javascript:arm_disarm();" class="check-link"><i class="fa fa-check-square"></i> </a>
						<span class="m-l-xs todo-completed">Arm/Disarm</span>
					</li>
					<li>
						<a onclick="javascript:voltage_external();" class="check-link"><i class="fa fa-check-square"></i> </a>
						<span class="m-l-xs todo-completed">Voltage External</span>
					</li>
					<li>
						<a onclick="javascript:dout1();" class="check-link"><i class="fa fa-check-square"></i> </a>
						<span class="m-l-xs todo-completed">Dout 1</span>
					</li>
					<li>
						<a onclick="javascript:dout2();" class="check-link"><i class="fa fa-check-square"></i> </a>
						<span class="m-l-xs todo-completed">Dout 2</span>
					</li>
					<li>
						<a onclick="javascript:dout3();" class="check-link"><i class="fa fa-check-square"></i> </a>
						<span class="m-l-xs todo-completed">Dout 3</span>
					</li>
					<li>
						<a onclick="javascript:dout4();" class="check-link"><i class="fa fa-check-square"></i> </a>
						<span class="m-l-xs todo-completed">Dout 4</span>
					</li>
					<li>
						<a onclick="javascript:humedy();" class="check-link"><i class="fa fa-check-square"></i> </a>
						<span class="m-l-xs todo-completed">Humedy</span>
					</li>
				</ul>
			</div>
			
		</div>
	</div>
	
	<div id="menu2" style="display:none; overflow-y: scroll; height: 65%;width: 94%;position: fixed;z-index: 999999;bottom: 11%;left: 2%; box-sizing: border-box;">
		<div class="ibox float-e-margins">
			<div class="ibox-title">
				<h5>Lista habilitada de alarmas</h5>
			</div>
			
			<div class="ibox-content col-xs-12 col-md-4 col-sm-4" style="clear: initial;">
				<table class="table table-stripped small m-t-md">
					<tbody>
					<tr>
						<td class="no-borders">
							<i id="ain0I" class="fa fa-circle text-success"></i>
						</td>
						<td class="no-borders" id ="ain0T">Sin datos</td>
					</tr>
					<tr>
						<td>
							<i id="ain1I" class="fa fa-circle text-success"></i>
						</td>
						<td id ="ain1T">Sin datos</td>
					</tr>
					<tr>
						<td>
							<i id ="ain2I" class="fa fa-circle text-success"></i>
						</td>
						<td id ="ain2T">Sin datos</td>
					</tr>
					<tr>
						<td>
							<i id ="ain3I" class="fa fa-circle text-success"></i>
						</td>
						<td id ="ain3T">Sin datos</td>
					</tr>
					<tr>
						<td>
							<i id ="ain4I" class="fa fa-circle text-success"></i>
						</td>
						<td id ="ain4T">Sin datos</td>
					</tr>
					<tr>
						<td>
							<i id ="ain5I" class="fa fa-circle text-success"></i>
						</td>
						<td id ="ain5T">Sin datos</td>
					</tr>
					<tr>
						<td>
							<i id ="ain6I" class="fa fa-circle text-success"></i>
						</td>
						<td id ="ain6T">Sin datos</td>
					</tr>
					<tr>
						<td>
							<i id ="ain7I" class="fa fa-circle text-success"></i>
						</td>
						<td id ="ain7T">Sin datos</td>
					</tr>
					<tr>
						<td>
							<i id ="batery_voltageI" class="fa fa-circle text-success"></i>
						</td>
						<td id ="batery_voltageT">Sin datos</td>
					</tr>
					</tbody>
				</table>
			</div>
			<div class="ibox-content col-xs-12 col-md-4 col-sm-4" style="clear: initial;">
				<table class="table table-stripped small m-t-md">
					<tbody>
					<tr>
						<td class="no-borders">
							<i id="dim1I" class="fa fa-circle text-success"></i>
						</td>
						<td class="no-borders" id ="dim1T">Sin datos</td>
					</tr>
					<tr>
						<td>
							<i id ="dim2I" class="fa fa-circle text-success"></i>
						</td>
						<td id ="dim2T">Sin datos</td>
					</tr>
					<tr>
						<td>
							<i id="dim3I" class="fa fa-circle text-success"></i>
						</td>
						<td id ="dim3T">Sin datos</td>
					</tr>
					<tr>
						<td>
							<i id ="dim4I" class="fa fa-circle text-success"></i>
						</td>
						<td id ="dim4T">Sin datos</td>
					</tr>
					<tr>
						<td>
							<i id ="dim5I" class="fa fa-circle text-success"></i>
						</td>
						<td id ="dim5T">Sin datos</td>
					</tr>
					<tr>
						<td>
							<i id ="dim6I" class="fa fa-circle text-success"></i>
						</td>
						<td id ="dim6T">Sin datos</td>
					</tr>
					<tr>
						<td>
							<i id ="dim7I" class="fa fa-circle text-success"></i>
						</td>
						<td id ="dim7T">Sin datos</td>
					</tr>
					<tr>
						<td>
							<i id ="dim8I" class="fa fa-circle text-success"></i>
						</td>
						<td id ="dim8T">Sin datos</td>
					</tr>
					<tr>
						<td>
							<i id ="temperatureI" class="fa fa-circle text-success"></i>
						</td>
						<td id ="temperatureT">Sin datos</td>
					</tr>
					</tbody>
				</table>
			</div>
			<div class="ibox-content col-xs-12 col-md-4 col-sm-4" style="clear: initial;">
				<table class="table table-stripped small m-t-md">
					<tbody>
					<tr>
						<td class="no-borders">
							<i id="ac_powerI" class="fa fa-circle text-success"></i>
						</td>
						<td class="no-borders" id ="ac_powerT">Sin datos</td>
					</tr>
					<tr>
						<td>
							<i id ="gsm_signalI" class="fa fa-circle text-success"></i>
						</td>
						<td id ="gsm_signalT">Sin datos</td>
					</tr>
					<tr>
						<td>
							<i id="arm_disarmI" class="fa fa-circle text-success"></i>
						</td>
						<td id ="arm_disarmT">Sin datos</td>
					</tr>
					<tr>
						<td>
							<i id ="voltage_externalI" class="fa fa-circle text-success"></i>
						</td>
						<td id ="voltage_externalT">Sin datos</td>
					</tr>
					<tr>
						<td>
							<i id ="dout1I" class="fa fa-circle text-success"></i>
						</td>
						<td id ="dout1T">Sin datos</td>
					</tr>
					<tr>
						<td>
							<i id ="dout2I" class="fa fa-circle text-success"></i>
						</td>
						<td id ="dout2T">Sin datos</td>
					</tr>
					<tr>
						<td>
							<i id ="dout3I" class="fa fa-circle text-success"></i>
						</td>
						<td id ="dout3T">Sin datos</td>
					</tr>
					<tr>
						<td>
							<i id ="dout4I" class="fa fa-circle text-success"></i>
						</td>
						<td id ="dout4T">Sin datos</td>
					</tr>
					<tr>
						<td>
							<i id ="humedyI" class="fa fa-circle text-success"></i>
						</td>
						<td id ="humedyT">Sin datos</td>
					</tr>
					</tbody>
				</table>
			</div>
			
		</div>
	</div>
	
	<!--<div id="swith3" style="height: 7%;width: 8px;position: fixed;z-index: 999999;bottom: 45px;left: 43%; box-sizing: border-box;">
		<a class="open-small-chat"><i class="fa fa-signal"></i></a>
	</div>-->
	
	<div id="swith2" style="height: 7%;width: 8px;position: fixed;z-index: 999999;bottom: 45px;left: 63%; box-sizing: border-box;">
		<a class="open-small-chat"><i class="fa fa-exclamation-triangle"></i></a>
	</div>
	
	<div id="swith" style="height: 7%;width: 8px;position: fixed;z-index: 999999;bottom: 45px;left: 83%; box-sizing: border-box;">
		<a class="open-small-chat"><i class="fa fa-sliders"></i></a>
	</div>
	
	
</body>
	<script>
		window.sessionStorage.setItem("menuDesple","false");
		
		$("#swith").click(function(){
		
			if (window.sessionStorage.getItem("menuDesple")=="false"){
				window.sessionStorage.setItem("menuDesple","true");
				
				$("#menu").css("display","block");
				$("#menu2").css("display","none");
				
			}else{
				$("#menu").css("display","none");
				window.sessionStorage.setItem("menuDesple","false");
			}
		});
		
		window.sessionStorage.setItem("menuDesple2","false");
		
		$("#swith3").click(function(){
				
			if (window.sessionStorage.getItem("punteados")){
				
				$("#ain0T").text("Sin datos");
				$("#ain1T").text("Sin datos");
				$("#ain2T").text("Sin datos");
				$("#ain3T").text("Sin datos");
				$("#ain4T").text("Sin datos");
				$("#ain5T").text("Sin datos");
				$("#ain6T").text("Sin datos");
				$("#ain7T").text("Sin datos");
				$("#batery_voltageT").text("Sin datos");
				$("#dim1T").text("Sin datos");
				$("#dim2T").text("Sin datos");
				$("#dim3T").text("Sin datos");
				$("#dim4T").text("Sin datos");
				$("#dim5T").text("Sin datos");
				$("#dim6T").text("Sin datos");
				$("#dim7T").text("Sin datos");
				$("#dim8T").text("Sin datos");
				$("#ac_powerT").text("Sin datos");
				$("#gsm_signalT").text("Sin datos");
				$("#arm_disarmT").text("Sin datos");
				$("#voltage_externalT").text("Sin datos");
				$("#dout1T").text("Sin datos");
				$("#dout2T").text("Sin datos");
				$("#dout3T").text("Sin datos");
				$("#dout4T").text("Sin datos");
				$("#humedyT").text("Sin datos");
			
				var nuevo = [],listo=[];
				
				var selectList = document.createElement("select");
				selectList.id = "mySelect";
				
				var ver = JSON.parse(window.sessionStorage.getItem("punteados"));
				for (var h = 0; h < ver.length; h++){
					var option = document.createElement("option");
					option.value = ver[h].port;
					option.text = ver[h].nom+" port: "+ver[h].port;
					selectList.appendChild(option);
				}
				
				swal("Seleccione elemento especifico visualizar", {
				  content: selectList,
				}).then((value) => {
					var valor = $("#mySelect").select()[0].value;
					window.sessionStorage.setItem("visualTrama",valor);
					
					cargarModalTrama();
					
				});
			}
			
		});
		
		$("#swith2").click(function(){
			if (window.sessionStorage.getItem("menuDesple2")=="false"){
				window.sessionStorage.setItem("menuDesple2","true");
				
				if (window.sessionStorage.getItem("punteados")){
				
					$("#ain0T").text("Sin datos");
					$("#ain1T").text("Sin datos");
					$("#ain2T").text("Sin datos");
					$("#ain3T").text("Sin datos");
					$("#ain4T").text("Sin datos");
					$("#ain5T").text("Sin datos");
					$("#ain6T").text("Sin datos");
					$("#ain7T").text("Sin datos");
					$("#batery_voltageT").text("Sin datos");
					$("#dim1T").text("Sin datos");
					$("#dim2T").text("Sin datos");
					$("#dim3T").text("Sin datos");
					$("#dim4T").text("Sin datos");
					$("#dim5T").text("Sin datos");
					$("#dim6T").text("Sin datos");
					$("#dim7T").text("Sin datos");
					$("#dim8T").text("Sin datos");
					$("#ac_powerT").text("Sin datos");
					$("#gsm_signalT").text("Sin datos");
					$("#arm_disarmT").text("Sin datos");
					$("#voltage_externalT").text("Sin datos");
					$("#dout1T").text("Sin datos");
					$("#dout2T").text("Sin datos");
					$("#dout3T").text("Sin datos");
					$("#dout4T").text("Sin datos");
					$("#humedyT").text("Sin datos");
				
					var nuevo = [],listo=[];
					
					var selectList = document.createElement("select");
					selectList.id = "mySelect";
					
					var ver = JSON.parse(window.sessionStorage.getItem("punteados"));
					for (var h = 0; h < ver.length; h++){
						var option = document.createElement("option");
						option.value = ver[h].port;
						option.text = ver[h].nom+" port: "+ver[h].port;
						selectList.appendChild(option);
					}
					
					swal("Seleccione elemento especifico visualizar", {
					  content: selectList,
					}).then((value) => {
						var valor = $("#mySelect").select()[0].value;
						window.sessionStorage.setItem("visualTrama",valor);
						
						$("#menu2").css("display","block");
						$("#menu").css("display","none");
					});
				}
				
			}else{
				$("#menu2").css("display","none");
				window.sessionStorage.setItem("menuDesple2","false");
			}
			
		});
		
		setTimeout(function(){
			$("#lineChartDin").css("display","block");
		},300000);
		
	</script>
</html>
